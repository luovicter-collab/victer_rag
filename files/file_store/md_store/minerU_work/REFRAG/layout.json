{
    "pdf_info": [
        {
            "para_blocks": [
                {
                    "bbox": [
                        85,
                        79,
                        454,
                        99
                    ],
                    "type": "title",
                    "angle": 0,
                    "index": 1,
                    "lines": [
                        {
                            "bbox": [
                                83,
                                76,
                                456,
                                102
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        83,
                                        76,
                                        456,
                                        102
                                    ],
                                    "type": "text",
                                    "content": "REFRAG: Rethinking RAG based Decoding",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                },
                {
                    "bbox": [
                        84,
                        103,
                        500,
                        117
                    ],
                    "type": "text",
                    "angle": 0,
                    "index": 2,
                    "lines": [
                        {
                            "bbox": [
                                82,
                                101,
                                502,
                                118
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        82,
                                        101,
                                        142,
                                        118
                                    ],
                                    "type": "text",
                                    "content": "Xiaoqiang Lin",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        143,
                                        105,
                                        160,
                                        114
                                    ],
                                    "type": "inline_equation",
                                    "content": "^ { 1 , 2 , * }",
                                    "score": 0.56
                                },
                                {
                                    "bbox": [
                                        160,
                                        101,
                                        502,
                                        118
                                    ],
                                    "type": "text",
                                    "content": ", Aritra Ghosh1, Bryan Kian Hsiang Low2, Anshumali Shrivastava1,3, Vijai Mohan1",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                },
                {
                    "bbox": [
                        85,
                        121,
                        446,
                        145
                    ],
                    "type": "text",
                    "angle": 0,
                    "index": 3,
                    "lines": [
                        {
                            "bbox": [
                                83,
                                119,
                                447,
                                137
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        83,
                                        119,
                                        447,
                                        137
                                    ],
                                    "type": "text",
                                    "content": "1Meta Superintelligence Labs, 2National University of Singapore, 3Rice University",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                86,
                                133,
                                174,
                                147
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        86,
                                        137,
                                        91,
                                        144
                                    ],
                                    "type": "inline_equation",
                                    "content": "^ *",
                                    "score": 0.62
                                },
                                {
                                    "bbox": [
                                        91,
                                        133,
                                        174,
                                        147
                                    ],
                                    "type": "text",
                                    "content": "Work done at Meta",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                },
                {
                    "bbox": [
                        83,
                        159,
                        526,
                        423
                    ],
                    "type": "text",
                    "angle": 0,
                    "index": 4,
                    "lines": [
                        {
                            "bbox": [
                                84,
                                159,
                                526,
                                172
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        84,
                                        159,
                                        526,
                                        172
                                    ],
                                    "type": "text",
                                    "content": "Large Language Models (LLMs) have demonstrated remarkable capabilities in leveraging extensive",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                85,
                                171,
                                526,
                                185
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        85,
                                        171,
                                        526,
                                        185
                                    ],
                                    "type": "text",
                                    "content": "external knowledge to enhance responses in multi-turn and agentic applications, such as retrieval-",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                85,
                                183,
                                526,
                                198
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        85,
                                        183,
                                        526,
                                        198
                                    ],
                                    "type": "text",
                                    "content": "augmented generation (RAG). However, processing long-context inputs introduces significant system",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                85,
                                195,
                                526,
                                209
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        85,
                                        195,
                                        526,
                                        209
                                    ],
                                    "type": "text",
                                    "content": "latency and demands substantial memory for the key-value cache, resulting in reduced throughput",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                84,
                                206,
                                526,
                                221
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        84,
                                        206,
                                        526,
                                        221
                                    ],
                                    "type": "text",
                                    "content": "and a fundamental trade-off between knowledge enrichment and system efficiency. While minimizing",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                85,
                                219,
                                526,
                                233
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        85,
                                        219,
                                        526,
                                        233
                                    ],
                                    "type": "text",
                                    "content": "latency for long-context inputs is a primary objective for LLMs, we contend that RAG systems",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                85,
                                231,
                                526,
                                244
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        85,
                                        231,
                                        526,
                                        244
                                    ],
                                    "type": "text",
                                    "content": "require specialized consideration. In RAG, much of the LLM context consists of concatenated",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                85,
                                243,
                                526,
                                257
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        85,
                                        243,
                                        526,
                                        257
                                    ],
                                    "type": "text",
                                    "content": "passages from retrieval, with only a small subset directly relevant to the query. These passages",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                85,
                                255,
                                526,
                                269
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        85,
                                        255,
                                        526,
                                        269
                                    ],
                                    "type": "text",
                                    "content": "often exhibit low semantic similarity due to diversity or deduplication during re-ranking, leading to",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                86,
                                268,
                                526,
                                280
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        86,
                                        268,
                                        526,
                                        280
                                    ],
                                    "type": "text",
                                    "content": "block-diagonal attention patterns that differ from those in standard LLM generation tasks. Based",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                85,
                                278,
                                526,
                                293
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        85,
                                        278,
                                        526,
                                        293
                                    ],
                                    "type": "text",
                                    "content": "on this observation, we argue that most computations over the RAG context during decoding are",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                84,
                                290,
                                526,
                                305
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        84,
                                        290,
                                        526,
                                        305
                                    ],
                                    "type": "text",
                                    "content": "unnecessary and can be eliminated with minimal impact on performance. To this end, we propose",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                84,
                                302,
                                526,
                                317
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        84,
                                        302,
                                        526,
                                        317
                                    ],
                                    "type": "text",
                                    "content": "REFRAG, an efficient decoding framework that compresses, senses, and expands to improve latency",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                85,
                                316,
                                526,
                                328
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        85,
                                        316,
                                        498,
                                        328
                                    ],
                                    "type": "text",
                                    "content": "in RAG applications. By exploiting this attention sparsity structure, we demonstrate a 30.85",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        499,
                                        319,
                                        506,
                                        327
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\times",
                                    "score": 0.7
                                },
                                {
                                    "bbox": [
                                        506,
                                        316,
                                        526,
                                        328
                                    ],
                                    "type": "text",
                                    "content": "the",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                85,
                                327,
                                526,
                                341
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        85,
                                        327,
                                        246,
                                        341
                                    ],
                                    "type": "text",
                                    "content": "time-to-first-token acceleration (3.75",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        246,
                                        331,
                                        253,
                                        338
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\times",
                                    "score": 0.72
                                },
                                {
                                    "bbox": [
                                        254,
                                        327,
                                        526,
                                        341
                                    ],
                                    "type": "text",
                                    "content": "improvement to previous work) without loss in perplexity. In",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                86,
                                339,
                                526,
                                352
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        86,
                                        339,
                                        526,
                                        352
                                    ],
                                    "type": "text",
                                    "content": "addition, our optimization framework for large context enables REFRAG to extend the context size",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                84,
                                350,
                                526,
                                364
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        84,
                                        350,
                                        143,
                                        364
                                    ],
                                    "type": "text",
                                    "content": "of LLMs by",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        143,
                                        354,
                                        162,
                                        362
                                    ],
                                    "type": "inline_equation",
                                    "content": "1 6 \\times",
                                    "score": 0.6
                                },
                                {
                                    "bbox": [
                                        162,
                                        350,
                                        526,
                                        364
                                    ],
                                    "type": "text",
                                    "content": ". We provide rigorous validation of REFRAG across diverse long-context tasks,",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                85,
                                361,
                                526,
                                376
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        85,
                                        361,
                                        526,
                                        376
                                    ],
                                    "type": "text",
                                    "content": "including RAG, multi-turn conversations, and long document summarization, spanning a wide range",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                85,
                                374,
                                526,
                                388
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        85,
                                        374,
                                        526,
                                        388
                                    ],
                                    "type": "text",
                                    "content": "of datasets. Experimental results confirm that REFRAG delivers substantial speedup with no loss",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                84,
                                387,
                                526,
                                399
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        84,
                                        387,
                                        526,
                                        399
                                    ],
                                    "type": "text",
                                    "content": "in accuracy compared to LLaMA models and other state-of-the-art baselines across various context",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                84,
                                399,
                                526,
                                411
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        84,
                                        399,
                                        526,
                                        411
                                    ],
                                    "type": "text",
                                    "content": "sizes. Additionally, our experiments establish that the expanded context window of REFRAG further",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                86,
                                411,
                                278,
                                424
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        86,
                                        411,
                                        278,
                                        424
                                    ],
                                    "type": "text",
                                    "content": "enhances accuracy for popular applications.",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                },
                {
                    "bbox": [
                        85,
                        437,
                        181,
                        449
                    ],
                    "type": "text",
                    "angle": 0,
                    "index": 5,
                    "lines": [
                        {
                            "bbox": [
                                84,
                                437,
                                182,
                                449
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        84,
                                        437,
                                        182,
                                        449
                                    ],
                                    "type": "text",
                                    "content": "Date: October 14, 2025",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                },
                {
                    "bbox": [
                        86,
                        450,
                        305,
                        460
                    ],
                    "type": "text",
                    "angle": 0,
                    "index": 6,
                    "lines": [
                        {
                            "bbox": [
                                84,
                                449,
                                306,
                                462
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        84,
                                        449,
                                        306,
                                        462
                                    ],
                                    "type": "text",
                                    "content": "Correspondence: Aritra Ghosh at arighosh@meta.com",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                },
                {
                    "bbox": [
                        86,
                        462,
                        377,
                        473
                    ],
                    "type": "text",
                    "angle": 0,
                    "index": 7,
                    "lines": [
                        {
                            "bbox": [
                                84,
                                459,
                                379,
                                475
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        84,
                                        459,
                                        379,
                                        475
                                    ],
                                    "type": "text",
                                    "content": "Code: Will be available at https://github.com/facebookresearch/refrag",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                },
                {
                    "bbox": [
                        480,
                        463,
                        526,
                        475
                    ],
                    "type": "text",
                    "angle": 0,
                    "index": 8,
                    "lines": [
                        {
                            "bbox": [
                                481,
                                461,
                                528,
                                477
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        481,
                                        465,
                                        496,
                                        475
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\infty",
                                    "score": 0.63
                                },
                                {
                                    "bbox": [
                                        496,
                                        461,
                                        528,
                                        477
                                    ],
                                    "type": "text",
                                    "content": "Meta",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                },
                {
                    "bbox": [
                        67,
                        509,
                        165,
                        522
                    ],
                    "type": "title",
                    "angle": 0,
                    "index": 9,
                    "lines": [
                        {
                            "bbox": [
                                68,
                                507,
                                167,
                                526
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        507,
                                        167,
                                        526
                                    ],
                                    "type": "text",
                                    "content": "1 Introduction",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                },
                {
                    "bbox": [
                        66,
                        534,
                        543,
                        702
                    ],
                    "type": "text",
                    "angle": 0,
                    "index": 10,
                    "lines": [
                        {
                            "bbox": [
                                67,
                                533,
                                543,
                                550
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        533,
                                        543,
                                        550
                                    ],
                                    "type": "text",
                                    "content": "Large Language Models (LLMs) have demonstrated impressive capabilities in contextual learning, leveraging",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                68,
                                547,
                                544,
                                560
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        547,
                                        544,
                                        560
                                    ],
                                    "type": "text",
                                    "content": "information from their input to achieve superior performance across a range of downstream applications.",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                68,
                                559,
                                543,
                                572
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        559,
                                        543,
                                        572
                                    ],
                                    "type": "text",
                                    "content": "For instance, in multi-turn conversations (Roller et al., 2021; Zhang et al., 2020), incorporating historical",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                68,
                                571,
                                543,
                                584
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        571,
                                        543,
                                        584
                                    ],
                                    "type": "text",
                                    "content": "dialogue into the context enables LLMs to respond more effectively to user queries. In retrieval-augmented",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                68,
                                582,
                                543,
                                597
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        582,
                                        543,
                                        597
                                    ],
                                    "type": "text",
                                    "content": "generation (RAG) (Guu et al., 2020; Izacard et al., 2022), LLMs generate more accurate answers by utilizing",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                68,
                                596,
                                542,
                                608
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        596,
                                        542,
                                        608
                                    ],
                                    "type": "text",
                                    "content": "relevant search results retrieved from external sources. These examples highlight the power of LLMs to learn",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                68,
                                607,
                                543,
                                620
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        607,
                                        543,
                                        620
                                    ],
                                    "type": "text",
                                    "content": "from context. However, it is well established that increasing prompt length for contextual learning leads",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                68,
                                618,
                                542,
                                632
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        618,
                                        542,
                                        632
                                    ],
                                    "type": "text",
                                    "content": "to higher latency and greater memory consumption during inference (Yen et al., 2024). Specifically, longer",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                68,
                                631,
                                543,
                                643
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        631,
                                        543,
                                        643
                                    ],
                                    "type": "text",
                                    "content": "prompts require additional memory for the key-value (KV) cache, which scales linearly with prompt length.",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                68,
                                643,
                                543,
                                656
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        643,
                                        543,
                                        656
                                    ],
                                    "type": "text",
                                    "content": "Moreover, the time-to-first-token (TTFT) latency increases quadratically, while the time-to-iterative-token",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                68,
                                654,
                                542,
                                668
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        654,
                                        542,
                                        668
                                    ],
                                    "type": "text",
                                    "content": "(TTIT) latency grows linearly with prompt length (Liu et al., 2025). As a result, LLM inference throughput",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                68,
                                666,
                                543,
                                680
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        666,
                                        543,
                                        680
                                    ],
                                    "type": "text",
                                    "content": "degrades with larger contexts, limiting their applicability in scenarios demanding high throughput and low",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                677,
                                543,
                                693
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        677,
                                        543,
                                        693
                                    ],
                                    "type": "text",
                                    "content": "latency, such as web-scale discovery. Therefore, developing novel model architectures that optimize memory",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                689,
                                545,
                                704
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        689,
                                        545,
                                        704
                                    ],
                                    "type": "text",
                                    "content": "usage and inference latency is crucial for enhancing the practicality of contextual learning in these applications.",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                },
                {
                    "bbox": [
                        67,
                        708,
                        541,
                        720
                    ],
                    "type": "text",
                    "angle": 0,
                    "index": 11,
                    "lines": [
                        {
                            "bbox": [
                                68,
                                707,
                                542,
                                722
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        707,
                                        542,
                                        722
                                    ],
                                    "type": "text",
                                    "content": "Optimizing inference latency for LLMs with extensive context is an active area of research, with approaches",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                }
            ],
            "discarded_blocks": [
                {
                    "bbox": [
                        14,
                        221,
                        35,
                        568
                    ],
                    "type": "aside_text",
                    "angle": 270,
                    "lines": [
                        {
                            "bbox": [
                                14,
                                221,
                                35,
                                568
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        14,
                                        221,
                                        35,
                                        568
                                    ],
                                    "type": "text",
                                    "content": "arXiv:2509.01092v2 [cs.CL] 12 Oct 2025"
                                }
                            ]
                        }
                    ],
                    "index": 0
                },
                {
                    "bbox": [
                        302,
                        742,
                        308,
                        751
                    ],
                    "type": "page_number",
                    "angle": 0,
                    "index": 12,
                    "lines": [
                        {
                            "bbox": [
                                302,
                                742,
                                309,
                                753
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        302,
                                        742,
                                        309,
                                        753
                                    ],
                                    "type": "text",
                                    "content": "1",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                }
            ],
            "page_size": [
                612,
                792
            ],
            "page_idx": 0
        },
        {
            "para_blocks": [
                {
                    "bbox": [
                        67,
                        64,
                        544,
                        247
                    ],
                    "type": "text",
                    "angle": 0,
                    "index": 0,
                    "lines": [
                        {
                            "bbox": [
                                68,
                                64,
                                542,
                                77
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        64,
                                        542,
                                        77
                                    ],
                                    "type": "text",
                                    "content": "ranging from modifying the attention mechanisms complexity (Beltagy et al., 2020) to sparsifying attention",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                68,
                                76,
                                543,
                                89
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        76,
                                        543,
                                        89
                                    ],
                                    "type": "text",
                                    "content": "and context (Child et al., 2019; Xiao et al., 2024; Jiang et al., 2024), and altering context feeding strategies (Yen",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                87,
                                542,
                                102
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        87,
                                        542,
                                        102
                                    ],
                                    "type": "text",
                                    "content": "et al., 2024). However, most existing methods target generic LLM tasks with long context and are largely",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                68,
                                100,
                                543,
                                113
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        100,
                                        543,
                                        113
                                    ],
                                    "type": "text",
                                    "content": "orthogonal to our work. This paper focuses on RAG-based applications, such as web-scale search, with the",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                68,
                                111,
                                542,
                                125
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        111,
                                        542,
                                        125
                                    ],
                                    "type": "text",
                                    "content": "goal of improving inference latency, specifically, the TTFT. We argue that specialized techniques exploiting the",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                68,
                                124,
                                542,
                                137
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        124,
                                        542,
                                        137
                                    ],
                                    "type": "text",
                                    "content": "unique structure and sparsity inherent in RAG contexts can substantially reduce memory and computational",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                136,
                                542,
                                148
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        136,
                                        542,
                                        148
                                    ],
                                    "type": "text",
                                    "content": "overhead. Treating RAG TTFT as a generic LLM inference problem overlooks several key aspects: 1)",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                146,
                                544,
                                162
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        146,
                                        544,
                                        162
                                    ],
                                    "type": "text",
                                    "content": "Inefficient Token Allocation. RAG contexts often contain sparse information, with many retrieved passages",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                68,
                                159,
                                543,
                                173
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        159,
                                        543,
                                        173
                                    ],
                                    "type": "text",
                                    "content": "being uninformative and reused across multiple inferences. Allocating memory/computation for all the",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                69,
                                171,
                                543,
                                185
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        171,
                                        543,
                                        185
                                    ],
                                    "type": "text",
                                    "content": "tokens, as we show in this paper, is unnecessarily wasteful. 2) Wasteful Encoding and Other Information. The",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                68,
                                185,
                                542,
                                196
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        185,
                                        542,
                                        196
                                    ],
                                    "type": "text",
                                    "content": "retrieval process in RAG has already pre-processed the chunks of the contexts, and their encodings and",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                69,
                                196,
                                542,
                                208
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        196,
                                        542,
                                        208
                                    ],
                                    "type": "text",
                                    "content": "other correlations with the query are already available due to the use of vectorizations and re-rankings. This",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                69,
                                209,
                                541,
                                220
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        209,
                                        541,
                                        220
                                    ],
                                    "type": "text",
                                    "content": "information is discarded during decoding. 3) Unusually Structured and Sparse Attention. Due to diversity",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                69,
                                220,
                                542,
                                233
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        220,
                                        542,
                                        233
                                    ],
                                    "type": "text",
                                    "content": "and other operations such as deduplication, most context chunks during decoding are unrelated, resulting in",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                69,
                                232,
                                357,
                                245
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        232,
                                        357,
                                        245
                                    ],
                                    "type": "text",
                                    "content": "predominantly zero cross-attention between chunks (see figure 7).",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                },
                {
                    "bbox": [
                        67,
                        258,
                        187,
                        271
                    ],
                    "type": "title",
                    "angle": 0,
                    "index": 1,
                    "lines": [
                        {
                            "bbox": [
                                68,
                                256,
                                187,
                                274
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        256,
                                        187,
                                        274
                                    ],
                                    "type": "text",
                                    "content": "1.1 Our Contributions",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                },
                {
                    "bbox": [
                        67,
                        277,
                        543,
                        315
                    ],
                    "type": "text",
                    "angle": 0,
                    "index": 2,
                    "lines": [
                        {
                            "bbox": [
                                68,
                                277,
                                542,
                                292
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        277,
                                        542,
                                        292
                                    ],
                                    "type": "text",
                                    "content": "We propose REFRAG (REpresentation For RAG), a novel mechanism for efficient decoding of contexts",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                68,
                                289,
                                542,
                                303
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        289,
                                        542,
                                        303
                                    ],
                                    "type": "text",
                                    "content": "in RAG. REFRAG significantly reduces latency, TTFT, and memory usage during decoding, all without",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                69,
                                301,
                                455,
                                316
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        301,
                                        455,
                                        316
                                    ],
                                    "type": "text",
                                    "content": "requiring modifications to the LLM architecture or introducing new decoder parameters.",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                },
                {
                    "bbox": [
                        67,
                        319,
                        544,
                        465
                    ],
                    "type": "text",
                    "angle": 0,
                    "index": 3,
                    "lines": [
                        {
                            "bbox": [
                                68,
                                320,
                                542,
                                333
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        320,
                                        542,
                                        333
                                    ],
                                    "type": "text",
                                    "content": "REFRAG makes several novel modifications to the decoding process: Instead of using tokens from retrieved",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                331,
                                544,
                                345
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        331,
                                        544,
                                        345
                                    ],
                                    "type": "text",
                                    "content": "passages as input, REFRAG leverages pre-computed, compressed chunk embeddings as approximate represen-",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                69,
                                343,
                                542,
                                356
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        343,
                                        542,
                                        356
                                    ],
                                    "type": "text",
                                    "content": "tations, feeding these embeddings directly into the decoder. This approach offers three main advantages: 1) It",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                68,
                                356,
                                542,
                                369
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        356,
                                        542,
                                        369
                                    ],
                                    "type": "text",
                                    "content": "shortens the decoders input length, improving token allocation efficiency; 2) It enables reuse of pre-computed",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                68,
                                367,
                                543,
                                381
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        367,
                                        543,
                                        381
                                    ],
                                    "type": "text",
                                    "content": "chunk embeddings from retrieval, eliminating redundant computation; and 3) It reduces attention computation",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                69,
                                380,
                                542,
                                392
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        380,
                                        542,
                                        392
                                    ],
                                    "type": "text",
                                    "content": "complexity, which now scales quadratically with the number of chunks rather than the number of tokens in",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                68,
                                391,
                                544,
                                405
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        391,
                                        544,
                                        405
                                    ],
                                    "type": "text",
                                    "content": "the context. Unlike prior methods (Yen et al., 2024), REFRAG supports compression of token chunks at",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                68,
                                403,
                                543,
                                418
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        403,
                                        543,
                                        418
                                    ],
                                    "type": "text",
                                    "content": "arbitrary positions (see figure 1) while preserving the autoregressive nature of the decoder, thereby supporting",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                69,
                                415,
                                542,
                                428
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        415,
                                        542,
                                        428
                                    ],
                                    "type": "text",
                                    "content": "multi-turn and agentic applications. This compress anywhere capability is further enhanced by a lightweight",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                426,
                                542,
                                441
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        426,
                                        542,
                                        441
                                    ],
                                    "type": "text",
                                    "content": "reinforcement learning (RL) policy that selectively determines when full chunk token input is necessary",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                69,
                                439,
                                542,
                                453
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        439,
                                        542,
                                        453
                                    ],
                                    "type": "text",
                                    "content": "and when low-cost, approximate chunk embeddings suffice . As a result, REFRAG minimizes reliance on",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                451,
                                512,
                                465
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        451,
                                        512,
                                        465
                                    ],
                                    "type": "text",
                                    "content": "computationally intensive token embeddings, condensing most chunks for the query in RAG settings.",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                },
                {
                    "bbox": [
                        67,
                        469,
                        543,
                        532
                    ],
                    "type": "text",
                    "angle": 0,
                    "index": 4,
                    "lines": [
                        {
                            "bbox": [
                                67,
                                468,
                                543,
                                483
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        468,
                                        543,
                                        483
                                    ],
                                    "type": "text",
                                    "content": "We provide rigorous experimental validations of the effectiveness of REFRAG in continual pre-training",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                479,
                                544,
                                495
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        479,
                                        544,
                                        495
                                    ],
                                    "type": "text",
                                    "content": "and many real word long-context applications including RAG, multi-turn conversation with RAG and long",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                68,
                                493,
                                543,
                                506
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        493,
                                        335,
                                        506
                                    ],
                                    "type": "text",
                                    "content": "document summarization. Results show that we achieve 30.75",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        336,
                                        497,
                                        343,
                                        503
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\times",
                                    "score": 0.52
                                },
                                {
                                    "bbox": [
                                        343,
                                        493,
                                        543,
                                        506
                                    ],
                                    "type": "text",
                                    "content": "TTFT acceleration without loss in perplexity",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                504,
                                542,
                                518
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        504,
                                        107,
                                        518
                                    ],
                                    "type": "text",
                                    "content": "which is",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        108,
                                        508,
                                        134,
                                        515
                                    ],
                                    "type": "inline_equation",
                                    "content": "3 . 7 5 \\times",
                                    "score": 0.5
                                },
                                {
                                    "bbox": [
                                        134,
                                        504,
                                        542,
                                        518
                                    ],
                                    "type": "text",
                                    "content": "than previous method. Moreover, with extended context due to our compression, REFRAG",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                69,
                                517,
                                541,
                                529
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        517,
                                        541,
                                        529
                                    ],
                                    "type": "text",
                                    "content": "achieves better performance than LLaMA without incurring higher latency in the downstream applications.",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                },
                {
                    "bbox": [
                        67,
                        548,
                        211,
                        562
                    ],
                    "type": "title",
                    "angle": 0,
                    "index": 5,
                    "lines": [
                        {
                            "bbox": [
                                67,
                                544,
                                210,
                                566
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        544,
                                        210,
                                        566
                                    ],
                                    "type": "text",
                                    "content": "2 Model Architecture",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                },
                {
                    "bbox": [
                        67,
                        573,
                        543,
                        622
                    ],
                    "type": "text",
                    "angle": 0,
                    "index": 6,
                    "lines": [
                        {
                            "bbox": [
                                68,
                                571,
                                543,
                                586
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        571,
                                        221,
                                        586
                                    ],
                                    "type": "text",
                                    "content": "We denote the decoder model as",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        222,
                                        575,
                                        246,
                                        584
                                    ],
                                    "type": "inline_equation",
                                    "content": "{ \\mathcal { M } } _ { \\mathrm { d e c } }",
                                    "score": 0.92
                                },
                                {
                                    "bbox": [
                                        246,
                                        571,
                                        370,
                                        586
                                    ],
                                    "type": "text",
                                    "content": "and the encoder model as",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        370,
                                        575,
                                        395,
                                        584
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathcal { M } _ { \\mathrm { e n c } }",
                                    "score": 0.92
                                },
                                {
                                    "bbox": [
                                        395,
                                        571,
                                        500,
                                        586
                                    ],
                                    "type": "text",
                                    "content": ". Given an input with",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        501,
                                        575,
                                        508,
                                        582
                                    ],
                                    "type": "inline_equation",
                                    "content": "T",
                                    "score": 0.91
                                },
                                {
                                    "bbox": [
                                        509,
                                        571,
                                        543,
                                        586
                                    ],
                                    "type": "text",
                                    "content": "tokens",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                70,
                                585,
                                544,
                                598
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        590,
                                        129,
                                        597
                                    ],
                                    "type": "inline_equation",
                                    "content": "x _ { 1 } , x _ { 2 } , \\ldots , x _ { T }",
                                    "score": 0.87
                                },
                                {
                                    "bbox": [
                                        129,
                                        585,
                                        242,
                                        598
                                    ],
                                    "type": "text",
                                    "content": ", we assume that the first",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        242,
                                        590,
                                        247,
                                        597
                                    ],
                                    "type": "inline_equation",
                                    "content": "q",
                                    "score": 0.88
                                },
                                {
                                    "bbox": [
                                        247,
                                        585,
                                        504,
                                        598
                                    ],
                                    "type": "text",
                                    "content": "tokens are main input tokens (e.g., questions) and the last",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        505,
                                        590,
                                        510,
                                        594
                                    ],
                                    "type": "inline_equation",
                                    "content": "s",
                                    "score": 0.87
                                },
                                {
                                    "bbox": [
                                        510,
                                        585,
                                        544,
                                        598
                                    ],
                                    "type": "text",
                                    "content": "tokens",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                68,
                                597,
                                543,
                                610
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        597,
                                        349,
                                        610
                                    ],
                                    "type": "text",
                                    "content": "are context tokens (e.g., retrieved passages in RAG). We have",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        350,
                                        600,
                                        392,
                                        609
                                    ],
                                    "type": "inline_equation",
                                    "content": "q + s = T",
                                    "score": 0.92
                                },
                                {
                                    "bbox": [
                                        393,
                                        597,
                                        543,
                                        610
                                    ],
                                    "type": "text",
                                    "content": ". For clarity, we focus on a single",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                69,
                                609,
                                267,
                                621
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        609,
                                        267,
                                        621
                                    ],
                                    "type": "text",
                                    "content": "turn of question and retrieval in this section.",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                },
                {
                    "bbox": [
                        67,
                        627,
                        544,
                        726
                    ],
                    "type": "text",
                    "angle": 0,
                    "index": 7,
                    "lines": [
                        {
                            "bbox": [
                                67,
                                625,
                                543,
                                640
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        625,
                                        543,
                                        640
                                    ],
                                    "type": "text",
                                    "content": "Model overview. Figure 1 shows the main architecture of REFRAG. This model consists of a decoder-only",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                637,
                                543,
                                653
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        637,
                                        543,
                                        653
                                    ],
                                    "type": "text",
                                    "content": "foundation model (e.g., LLaMA (Touvron et al., 2023)) and a lightweight encoder model (e.g., Roberta (Liu",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                66,
                                649,
                                544,
                                665
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        66,
                                        649,
                                        237,
                                        665
                                    ],
                                    "type": "text",
                                    "content": "et al., 2019)). When given a question",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        238,
                                        656,
                                        280,
                                        663
                                    ],
                                    "type": "inline_equation",
                                    "content": "x _ { 1 } , \\ldots , x _ { q }",
                                    "score": 0.9
                                },
                                {
                                    "bbox": [
                                        280,
                                        649,
                                        337,
                                        665
                                    ],
                                    "type": "text",
                                    "content": "and context",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        338,
                                        656,
                                        392,
                                        663
                                    ],
                                    "type": "inline_equation",
                                    "content": "x _ { q + 1 } , \\dots , x _ { T }",
                                    "score": 0.88
                                },
                                {
                                    "bbox": [
                                        393,
                                        649,
                                        544,
                                        665
                                    ],
                                    "type": "text",
                                    "content": "and , the context is chunked into",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                70,
                                661,
                                544,
                                677
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        665,
                                        99,
                                        676
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\begin{array} { r } { L : = \\frac { s } { k } } \\end{array}",
                                    "score": 0.93
                                },
                                {
                                    "bbox": [
                                        99,
                                        661,
                                        147,
                                        677
                                    ],
                                    "type": "text",
                                    "content": "number of",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        148,
                                        665,
                                        153,
                                        673
                                    ],
                                    "type": "inline_equation",
                                    "content": "k",
                                    "score": 0.88
                                },
                                {
                                    "bbox": [
                                        154,
                                        661,
                                        211,
                                        677
                                    ],
                                    "type": "text",
                                    "content": "-sized chunks",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        211,
                                        665,
                                        268,
                                        675
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\{ C _ { 1 } , \\dots , C _ { L } \\}",
                                    "score": 0.95
                                },
                                {
                                    "bbox": [
                                        269,
                                        661,
                                        299,
                                        677
                                    ],
                                    "type": "text",
                                    "content": "where",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        299,
                                        664,
                                        431,
                                        675
                                    ],
                                    "type": "inline_equation",
                                    "content": "C _ { i } = \\{ x _ { q + k * i } , \\dots , x _ { q + k * i + k - 1 } \\}",
                                    "score": 0.91
                                },
                                {
                                    "bbox": [
                                        431,
                                        661,
                                        544,
                                        677
                                    ],
                                    "type": "text",
                                    "content": ". The encoder model then",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                673,
                                544,
                                689
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        673,
                                        371,
                                        689
                                    ],
                                    "type": "text",
                                    "content": "processes all the chunks to obtain a chunk embedding for each chunk",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        372,
                                        677,
                                        436,
                                        687
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathbf { c } _ { i } = { \\mathcal { M } } _ { \\mathrm { e n c } } ( C _ { i } )",
                                    "score": 0.92
                                },
                                {
                                    "bbox": [
                                        436,
                                        673,
                                        544,
                                        689
                                    ],
                                    "type": "text",
                                    "content": ". This chunk embedding",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                66,
                                685,
                                544,
                                700
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        66,
                                        685,
                                        250,
                                        700
                                    ],
                                    "type": "text",
                                    "content": "is then projected with a projection layer",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        251,
                                        689,
                                        257,
                                        699
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\phi",
                                    "score": 0.91
                                },
                                {
                                    "bbox": [
                                        258,
                                        685,
                                        544,
                                        700
                                    ],
                                    "type": "text",
                                    "content": "to match the size of the token embedding of the decoder model,",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                70,
                                696,
                                544,
                                713
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        700,
                                        125,
                                        711
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathbf { e } _ { i } ^ { \\mathrm { { c n k } } } = \\phi ( \\mathbf { { c } } _ { i } )",
                                    "score": 0.93
                                },
                                {
                                    "bbox": [
                                        125,
                                        696,
                                        544,
                                        713
                                    ],
                                    "type": "text",
                                    "content": ". These projected chunk embeddings are then fed to the decoder model along with the token",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                66,
                                706,
                                545,
                                727
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        66,
                                        706,
                                        305,
                                        727
                                    ],
                                    "type": "text",
                                    "content": "embeddings for the question to generate the answer",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        305,
                                        712,
                                        468,
                                        723
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\boldsymbol { y } \\sim \\mathcal { M } _ { \\mathrm { d e c } } ( \\{ \\mathbf { e } _ { 1 } , \\dots , \\mathbf { e } _ { q } , \\mathbf { e } _ { 1 } ^ { \\mathrm { c n k } } , \\dots , \\mathbf { e } _ { L } ^ { \\mathrm { c n k } } \\} )",
                                    "score": 0.9
                                },
                                {
                                    "bbox": [
                                        469,
                                        706,
                                        503,
                                        727
                                    ],
                                    "type": "text",
                                    "content": ") where",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        504,
                                        715,
                                        512,
                                        722
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathbf { e } _ { i }",
                                    "score": 0.89
                                },
                                {
                                    "bbox": [
                                        512,
                                        706,
                                        545,
                                        727
                                    ],
                                    "type": "text",
                                    "content": "is the",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                }
            ],
            "discarded_blocks": [
                {
                    "bbox": [
                        302,
                        742,
                        309,
                        752
                    ],
                    "type": "page_number",
                    "angle": 0,
                    "index": 8,
                    "lines": [
                        {
                            "bbox": [
                                302,
                                742,
                                309,
                                753
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        302,
                                        742,
                                        309,
                                        753
                                    ],
                                    "type": "text",
                                    "content": "2",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                }
            ],
            "page_size": [
                612,
                792
            ],
            "page_idx": 1
        },
        {
            "para_blocks": [
                {
                    "type": "image",
                    "bbox": [
                        82,
                        76,
                        531,
                        249
                    ],
                    "blocks": [
                        {
                            "bbox": [
                                82,
                                76,
                                531,
                                249
                            ],
                            "lines": [
                                {
                                    "bbox": [
                                        82,
                                        76,
                                        531,
                                        249
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                82,
                                                76,
                                                531,
                                                249
                                            ],
                                            "type": "image",
                                            "image_path": "6bf188d6c1aba2cf8ab434508705ccdd967b705f54e1729a6be557084bc17910.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 0,
                            "angle": 0,
                            "type": "image_body"
                        },
                        {
                            "bbox": [
                                67,
                                267,
                                541,
                                301
                            ],
                            "lines": [
                                {
                                    "bbox": [
                                        69,
                                        266,
                                        542,
                                        281
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                69,
                                                266,
                                                542,
                                                281
                                            ],
                                            "type": "text",
                                            "content": "Figure 1 The main design of REFRAG. The input context is chunked and processed by the light-weight encoder to",
                                            "score": 1.0
                                        }
                                    ]
                                },
                                {
                                    "bbox": [
                                        68,
                                        279,
                                        542,
                                        291
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                68,
                                                279,
                                                542,
                                                291
                                            ],
                                            "type": "text",
                                            "content": "produce chunk embeddings, which are precomputable for efficient reuse. A light-weight RL policy decide few chunks to",
                                            "score": 1.0
                                        }
                                    ]
                                },
                                {
                                    "bbox": [
                                        67,
                                        289,
                                        526,
                                        303
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                67,
                                                289,
                                                526,
                                                303
                                            ],
                                            "type": "text",
                                            "content": "expand. These chunk embeddings along with the token embeddings of the question input are fed to the decoder.",
                                            "score": 1.0
                                        }
                                    ]
                                }
                            ],
                            "index": 1,
                            "angle": 0,
                            "type": "image_caption"
                        }
                    ],
                    "index": 0
                },
                {
                    "bbox": [
                        67,
                        322,
                        541,
                        394
                    ],
                    "type": "text",
                    "angle": 0,
                    "index": 2,
                    "lines": [
                        {
                            "bbox": [
                                69,
                                322,
                                543,
                                336
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        322,
                                        192,
                                        336
                                    ],
                                    "type": "text",
                                    "content": "token embedding for token",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        192,
                                        327,
                                        202,
                                        334
                                    ],
                                    "type": "inline_equation",
                                    "content": "x _ { i }",
                                    "score": 0.89
                                },
                                {
                                    "bbox": [
                                        202,
                                        322,
                                        543,
                                        336
                                    ],
                                    "type": "text",
                                    "content": ". In real applications (e.g., RAG), the context is the dominating part of the",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                68,
                                334,
                                543,
                                347
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        334,
                                        121,
                                        347
                                    ],
                                    "type": "text",
                                    "content": "input (i.e.,",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        121,
                                        338,
                                        149,
                                        346
                                    ],
                                    "type": "inline_equation",
                                    "content": "s \\gg q",
                                    "score": 0.87
                                },
                                {
                                    "bbox": [
                                        149,
                                        334,
                                        493,
                                        347
                                    ],
                                    "type": "text",
                                    "content": ") and hence the overall input to the decoder will be reduced by a factor of",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        494,
                                        337,
                                        511,
                                        344
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\simeq k",
                                    "score": 0.91
                                },
                                {
                                    "bbox": [
                                        511,
                                        334,
                                        543,
                                        347
                                    ],
                                    "type": "text",
                                    "content": ". This",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                68,
                                345,
                                543,
                                360
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        345,
                                        543,
                                        360
                                    ],
                                    "type": "text",
                                    "content": "architectural design leads to significant reductions in both latency and memory usage, primarily due to the",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                357,
                                543,
                                373
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        357,
                                        543,
                                        373
                                    ],
                                    "type": "text",
                                    "content": "shortened input sequence. Additionally, an RL policy is trained to do selective compression to further improve",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                68,
                                369,
                                543,
                                384
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        369,
                                        543,
                                        384
                                    ],
                                    "type": "text",
                                    "content": "the performance which we will defer the discussion to section 2. Next, we analyze the system performance",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                381,
                                265,
                                396
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        381,
                                        254,
                                        396
                                    ],
                                    "type": "text",
                                    "content": "gains achieved with a compression rate of",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        254,
                                        384,
                                        260,
                                        392
                                    ],
                                    "type": "inline_equation",
                                    "content": "k",
                                    "score": 0.91
                                },
                                {
                                    "bbox": [
                                        260,
                                        381,
                                        265,
                                        396
                                    ],
                                    "type": "text",
                                    "content": ".",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "image",
                    "bbox": [
                        95,
                        406,
                        228,
                        517
                    ],
                    "blocks": [
                        {
                            "bbox": [
                                95,
                                406,
                                228,
                                517
                            ],
                            "lines": [
                                {
                                    "bbox": [
                                        95,
                                        406,
                                        228,
                                        517
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                95,
                                                406,
                                                228,
                                                517
                                            ],
                                            "type": "image",
                                            "image_path": "85ab29b98417ac1c6964d850fee6ad9dcfee4a383c331d52e20069e6ceac21e4.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 3,
                            "angle": 0,
                            "type": "image_body"
                        }
                    ],
                    "index": 3
                },
                {
                    "type": "image",
                    "bbox": [
                        232,
                        406,
                        369,
                        517
                    ],
                    "blocks": [
                        {
                            "bbox": [
                                232,
                                406,
                                369,
                                517
                            ],
                            "lines": [
                                {
                                    "bbox": [
                                        232,
                                        406,
                                        369,
                                        517
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                232,
                                                406,
                                                369,
                                                517
                                            ],
                                            "type": "image",
                                            "image_path": "cdc41ba6cfc2277ecad0dd322ec15b4e1fcedb4c23cdb7c33a65adfb86b31cd4.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 4,
                            "angle": 0,
                            "type": "image_body"
                        }
                    ],
                    "index": 4
                },
                {
                    "type": "image",
                    "bbox": [
                        378,
                        406,
                        515,
                        517
                    ],
                    "blocks": [
                        {
                            "bbox": [
                                378,
                                406,
                                515,
                                517
                            ],
                            "lines": [
                                {
                                    "bbox": [
                                        378,
                                        406,
                                        515,
                                        517
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                378,
                                                406,
                                                515,
                                                517
                                            ],
                                            "type": "image",
                                            "image_path": "fc83abe9d14e1b80ee0f493733d78461e42c3a7f8ca91f03b9ad6a8bb5d4bbdc.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 5,
                            "angle": 0,
                            "type": "image_body"
                        },
                        {
                            "bbox": [
                                141,
                                528,
                                459,
                                541
                            ],
                            "lines": [
                                {
                                    "bbox": [
                                        147,
                                        526,
                                        458,
                                        542
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                147,
                                                527,
                                                252,
                                                542
                                            ],
                                            "type": "text",
                                            "content": "REFRAG (Cached)",
                                            "score": 1.0
                                        },
                                        {
                                            "bbox": [
                                                275,
                                                526,
                                                392,
                                                542
                                            ],
                                            "type": "text",
                                            "content": "REFRAG (Not Cached)",
                                            "score": 1.0
                                        },
                                        {
                                            "bbox": [
                                                406,
                                                528,
                                                458,
                                                542
                                            ],
                                            "type": "text",
                                            "content": "CEPE",
                                            "score": 1.0
                                        }
                                    ]
                                }
                            ],
                            "index": 6,
                            "angle": 0,
                            "type": "image_footnote"
                        },
                        {
                            "bbox": [
                                67,
                                556,
                                403,
                                567
                            ],
                            "lines": [
                                {
                                    "bbox": [
                                        68,
                                        555,
                                        405,
                                        568
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                68,
                                                555,
                                                373,
                                                568
                                            ],
                                            "type": "text",
                                            "content": "Figure 2 Empirical verification of inference acceleration of REFRAG with",
                                            "score": 1.0
                                        },
                                        {
                                            "bbox": [
                                                373,
                                                559,
                                                400,
                                                566
                                            ],
                                            "type": "inline_equation",
                                            "content": "k = 1 6",
                                            "score": 0.9
                                        },
                                        {
                                            "bbox": [
                                                400,
                                                555,
                                                405,
                                                568
                                            ],
                                            "type": "text",
                                            "content": ".",
                                            "score": 1.0
                                        }
                                    ]
                                }
                            ],
                            "index": 7,
                            "angle": 0,
                            "type": "image_caption"
                        }
                    ],
                    "index": 5
                },
                {
                    "bbox": [
                        67,
                        581,
                        541,
                        701
                    ],
                    "type": "text",
                    "angle": 0,
                    "index": 8,
                    "lines": [
                        {
                            "bbox": [
                                67,
                                581,
                                542,
                                594
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        581,
                                        542,
                                        594
                                    ],
                                    "type": "text",
                                    "content": "Latency and throughput improvement. We evaluate three metrics: TTFT, the latency to generate the first",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                69,
                                594,
                                542,
                                606
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        594,
                                        542,
                                        606
                                    ],
                                    "type": "text",
                                    "content": "token; TTIT, the time to generate each subsequent token; and Throughput, the number of tokens generated",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                68,
                                605,
                                542,
                                618
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        605,
                                        542,
                                        618
                                    ],
                                    "type": "text",
                                    "content": "per unit time. Theoretical analysis (section A) shows that for short context lengths, our method achieves up to",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                70,
                                616,
                                542,
                                629
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        617,
                                        84,
                                        628
                                    ],
                                    "type": "inline_equation",
                                    "content": "k \\times",
                                    "score": 0.84
                                },
                                {
                                    "bbox": [
                                        84,
                                        616,
                                        484,
                                        629
                                    ],
                                    "type": "text",
                                    "content": "acceleration in TTFT and throughput. For longer context length, acceleration reaches up to",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        484,
                                        618,
                                        503,
                                        628
                                    ],
                                    "type": "inline_equation",
                                    "content": "k ^ { 2 } \\times",
                                    "score": 0.92
                                },
                                {
                                    "bbox": [
                                        503,
                                        616,
                                        542,
                                        629
                                    ],
                                    "type": "text",
                                    "content": "for both",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                628,
                                542,
                                642
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        628,
                                        542,
                                        642
                                    ],
                                    "type": "text",
                                    "content": "metrics. Empirically, as shown in figure 2, with a context length of 16384 (mid-to-long context), REFRAG",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                640,
                                542,
                                654
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        640,
                                        91,
                                        654
                                    ],
                                    "type": "text",
                                    "content": "with",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        91,
                                        641,
                                        121,
                                        651
                                    ],
                                    "type": "inline_equation",
                                    "content": "k = 1 6",
                                    "score": 0.88
                                },
                                {
                                    "bbox": [
                                        121,
                                        640,
                                        160,
                                        654
                                    ],
                                    "type": "text",
                                    "content": "achieves",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        160,
                                        641,
                                        192,
                                        652
                                    ],
                                    "type": "inline_equation",
                                    "content": "1 6 . 5 3 \\times",
                                    "score": 0.84
                                },
                                {
                                    "bbox": [
                                        192,
                                        640,
                                        363,
                                        654
                                    ],
                                    "type": "text",
                                    "content": "TTFT acceleration with cache and 8.59",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        363,
                                        645,
                                        370,
                                        651
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\times",
                                    "score": 0.69
                                },
                                {
                                    "bbox": [
                                        371,
                                        640,
                                        542,
                                        654
                                    ],
                                    "type": "text",
                                    "content": "without cache1, both surpassing CEPE",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                70,
                                653,
                                542,
                                666
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        653,
                                        99,
                                        665
                                    ],
                                    "type": "inline_equation",
                                    "content": "( 2 . 0 1 \\times",
                                    "score": 0.74
                                },
                                {
                                    "bbox": [
                                        99,
                                        653,
                                        121,
                                        666
                                    ],
                                    "type": "text",
                                    "content": "and",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        121,
                                        653,
                                        148,
                                        664
                                    ],
                                    "type": "inline_equation",
                                    "content": "1 . 0 4 \\times",
                                    "score": 0.84
                                },
                                {
                                    "bbox": [
                                        148,
                                        653,
                                        284,
                                        666
                                    ],
                                    "type": "text",
                                    "content": ", respectively), while achieving",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        285,
                                        653,
                                        307,
                                        664
                                    ],
                                    "type": "inline_equation",
                                    "content": "9 . 3 \\%",
                                    "score": 0.59
                                },
                                {
                                    "bbox": [
                                        307,
                                        653,
                                        542,
                                        666
                                    ],
                                    "type": "text",
                                    "content": "performance (measured by log-perplexity) compared",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                68,
                                664,
                                541,
                                677
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        664,
                                        245,
                                        677
                                    ],
                                    "type": "text",
                                    "content": "to CEPE (table 1). We achieve up to",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        245,
                                        665,
                                        272,
                                        676
                                    ],
                                    "type": "inline_equation",
                                    "content": "6 . 7 8 \\times",
                                    "score": 0.66
                                },
                                {
                                    "bbox": [
                                        272,
                                        664,
                                        541,
                                        677
                                    ],
                                    "type": "text",
                                    "content": "throughput acceleration compared to LLaMA, significantly",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                676,
                                542,
                                690
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        676,
                                        190,
                                        690
                                    ],
                                    "type": "text",
                                    "content": "outperforming CEPE. With",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        191,
                                        679,
                                        220,
                                        686
                                    ],
                                    "type": "inline_equation",
                                    "content": "k = 3 2",
                                    "score": 0.86
                                },
                                {
                                    "bbox": [
                                        220,
                                        676,
                                        364,
                                        690
                                    ],
                                    "type": "text",
                                    "content": ", TTFT acceleration reaches 32.99",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        365,
                                        681,
                                        372,
                                        687
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\times",
                                    "score": 0.75
                                },
                                {
                                    "bbox": [
                                        373,
                                        676,
                                        542,
                                        690
                                    ],
                                    "type": "text",
                                    "content": "compared to LLaMA (3.75 compared",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                69,
                                689,
                                541,
                                701
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        689,
                                        541,
                                        701
                                    ],
                                    "type": "text",
                                    "content": "to CEPE) while maintaining similar performance to CEPE (see figure 8 and table 2). More detailed discussion",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                }
            ],
            "discarded_blocks": [
                {
                    "bbox": [
                        78,
                        708,
                        541,
                        718
                    ],
                    "type": "page_footnote",
                    "angle": 0,
                    "index": 9,
                    "lines": [
                        {
                            "bbox": [
                                80,
                                708,
                                542,
                                719
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        80,
                                        708,
                                        542,
                                        719
                                    ],
                                    "type": "text",
                                    "content": "1REFRAG without cache means that we recompute the chunk embedding for the context and take this latency into account.",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                },
                {
                    "bbox": [
                        302,
                        742,
                        308,
                        750
                    ],
                    "type": "page_number",
                    "angle": 0,
                    "index": 10,
                    "lines": []
                }
            ],
            "page_size": [
                612,
                792
            ],
            "page_idx": 2
        },
        {
            "para_blocks": [
                {
                    "bbox": [
                        67,
                        64,
                        240,
                        75
                    ],
                    "type": "text",
                    "angle": 0,
                    "index": 0,
                    "lines": [
                        {
                            "bbox": [
                                68,
                                63,
                                241,
                                76
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        63,
                                        241,
                                        76
                                    ],
                                    "type": "text",
                                    "content": "on empirical evaluation is in section A.",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                },
                {
                    "bbox": [
                        67,
                        95,
                        173,
                        110
                    ],
                    "type": "title",
                    "angle": 0,
                    "index": 1,
                    "lines": [
                        {
                            "bbox": [
                                66,
                                91,
                                173,
                                114
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        66,
                                        91,
                                        173,
                                        114
                                    ],
                                    "type": "text",
                                    "content": "3 Methodology",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                },
                {
                    "bbox": [
                        67,
                        121,
                        543,
                        193
                    ],
                    "type": "text",
                    "angle": 0,
                    "index": 2,
                    "lines": [
                        {
                            "bbox": [
                                68,
                                119,
                                542,
                                134
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        119,
                                        542,
                                        134
                                    ],
                                    "type": "text",
                                    "content": "To align the encoder and decoder, we follow the work of Yen et al. (2024) to use the next paragraph prediction",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                69,
                                132,
                                543,
                                146
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        132,
                                        461,
                                        146
                                    ],
                                    "type": "text",
                                    "content": "tasks for continual pre-training (CPT). Specifically, for each data data point, it contains",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        462,
                                        135,
                                        504,
                                        143
                                    ],
                                    "type": "inline_equation",
                                    "content": "s + o = T",
                                    "score": 0.93
                                },
                                {
                                    "bbox": [
                                        504,
                                        132,
                                        543,
                                        146
                                    ],
                                    "type": "text",
                                    "content": "number",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                144,
                                544,
                                158
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        144,
                                        544,
                                        158
                                    ],
                                    "type": "text",
                                    "content": "of tokens, which we use for CPT to prepare the model for downstream tasks utilizing chunk embeddings.",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                69,
                                156,
                                543,
                                170
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        156,
                                        543,
                                        170
                                    ],
                                    "type": "text",
                                    "content": "To further enhance performance, we introduce selective compression via RL. After aligning the encoder and",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                167,
                                543,
                                182
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        167,
                                        543,
                                        182
                                    ],
                                    "type": "text",
                                    "content": "decoder through CPT, we apply supervised fine-tuning (SFT) to adapt the model to specific downstream",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                69,
                                181,
                                480,
                                194
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        181,
                                        480,
                                        194
                                    ],
                                    "type": "text",
                                    "content": "tasks, such as RAG and multi-turn conversation. Additional details are provided in section 5.",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                },
                {
                    "bbox": [
                        67,
                        198,
                        542,
                        258
                    ],
                    "type": "text",
                    "angle": 0,
                    "index": 3,
                    "lines": [
                        {
                            "bbox": [
                                69,
                                198,
                                542,
                                211
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        198,
                                        214,
                                        211
                                    ],
                                    "type": "text",
                                    "content": "During CPT, we input the first",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        214,
                                        204,
                                        219,
                                        209
                                    ],
                                    "type": "inline_equation",
                                    "content": "s",
                                    "score": 0.86
                                },
                                {
                                    "bbox": [
                                        219,
                                        198,
                                        253,
                                        211
                                    ],
                                    "type": "text",
                                    "content": "tokens",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        254,
                                        204,
                                        271,
                                        210
                                    ],
                                    "type": "inline_equation",
                                    "content": "x _ { 1 : s }",
                                    "score": 0.9
                                },
                                {
                                    "bbox": [
                                        271,
                                        198,
                                        542,
                                        211
                                    ],
                                    "type": "text",
                                    "content": "into the encoder and use its output to assist the decoder in",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                68,
                                210,
                                543,
                                224
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        210,
                                        156,
                                        224
                                    ],
                                    "type": "text",
                                    "content": "predicting the next",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        156,
                                        216,
                                        161,
                                        220
                                    ],
                                    "type": "inline_equation",
                                    "content": "o",
                                    "score": 0.82
                                },
                                {
                                    "bbox": [
                                        161,
                                        210,
                                        194,
                                        224
                                    ],
                                    "type": "text",
                                    "content": "tokens",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        194,
                                        216,
                                        231,
                                        223
                                    ],
                                    "type": "inline_equation",
                                    "content": "x _ { s + 1 : s + o }",
                                    "score": 0.9
                                },
                                {
                                    "bbox": [
                                        231,
                                        210,
                                        543,
                                        224
                                    ],
                                    "type": "text",
                                    "content": ". This task encourages the model to leverage contextual information for",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                221,
                                543,
                                237
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        221,
                                        543,
                                        237
                                    ],
                                    "type": "text",
                                    "content": "next-paragraph prediction, thereby equipping it for downstream applications. The objective is to align any",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                69,
                                235,
                                541,
                                247
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        235,
                                        541,
                                        247
                                    ],
                                    "type": "text",
                                    "content": "encoderdecoder combination so that the generations produced with compressed context closely resemble",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                69,
                                247,
                                380,
                                259
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        247,
                                        380,
                                        259
                                    ],
                                    "type": "text",
                                    "content": "those generated by the original decoder with access to the full context.",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                },
                {
                    "bbox": [
                        67,
                        274,
                        244,
                        287
                    ],
                    "type": "title",
                    "angle": 0,
                    "index": 4,
                    "lines": [
                        {
                            "bbox": [
                                68,
                                271,
                                245,
                                289
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        271,
                                        245,
                                        289
                                    ],
                                    "type": "text",
                                    "content": "3.1 Continual Pre-training Recipe",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                },
                {
                    "bbox": [
                        67,
                        293,
                        542,
                        329
                    ],
                    "type": "text",
                    "angle": 0,
                    "index": 5,
                    "lines": [
                        {
                            "bbox": [
                                68,
                                291,
                                543,
                                305
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        291,
                                        543,
                                        305
                                    ],
                                    "type": "text",
                                    "content": "To ensure the success of the CPT phase, we propose a training recipe that incorporates a reconstruction task",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                304,
                                542,
                                317
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        304,
                                        542,
                                        317
                                    ],
                                    "type": "text",
                                    "content": "and a curriculum learning approach. Ablation studies in section 4 demonstrate that this recipe is crucial for",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                69,
                                317,
                                227,
                                329
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        317,
                                        227,
                                        329
                                    ],
                                    "type": "text",
                                    "content": "achieving strong CPT performance.",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                },
                {
                    "bbox": [
                        67,
                        335,
                        543,
                        430
                    ],
                    "type": "text",
                    "angle": 0,
                    "index": 6,
                    "lines": [
                        {
                            "bbox": [
                                68,
                                335,
                                543,
                                348
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        335,
                                        283,
                                        348
                                    ],
                                    "type": "text",
                                    "content": "Reconstruction task. We input the first s tokens",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        284,
                                        337,
                                        301,
                                        346
                                    ],
                                    "type": "inline_equation",
                                    "content": "x _ { 1 : s }",
                                    "score": 0.86
                                },
                                {
                                    "bbox": [
                                        302,
                                        335,
                                        511,
                                        348
                                    ],
                                    "type": "text",
                                    "content": "to the encoder and learn to reconstruct tokens",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        512,
                                        337,
                                        529,
                                        346
                                    ],
                                    "type": "inline_equation",
                                    "content": "x _ { 1 : s }",
                                    "score": 0.85
                                },
                                {
                                    "bbox": [
                                        529,
                                        335,
                                        543,
                                        348
                                    ],
                                    "type": "text",
                                    "content": "in",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                68,
                                346,
                                543,
                                359
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        346,
                                        543,
                                        359
                                    ],
                                    "type": "text",
                                    "content": "the decoder. In this task, we freeze the decoder model and only train the encoder and projection layer. The",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                69,
                                359,
                                543,
                                372
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        359,
                                        481,
                                        372
                                    ],
                                    "type": "text",
                                    "content": "main objectives are to align the encoder and projection layer so that: 1) encoder can compress",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        481,
                                        359,
                                        488,
                                        369
                                    ],
                                    "type": "inline_equation",
                                    "content": "k",
                                    "score": 0.79
                                },
                                {
                                    "bbox": [
                                        488,
                                        359,
                                        543,
                                        372
                                    ],
                                    "type": "text",
                                    "content": "tokens with",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                68,
                                371,
                                543,
                                384
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        371,
                                        543,
                                        384
                                    ],
                                    "type": "text",
                                    "content": "minimal information loss, and 2) projection layer can effectively map the encoders chunk embeddings into the",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                68,
                                383,
                                543,
                                396
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        383,
                                        543,
                                        396
                                    ],
                                    "type": "text",
                                    "content": "decoders token space, allowing the decoder to interpret and accurately reconstruct the original information.",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                69,
                                395,
                                543,
                                407
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        395,
                                        543,
                                        407
                                    ],
                                    "type": "text",
                                    "content": "The reconstruction task was specifically chosen to encourage the model to rely on context memory rather",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                68,
                                406,
                                543,
                                419
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        406,
                                        543,
                                        419
                                    ],
                                    "type": "text",
                                    "content": "than its parametric memory during training. Once the encoder is aligned with the decoder through this",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                417,
                                348,
                                432
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        417,
                                        348,
                                        432
                                    ],
                                    "type": "text",
                                    "content": "reconstruction task, we initiate CPT by unfreezing the decoder.",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                },
                {
                    "bbox": [
                        67,
                        436,
                        543,
                        496
                    ],
                    "type": "text",
                    "angle": 0,
                    "index": 7,
                    "lines": [
                        {
                            "bbox": [
                                68,
                                435,
                                542,
                                450
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        435,
                                        542,
                                        450
                                    ],
                                    "type": "text",
                                    "content": "Curriculum learning. The training tasks described in the previous section may seem straightforward, but they",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                447,
                                543,
                                461
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        447,
                                        265,
                                        461
                                    ],
                                    "type": "text",
                                    "content": "are inherently complex. As the chunk length",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        265,
                                        451,
                                        271,
                                        458
                                    ],
                                    "type": "inline_equation",
                                    "content": "k",
                                    "score": 0.88
                                },
                                {
                                    "bbox": [
                                        271,
                                        447,
                                        543,
                                        461
                                    ],
                                    "type": "text",
                                    "content": "increases, the number of possible token combinations expands",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                458,
                                544,
                                475
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        458,
                                        233,
                                        475
                                    ],
                                    "type": "text",
                                    "content": "exponentially, specifically at a rate of",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        234,
                                        461,
                                        247,
                                        470
                                    ],
                                    "type": "inline_equation",
                                    "content": "V ^ { k }",
                                    "score": 0.91
                                },
                                {
                                    "bbox": [
                                        247,
                                        458,
                                        281,
                                        475
                                    ],
                                    "type": "text",
                                    "content": ", where",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        282,
                                        463,
                                        290,
                                        470
                                    ],
                                    "type": "inline_equation",
                                    "content": "V",
                                    "score": 0.9
                                },
                                {
                                    "bbox": [
                                        290,
                                        458,
                                        544,
                                        475
                                    ],
                                    "type": "text",
                                    "content": "is the vocabulary size. Effectively capturing this diversity",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                472,
                                543,
                                486
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        472,
                                        469,
                                        486
                                    ],
                                    "type": "text",
                                    "content": "within a fixed-length embedding presents a significant challenge. Additionally, reconstructing",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        470,
                                        475,
                                        511,
                                        483
                                    ],
                                    "type": "inline_equation",
                                    "content": "s = k \\times L",
                                    "score": 0.93
                                },
                                {
                                    "bbox": [
                                        511,
                                        472,
                                        543,
                                        486
                                    ],
                                    "type": "text",
                                    "content": "tokens",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                69,
                                484,
                                382,
                                496
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        484,
                                        93,
                                        496
                                    ],
                                    "type": "text",
                                    "content": "from",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        94,
                                        487,
                                        100,
                                        494
                                    ],
                                    "type": "inline_equation",
                                    "content": "L",
                                    "score": 0.89
                                },
                                {
                                    "bbox": [
                                        101,
                                        484,
                                        382,
                                        496
                                    ],
                                    "type": "text",
                                    "content": "chunk embeddings further compounds the difficulty of the task.",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                },
                {
                    "bbox": [
                        67,
                        502,
                        543,
                        622
                    ],
                    "type": "text",
                    "angle": 0,
                    "index": 8,
                    "lines": [
                        {
                            "bbox": [
                                67,
                                502,
                                543,
                                515
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        502,
                                        543,
                                        515
                                    ],
                                    "type": "text",
                                    "content": "Counterintuitively, directly continuing pre-training of the decoder to utilize encoder outputs did not reduce",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                513,
                                544,
                                529
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        513,
                                        544,
                                        529
                                    ],
                                    "type": "text",
                                    "content": "perplexity, even for the reconstruction task. To address the optimization challenge, we propose employing",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                525,
                                543,
                                540
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        525,
                                        543,
                                        540
                                    ],
                                    "type": "text",
                                    "content": "curriculum learning for both tasks. Curriculum learning incrementally increases task difficulty, enabling the",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                538,
                                542,
                                552
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        538,
                                        542,
                                        552
                                    ],
                                    "type": "text",
                                    "content": "model to gradually and effectively acquire complex skills. For the reconstruction task, training begins with",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                68,
                                550,
                                542,
                                562
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        550,
                                        400,
                                        562
                                    ],
                                    "type": "text",
                                    "content": "reconstructing a single chunk: the encoder receives one chunk embedding",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        400,
                                        555,
                                        410,
                                        561
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathbf { c } _ { 1 }",
                                    "score": 0.88
                                },
                                {
                                    "bbox": [
                                        410,
                                        550,
                                        429,
                                        562
                                    ],
                                    "type": "text",
                                    "content": "for",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        429,
                                        555,
                                        446,
                                        561
                                    ],
                                    "type": "inline_equation",
                                    "content": "x _ { 1 : k }",
                                    "score": 0.91
                                },
                                {
                                    "bbox": [
                                        446,
                                        550,
                                        542,
                                        562
                                    ],
                                    "type": "text",
                                    "content": "and and the decoder",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                66,
                                559,
                                544,
                                576
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        66,
                                        559,
                                        143,
                                        576
                                    ],
                                    "type": "text",
                                    "content": "reconstructs the",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        144,
                                        564,
                                        149,
                                        571
                                    ],
                                    "type": "inline_equation",
                                    "content": "k",
                                    "score": 0.89
                                },
                                {
                                    "bbox": [
                                        150,
                                        559,
                                        351,
                                        576
                                    ],
                                    "type": "text",
                                    "content": "tokens using the projected chunk embedding",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        351,
                                        563,
                                        370,
                                        574
                                    ],
                                    "type": "inline_equation",
                                    "content": "{ \\bf e } _ { 1 } ^ { \\mathrm { c n k } }",
                                    "score": 0.93
                                },
                                {
                                    "bbox": [
                                        370,
                                        559,
                                        544,
                                        576
                                    ],
                                    "type": "text",
                                    "content": ". Subsequently, the model reconstructs",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                70,
                                570,
                                545,
                                590
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        577,
                                        91,
                                        586
                                    ],
                                    "type": "inline_equation",
                                    "content": "x _ { 1 : 2 k }",
                                    "score": 0.72
                                },
                                {
                                    "bbox": [
                                        92,
                                        570,
                                        119,
                                        590
                                    ],
                                    "type": "text",
                                    "content": "from",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        119,
                                        574,
                                        160,
                                        586
                                    ],
                                    "type": "inline_equation",
                                    "content": "{ \\bf e } _ { 1 } ^ { \\mathrm { c n k } } , { \\bf e } _ { 2 } ^ { \\mathrm { c n k } }",
                                    "score": 0.94
                                },
                                {
                                    "bbox": [
                                        160,
                                        570,
                                        545,
                                        590
                                    ],
                                    "type": "text",
                                    "content": ", and so forth. To continuously adjust task difficulty, we vary the data mixture over",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                584,
                                543,
                                601
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        584,
                                        543,
                                        601
                                    ],
                                    "type": "text",
                                    "content": "time, starting with examples dominated by easier tasks (e.g., single chunk embedding) and gradually shifting",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                69,
                                598,
                                543,
                                610
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        598,
                                        314,
                                        610
                                    ],
                                    "type": "text",
                                    "content": "towards those dominated by more difficult tasks (i.e.,",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        314,
                                        600,
                                        321,
                                        607
                                    ],
                                    "type": "inline_equation",
                                    "content": "L",
                                    "score": 0.9
                                },
                                {
                                    "bbox": [
                                        321,
                                        598,
                                        543,
                                        610
                                    ],
                                    "type": "text",
                                    "content": "chunk embeddings). A visualization of the data",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                609,
                                544,
                                622
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        609,
                                        544,
                                        622
                                    ],
                                    "type": "text",
                                    "content": "mixture during curriculum learning is provided in figure 6, and the detailed scheduling is presented in table 8.",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                },
                {
                    "bbox": [
                        67,
                        627,
                        543,
                        712
                    ],
                    "type": "text",
                    "angle": 0,
                    "index": 9,
                    "lines": [
                        {
                            "bbox": [
                                69,
                                628,
                                542,
                                640
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        628,
                                        542,
                                        640
                                    ],
                                    "type": "text",
                                    "content": "Selective compression REFRAG introduces selective token compression, expanding important context chunks",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                639,
                                542,
                                652
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        639,
                                        542,
                                        652
                                    ],
                                    "type": "text",
                                    "content": "uncompressed to improve answer prediction. A RL policy, guided by next-paragraph prediction perplexity as",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                651,
                                542,
                                664
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        651,
                                        542,
                                        664
                                    ],
                                    "type": "text",
                                    "content": "a negative reward, determines which chunks to retain in their original form. The encoder and decoder are",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                68,
                                663,
                                542,
                                677
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        663,
                                        542,
                                        677
                                    ],
                                    "type": "text",
                                    "content": "fine-tuned to handle mixed inputs of compressed and uncompressed chunks. The policy network leverages",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                674,
                                543,
                                689
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        674,
                                        543,
                                        689
                                    ],
                                    "type": "text",
                                    "content": "chunk embeddings and masking to optimize sequential chunk expansion, thereby preserving the decoders",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                69,
                                688,
                                542,
                                700
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        688,
                                        542,
                                        700
                                    ],
                                    "type": "text",
                                    "content": "autoregressive property and enabling flexible placement of compression. Further discussion on sequential",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                69,
                                700,
                                226,
                                712
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        700,
                                        226,
                                        712
                                    ],
                                    "type": "text",
                                    "content": "selection is provided in section A.1.",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                }
            ],
            "discarded_blocks": [
                {
                    "bbox": [
                        302,
                        742,
                        309,
                        751
                    ],
                    "type": "page_number",
                    "angle": 0,
                    "index": 10,
                    "lines": [
                        {
                            "bbox": [
                                302,
                                742,
                                309,
                                753
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        302,
                                        742,
                                        309,
                                        753
                                    ],
                                    "type": "text",
                                    "content": "4",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                }
            ],
            "page_size": [
                612,
                792
            ],
            "page_idx": 3
        },
        {
            "para_blocks": [
                {
                    "bbox": [
                        67,
                        64,
                        222,
                        79
                    ],
                    "type": "title",
                    "angle": 0,
                    "index": 0,
                    "lines": [
                        {
                            "bbox": [
                                67,
                                63,
                                222,
                                83
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        63,
                                        222,
                                        83
                                    ],
                                    "type": "text",
                                    "content": "4 Experimental Results",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                },
                {
                    "bbox": [
                        67,
                        90,
                        543,
                        150
                    ],
                    "type": "text",
                    "angle": 0,
                    "index": 1,
                    "lines": [
                        {
                            "bbox": [
                                69,
                                91,
                                542,
                                102
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        91,
                                        542,
                                        102
                                    ],
                                    "type": "text",
                                    "content": "Training datasets. We use the Slimpajama dataset (Soboleva et al., 2023), an open source dataset for LLM pre-",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                69,
                                102,
                                543,
                                114
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        102,
                                        543,
                                        114
                                    ],
                                    "type": "text",
                                    "content": "training. This dataset contains data from Wikipedia, Arxiv, Books, StackExchange, GitHub, Commoncrawl,",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                68,
                                112,
                                543,
                                129
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        112,
                                        543,
                                        129
                                    ],
                                    "type": "text",
                                    "content": "C4. We only use the Book and ArXiv domains from the dataset since these two domains contain long",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                69,
                                126,
                                542,
                                139
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        126,
                                        542,
                                        139
                                    ],
                                    "type": "text",
                                    "content": "texts (Yen et al., 2024). We sampled from this dataset to construct a 20B token training dataset which",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                69,
                                138,
                                318,
                                150
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        139,
                                        108,
                                        150
                                    ],
                                    "type": "text",
                                    "content": "contains",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        108,
                                        138,
                                        128,
                                        149
                                    ],
                                    "type": "inline_equation",
                                    "content": "5 0 \\%",
                                    "score": 0.83
                                },
                                {
                                    "bbox": [
                                        129,
                                        139,
                                        318,
                                        150
                                    ],
                                    "type": "text",
                                    "content": "data from Arxiv and 50% data from Book.",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                },
                {
                    "bbox": [
                        67,
                        156,
                        542,
                        192
                    ],
                    "type": "text",
                    "angle": 0,
                    "index": 2,
                    "lines": [
                        {
                            "bbox": [
                                69,
                                156,
                                542,
                                170
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        156,
                                        542,
                                        170
                                    ],
                                    "type": "text",
                                    "content": "Evaluation datasets. We report the performance on the Book and ArXiv domain from Slimpajama which",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                167,
                                542,
                                182
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        167,
                                        542,
                                        182
                                    ],
                                    "type": "text",
                                    "content": "are hold out for evaluation only. To inspect the generalization of the model, we also report results on the",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                69,
                                179,
                                390,
                                194
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        179,
                                        390,
                                        194
                                    ],
                                    "type": "text",
                                    "content": "PG19 (Rae et al., 2019) and Proof-pile datasets (Azerbayev et al., 2023).",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                },
                {
                    "bbox": [
                        67,
                        198,
                        543,
                        330
                    ],
                    "type": "text",
                    "angle": 0,
                    "index": 3,
                    "lines": [
                        {
                            "bbox": [
                                68,
                                198,
                                543,
                                211
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        198,
                                        543,
                                        211
                                    ],
                                    "type": "text",
                                    "content": "Baselines. All baseline models are based on LLaMA-2-7B (Touvron et al., 2023), unless otherwise specified, to",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                209,
                                541,
                                222
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        209,
                                        500,
                                        222
                                    ],
                                    "type": "text",
                                    "content": "ensure fair comparison with prior work (Yen et al., 2024; Shi et al., 2024). Each data point contains",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        501,
                                        213,
                                        541,
                                        220
                                    ],
                                    "type": "inline_equation",
                                    "content": "T = 4 0 9 6",
                                    "score": 0.86
                                }
                            ]
                        },
                        {
                            "bbox": [
                                68,
                                221,
                                543,
                                236
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        221,
                                        143,
                                        236
                                    ],
                                    "type": "text",
                                    "content": "tokens, split into",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        143,
                                        223,
                                        181,
                                        232
                                    ],
                                    "type": "inline_equation",
                                    "content": "s = 2 0 4 8",
                                    "score": 0.84
                                },
                                {
                                    "bbox": [
                                        182,
                                        221,
                                        236,
                                        236
                                    ],
                                    "type": "text",
                                    "content": "context and",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        236,
                                        224,
                                        274,
                                        232
                                    ],
                                    "type": "inline_equation",
                                    "content": "o = 2 0 4 8",
                                    "score": 0.84
                                },
                                {
                                    "bbox": [
                                        274,
                                        221,
                                        454,
                                        236
                                    ],
                                    "type": "text",
                                    "content": "output tokens. We evaluate perplexity on",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        455,
                                        225,
                                        491,
                                        234
                                    ],
                                    "type": "inline_equation",
                                    "content": "x _ { s + 1 : s + o }",
                                    "score": 0.81
                                },
                                {
                                    "bbox": [
                                        492,
                                        221,
                                        543,
                                        236
                                    ],
                                    "type": "text",
                                    "content": ". Below, we",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                69,
                                233,
                                542,
                                247
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        233,
                                        542,
                                        247
                                    ],
                                    "type": "text",
                                    "content": "briefly describe the main baselines; further details are provided in section B. LLaMA-No Context: LLaMA-2-7B",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                246,
                                543,
                                258
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        246,
                                        129,
                                        258
                                    ],
                                    "type": "text",
                                    "content": "evaluated on",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        130,
                                        251,
                                        167,
                                        258
                                    ],
                                    "type": "inline_equation",
                                    "content": "x _ { s + 1 : s + o }",
                                    "score": 0.86
                                },
                                {
                                    "bbox": [
                                        167,
                                        246,
                                        543,
                                        258
                                    ],
                                    "type": "text",
                                    "content": "with only output tokens as input. LLaMA-Full Context: LLaMA-2-7B evaluated on",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                70,
                                257,
                                544,
                                271
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        262,
                                        107,
                                        270
                                    ],
                                    "type": "inline_equation",
                                    "content": "x _ { s + 1 : s + o }",
                                    "score": 0.83
                                },
                                {
                                    "bbox": [
                                        107,
                                        257,
                                        208,
                                        271
                                    ],
                                    "type": "text",
                                    "content": "with the full sequence",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        208,
                                        263,
                                        227,
                                        269
                                    ],
                                    "type": "inline_equation",
                                    "content": "x _ { 1 : T }",
                                    "score": 0.89
                                },
                                {
                                    "bbox": [
                                        227,
                                        257,
                                        544,
                                        271
                                    ],
                                    "type": "text",
                                    "content": "as input. CEPE: Memory-efficient long-context model (Yen et al., 2024)",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                66,
                                269,
                                543,
                                282
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        66,
                                        269,
                                        543,
                                        282
                                    ],
                                    "type": "text",
                                    "content": "a previous SOTA model which share some similarity to REFRAG CEPED denotes its instruction-tuned",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                281,
                                543,
                                294
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        281,
                                        543,
                                        294
                                    ],
                                    "type": "text",
                                    "content": "variant. LLaMA-32K: LLaMA-2-7B fine-tuned for 32K context length. REPLUG: Retrieval-augmented LLaMA-",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                293,
                                544,
                                307
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        293,
                                        407,
                                        307
                                    ],
                                    "type": "text",
                                    "content": "2-7B (Shi et al., 2024). REFRAG: Our approach (see Figure 1); REFRAG",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        408,
                                        300,
                                        413,
                                        305
                                    ],
                                    "type": "inline_equation",
                                    "content": "k",
                                    "score": 0.56
                                },
                                {
                                    "bbox": [
                                        414,
                                        293,
                                        533,
                                        307
                                    ],
                                    "type": "text",
                                    "content": "denotes compression rate",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        533,
                                        297,
                                        539,
                                        304
                                    ],
                                    "type": "inline_equation",
                                    "content": "k",
                                    "score": 0.86
                                },
                                {
                                    "bbox": [
                                        539,
                                        293,
                                        544,
                                        307
                                    ],
                                    "type": "text",
                                    "content": ",",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                68,
                                305,
                                544,
                                320
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        305,
                                        463,
                                        320
                                    ],
                                    "type": "text",
                                    "content": "REFRAGRL uses RL-based selective compression. LLaMAK: LLaMA-2-7B evaluated on",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        464,
                                        311,
                                        500,
                                        318
                                    ],
                                    "type": "inline_equation",
                                    "content": "x _ { s + 1 : s + o }",
                                    "score": 0.82
                                },
                                {
                                    "bbox": [
                                        501,
                                        305,
                                        544,
                                        320
                                    ],
                                    "type": "text",
                                    "content": "with the",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                316,
                                408,
                                331
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        316,
                                        156,
                                        331
                                    ],
                                    "type": "text",
                                    "content": "truncated sequence",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        157,
                                        323,
                                        188,
                                        330
                                    ],
                                    "type": "inline_equation",
                                    "content": "x _ { s - K : T }",
                                    "score": 0.91
                                },
                                {
                                    "bbox": [
                                        189,
                                        316,
                                        408,
                                        331
                                    ],
                                    "type": "text",
                                    "content": "as input to match the token count of REFRAG.",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                },
                {
                    "bbox": [
                        67,
                        335,
                        543,
                        419
                    ],
                    "type": "text",
                    "angle": 0,
                    "index": 4,
                    "lines": [
                        {
                            "bbox": [
                                68,
                                335,
                                544,
                                349
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        335,
                                        217,
                                        349
                                    ],
                                    "type": "text",
                                    "content": "Table 1 reports performance for",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        218,
                                        338,
                                        260,
                                        346
                                    ],
                                    "type": "inline_equation",
                                    "content": "s = 2 0 4 8",
                                    "score": 0.82
                                },
                                {
                                    "bbox": [
                                        260,
                                        335,
                                        282,
                                        349
                                    ],
                                    "type": "text",
                                    "content": "and",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        283,
                                        336,
                                        378,
                                        348
                                    ],
                                    "type": "inline_equation",
                                    "content": "o \\in \\{ 5 1 2 , 1 0 2 4 , 2 0 4 8 \\}",
                                    "score": 0.89
                                },
                                {
                                    "bbox": [
                                        378,
                                        335,
                                        503,
                                        349
                                    ],
                                    "type": "text",
                                    "content": ", where, e.g., P512 denotes",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        504,
                                        338,
                                        540,
                                        346
                                    ],
                                    "type": "inline_equation",
                                    "content": "o = 5 1 2",
                                    "score": 0.9
                                },
                                {
                                    "bbox": [
                                        541,
                                        335,
                                        544,
                                        349
                                    ],
                                    "type": "text",
                                    "content": ".",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                68,
                                347,
                                543,
                                361
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        347,
                                        543,
                                        361
                                    ],
                                    "type": "text",
                                    "content": "Bolded results compare baselines, excluding LLaMA-Full Context and LLaMA-32K, which use full",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                357,
                                541,
                                373
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        357,
                                        531,
                                        373
                                    ],
                                    "type": "text",
                                    "content": "context without compression and are expected to perform best. Notably, REFRAG8 and REFRAG",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        532,
                                        365,
                                        541,
                                        371
                                    ],
                                    "type": "inline_equation",
                                    "content": "^ { 1 6 }",
                                    "score": 0.72
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                372,
                                542,
                                384
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        372,
                                        542,
                                        384
                                    ],
                                    "type": "text",
                                    "content": "consistently outperform other baselines across nearly all settings, while also achieving lower latency than",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                68,
                                383,
                                543,
                                398
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        383,
                                        543,
                                        398
                                    ],
                                    "type": "text",
                                    "content": "CEPE (figure 2). For reference, LLaMA256 uses only the last 256 tokens, matching the number of chunk",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                393,
                                543,
                                410
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        393,
                                        195,
                                        410
                                    ],
                                    "type": "text",
                                    "content": "embeddings in REFRAG8 (",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        195,
                                        397,
                                        241,
                                        407
                                    ],
                                    "type": "inline_equation",
                                    "content": "s / k = 2 5 6 )",
                                    "score": 0.85
                                },
                                {
                                    "bbox": [
                                        242,
                                        393,
                                        458,
                                        410
                                    ],
                                    "type": "text",
                                    "content": "), yet REFRAG8 consistently surpasses LLaMA",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        458,
                                        401,
                                        470,
                                        407
                                    ],
                                    "type": "inline_equation",
                                    "content": "^ { 2 5 6 }",
                                    "score": 0.59
                                },
                                {
                                    "bbox": [
                                        471,
                                        393,
                                        543,
                                        410
                                    ],
                                    "type": "text",
                                    "content": ", demonstrating",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                405,
                                292,
                                422
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        405,
                                        292,
                                        422
                                    ],
                                    "type": "text",
                                    "content": "the effectiveness of compressed chunk embeddings.",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                },
                {
                    "bbox": [
                        67,
                        425,
                        543,
                        473
                    ],
                    "type": "text",
                    "angle": 0,
                    "index": 5,
                    "lines": [
                        {
                            "bbox": [
                                67,
                                424,
                                543,
                                438
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        424,
                                        149,
                                        438
                                    ],
                                    "type": "text",
                                    "content": "Table 2 evaluates",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        150,
                                        428,
                                        189,
                                        435
                                    ],
                                    "type": "inline_equation",
                                    "content": "o = 2 0 4 8",
                                    "score": 0.87
                                },
                                {
                                    "bbox": [
                                        190,
                                        424,
                                        329,
                                        438
                                    ],
                                    "type": "text",
                                    "content": "with extended context lengths",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        330,
                                        427,
                                        433,
                                        438
                                    ],
                                    "type": "inline_equation",
                                    "content": "s \\in \\{ 4 0 9 6 , 8 1 9 2 , 1 6 3 8 4 \\}",
                                    "score": 0.9
                                },
                                {
                                    "bbox": [
                                        433,
                                        424,
                                        543,
                                        438
                                    ],
                                    "type": "text",
                                    "content": ". Although our model is",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                435,
                                544,
                                451
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        435,
                                        116,
                                        451
                                    ],
                                    "type": "text",
                                    "content": "trained on",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        117,
                                        440,
                                        170,
                                        448
                                    ],
                                    "type": "inline_equation",
                                    "content": "s + o = 6 1 4 4",
                                    "score": 0.9
                                },
                                {
                                    "bbox": [
                                        170,
                                        435,
                                        318,
                                        451
                                    ],
                                    "type": "text",
                                    "content": ", both REFRAG8 and REFRAG",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        318,
                                        443,
                                        326,
                                        449
                                    ],
                                    "type": "inline_equation",
                                    "content": "^ { 1 6 }",
                                    "score": 0.77
                                },
                                {
                                    "bbox": [
                                        327,
                                        435,
                                        544,
                                        451
                                    ],
                                    "type": "text",
                                    "content": "maintain superior performance at longer contexts.",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                69,
                                449,
                                543,
                                463
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        449,
                                        543,
                                        463
                                    ],
                                    "type": "text",
                                    "content": "The original Llama-2-7B supports only a 4k context window, whereas our approach enables extrapolation via",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                68,
                                460,
                                400,
                                474
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        460,
                                        400,
                                        474
                                    ],
                                    "type": "text",
                                    "content": "chunk embeddings, extending context and supporting broader applications.",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                },
                {
                    "bbox": [
                        67,
                        479,
                        543,
                        527
                    ],
                    "type": "text",
                    "angle": 0,
                    "index": 6,
                    "lines": [
                        {
                            "bbox": [
                                68,
                                478,
                                544,
                                493
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        478,
                                        544,
                                        493
                                    ],
                                    "type": "text",
                                    "content": "With a compression rate of 16, we achieve a 9.3% average log-perplexity improvement over CEPE across",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                69,
                                491,
                                543,
                                503
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        491,
                                        274,
                                        503
                                    ],
                                    "type": "text",
                                    "content": "four datasets2. Meanwhile, our method is 16.53",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        274,
                                        495,
                                        282,
                                        502
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\times",
                                    "score": 0.61
                                },
                                {
                                    "bbox": [
                                        282,
                                        491,
                                        452,
                                        503
                                    ],
                                    "type": "text",
                                    "content": "faster than LLaMA in TTFT and 2.01",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        452,
                                        495,
                                        460,
                                        502
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\times",
                                    "score": 0.69
                                },
                                {
                                    "bbox": [
                                        460,
                                        491,
                                        543,
                                        503
                                    ],
                                    "type": "text",
                                    "content": "faster than CEPE",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                69,
                                502,
                                543,
                                516
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        502,
                                        543,
                                        516
                                    ],
                                    "type": "text",
                                    "content": "(section B.4). At a compression rate of 32, our log-perplexity matches CEPE, while TTFT acceleration",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                514,
                                319,
                                528
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        514,
                                        146,
                                        528
                                    ],
                                    "type": "text",
                                    "content": "increases to 30.85",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        146,
                                        518,
                                        154,
                                        525
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\times",
                                    "score": 0.67
                                },
                                {
                                    "bbox": [
                                        155,
                                        514,
                                        253,
                                        528
                                    ],
                                    "type": "text",
                                    "content": "over LLaMA and 3.75",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        253,
                                        518,
                                        261,
                                        525
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\times",
                                    "score": 0.67
                                },
                                {
                                    "bbox": [
                                        262,
                                        514,
                                        319,
                                        528
                                    ],
                                    "type": "text",
                                    "content": "over CEPE.",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                },
                {
                    "bbox": [
                        67,
                        533,
                        543,
                        642
                    ],
                    "type": "text",
                    "angle": 0,
                    "index": 7,
                    "lines": [
                        {
                            "bbox": [
                                66,
                                533,
                                542,
                                564
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        66,
                                        539,
                                        441,
                                        564
                                    ],
                                    "type": "text",
                                    "content": "chunks in the original token space using the RL policy. The effective compression rate",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        69,
                                        533,
                                        470,
                                        545
                                    ],
                                    "type": "text",
                                    "content": "Figure 3 presents the performance of various methods for selective compression. We expand",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        441,
                                        546,
                                        472,
                                        559
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\frac { k } { 1 - p + k p }",
                                    "score": 0.94
                                },
                                {
                                    "bbox": [
                                        470,
                                        538,
                                        476,
                                        545
                                    ],
                                    "type": "inline_equation",
                                    "content": "p",
                                    "score": 0.88
                                },
                                {
                                    "bbox": [
                                        476,
                                        533,
                                        542,
                                        545
                                    ],
                                    "type": "text",
                                    "content": "fraction of the",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        476,
                                        539,
                                        542,
                                        564
                                    ],
                                    "type": "text",
                                    "content": "decreases when",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                557,
                                543,
                                572
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        557,
                                        216,
                                        572
                                    ],
                                    "type": "text",
                                    "content": "fewer chunks are compressed (i.e.,",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        217,
                                        563,
                                        222,
                                        570
                                    ],
                                    "type": "inline_equation",
                                    "content": "p",
                                    "score": 0.89
                                },
                                {
                                    "bbox": [
                                        222,
                                        557,
                                        401,
                                        572
                                    ],
                                    "type": "text",
                                    "content": "increases). We compare the perplexity of",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        401,
                                        563,
                                        438,
                                        570
                                    ],
                                    "type": "inline_equation",
                                    "content": "x _ { s + 1 : s + o }",
                                    "score": 0.89
                                },
                                {
                                    "bbox": [
                                        438,
                                        557,
                                        543,
                                        572
                                    ],
                                    "type": "text",
                                    "content": "using different selection",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                68,
                                570,
                                543,
                                584
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        570,
                                        170,
                                        584
                                    ],
                                    "type": "text",
                                    "content": "policy under different",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        170,
                                        575,
                                        176,
                                        582
                                    ],
                                    "type": "inline_equation",
                                    "content": "p",
                                    "score": 0.89
                                },
                                {
                                    "bbox": [
                                        176,
                                        570,
                                        543,
                                        584
                                    ],
                                    "type": "text",
                                    "content": ". The perplexity-based selection is an heuristic based selection which compresses",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                581,
                                543,
                                596
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        581,
                                        543,
                                        596
                                    ],
                                    "type": "text",
                                    "content": "chunks with low perplexity (Perplexity-desc) or high perplexity (Perplexity-asc). The perplexity is measured",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                69,
                                594,
                                543,
                                608
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        594,
                                        543,
                                        608
                                    ],
                                    "type": "text",
                                    "content": "by the LLaMA-2-7B model. Intuitively, a chunk with lower perplexity contains less information and can",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                69,
                                605,
                                542,
                                618
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        605,
                                        542,
                                        618
                                    ],
                                    "type": "text",
                                    "content": "therefore be compressed with minimal information loss. Ideally, this approach should outperform random",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                616,
                                543,
                                632
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        616,
                                        543,
                                        632
                                    ],
                                    "type": "text",
                                    "content": "selection, which is indeed observed in figure 3. The RL-based selective compression policy consistently achieves",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                66,
                                628,
                                321,
                                646
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        66,
                                        628,
                                        310,
                                        646
                                    ],
                                    "type": "text",
                                    "content": "superior performance across varying compression rates",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        310,
                                        635,
                                        316,
                                        642
                                    ],
                                    "type": "inline_equation",
                                    "content": "p",
                                    "score": 0.83
                                },
                                {
                                    "bbox": [
                                        317,
                                        628,
                                        321,
                                        646
                                    ],
                                    "type": "text",
                                    "content": ".",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                },
                {
                    "bbox": [
                        67,
                        657,
                        173,
                        670
                    ],
                    "type": "title",
                    "angle": 0,
                    "index": 8,
                    "lines": [
                        {
                            "bbox": [
                                68,
                                654,
                                173,
                                673
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        654,
                                        173,
                                        673
                                    ],
                                    "type": "text",
                                    "content": "4.1 Ablation Study",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                },
                {
                    "bbox": [
                        67,
                        676,
                        542,
                        700
                    ],
                    "type": "text",
                    "angle": 0,
                    "index": 9,
                    "lines": [
                        {
                            "bbox": [
                                69,
                                675,
                                543,
                                689
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        675,
                                        543,
                                        689
                                    ],
                                    "type": "text",
                                    "content": "Curriculum learning is essential for effective training in the reconstruction task. The reconstruction task, while",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                68,
                                688,
                                543,
                                700
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        688,
                                        543,
                                        700
                                    ],
                                    "type": "text",
                                    "content": "intuitive, is particularly challenging when multiple chunks must be reconstructed. Table 11 shows the",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                }
            ],
            "discarded_blocks": [
                {
                    "bbox": [
                        78,
                        706,
                        396,
                        721
                    ],
                    "type": "page_footnote",
                    "angle": 0,
                    "index": 10,
                    "lines": [
                        {
                            "bbox": [
                                78,
                                705,
                                398,
                                724
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        78,
                                        708,
                                        398,
                                        724
                                    ],
                                    "type": "text",
                                    "content": "2Percentage calculated as LLaMA-No Contextmin(LLaMA-Full Context,LLaMA-32K)",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        208,
                                        705,
                                        367,
                                        715
                                    ],
                                    "type": "text",
                                    "content": "LLaMA-No ContextLog-perplexity to inspect",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                },
                {
                    "bbox": [
                        302,
                        742,
                        309,
                        751
                    ],
                    "type": "page_number",
                    "angle": 0,
                    "index": 11,
                    "lines": [
                        {
                            "bbox": [
                                301,
                                741,
                                310,
                                753
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        301,
                                        741,
                                        310,
                                        753
                                    ],
                                    "type": "text",
                                    "content": "5",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                }
            ],
            "page_size": [
                612,
                792
            ],
            "page_idx": 4
        },
        {
            "para_blocks": [
                {
                    "type": "table",
                    "bbox": [
                        70,
                        105,
                        542,
                        212
                    ],
                    "blocks": [
                        {
                            "bbox": [
                                67,
                                62,
                                543,
                                96
                            ],
                            "lines": [
                                {
                                    "bbox": [
                                        67,
                                        60,
                                        543,
                                        76
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                67,
                                                60,
                                                233,
                                                76
                                            ],
                                            "type": "text",
                                            "content": "Table 1 Log-Perplexity on output tokens",
                                            "score": 1.0
                                        },
                                        {
                                            "bbox": [
                                                233,
                                                67,
                                                266,
                                                73
                                            ],
                                            "type": "inline_equation",
                                            "content": "x _ { s + 1 : s + o }",
                                            "score": 0.9
                                        },
                                        {
                                            "bbox": [
                                                266,
                                                60,
                                                353,
                                                76
                                            ],
                                            "type": "text",
                                            "content": "given context tokens",
                                            "score": 1.0
                                        },
                                        {
                                            "bbox": [
                                                354,
                                                67,
                                                369,
                                                73
                                            ],
                                            "type": "inline_equation",
                                            "content": "x _ { 1 : s }",
                                            "score": 0.88
                                        },
                                        {
                                            "bbox": [
                                                369,
                                                60,
                                                487,
                                                76
                                            ],
                                            "type": "text",
                                            "content": "for different models. We use",
                                            "score": 1.0
                                        },
                                        {
                                            "bbox": [
                                                488,
                                                64,
                                                523,
                                                72
                                            ],
                                            "type": "inline_equation",
                                            "content": "s = 2 0 4 8",
                                            "score": 0.75
                                        },
                                        {
                                            "bbox": [
                                                523,
                                                60,
                                                543,
                                                76
                                            ],
                                            "type": "text",
                                            "content": "and",
                                            "score": 1.0
                                        }
                                    ]
                                },
                                {
                                    "bbox": [
                                        70,
                                        73,
                                        543,
                                        86
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                70,
                                                73,
                                                153,
                                                85
                                            ],
                                            "type": "inline_equation",
                                            "content": "o \\in \\{ 5 1 2 , 1 0 2 4 , 2 0 4 8 \\}",
                                            "score": 0.79
                                        },
                                        {
                                            "bbox": [
                                                154,
                                                73,
                                                543,
                                                86
                                            ],
                                            "type": "text",
                                            "content": "here. Bolding are based on comparing baselines excluding LLaMA-Full Context and LLaMA-",
                                            "score": 1.0
                                        }
                                    ]
                                },
                                {
                                    "bbox": [
                                        67,
                                        83,
                                        390,
                                        98
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                67,
                                                83,
                                                390,
                                                98
                                            ],
                                            "type": "text",
                                            "content": "32K since they are expected to be the best (ideally). The lower the better ().",
                                            "score": 1.0
                                        }
                                    ]
                                }
                            ],
                            "index": 0,
                            "angle": 0,
                            "type": "table_caption"
                        },
                        {
                            "bbox": [
                                70,
                                105,
                                542,
                                212
                            ],
                            "lines": [
                                {
                                    "bbox": [
                                        70,
                                        105,
                                        542,
                                        212
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                70,
                                                105,
                                                542,
                                                212
                                            ],
                                            "type": "table",
                                            "html": "<table><tr><td></td><td colspan=\"3\">Arxiv</td><td colspan=\"3\">Book</td><td colspan=\"3\">PG19</td><td colspan=\"3\">ProofPile</td></tr><tr><td></td><td>P512</td><td>P1024</td><td>P2048</td><td>P512</td><td>P1024</td><td>P2048</td><td>P512</td><td>P1024</td><td>P2048</td><td>P512</td><td>P1024</td><td>P2048 </td></tr><tr><td>LLAMA-FULL CONTEXT</td><td>1.075</td><td>1.074</td><td>1.069</td><td>1.830</td><td>1.827</td><td>1.826</td><td>1.947</td><td>1.941</td><td>1.935</td><td>0.952</td><td>0.940</td><td>0.931</td></tr><tr><td>LLAMA-32K</td><td>1.086</td><td>1.084</td><td>1.076</td><td>1.887</td><td>1.883</td><td>1.880</td><td>1.988</td><td>1.982</td><td>1.975</td><td>0.961</td><td>0.948</td><td>0.937</td></tr><tr><td>LLAMA-No CONTEXT</td><td>1.526</td><td>1.371</td><td>1.254</td><td>2.101</td><td>1.995</td><td>1.927</td><td>2.211</td><td>2.102</td><td>2.030</td><td>1.437</td><td>1.256</td><td>1.127</td></tr><tr><td>\\( LLAMA_{256} \\)</td><td>1.267</td><td>1.221</td><td>1.171</td><td>1.924</td><td>1.897</td><td>1.874</td><td>2.031</td><td>2.003</td><td>1.978</td><td>1.156</td><td>1.094</td><td>1.038</td></tr><tr><td>REPLUG</td><td>1.526</td><td>1.371</td><td>1.254</td><td>2.101</td><td>1.995</td><td>1.927</td><td>2.211</td><td>2.102</td><td>2.030</td><td>1.437</td><td>1.256</td><td>1.127</td></tr><tr><td>CEPE</td><td>1.196</td><td>1.148</td><td>1.107</td><td>1.946</td><td>1.896</td><td>1.864</td><td>2.057</td><td>2.002</td><td>1.964</td><td>1.075</td><td>1.014</td><td>0.968</td></tr><tr><td>\\( REFRAG_8 \\)</td><td>1.124</td><td>1.091</td><td>1.062</td><td>1.905</td><td>1.868</td><td>1.844</td><td>1.996</td><td>1.956</td><td>1.927</td><td>0.997</td><td>0.952</td><td>0.916</td></tr><tr><td>\\( REFRAG_{16} \\)</td><td>1.157</td><td>1.114</td><td>1.076</td><td>1.925</td><td>1.882</td><td>1.853</td><td>2.016</td><td>1.971</td><td>1.938</td><td>1.034</td><td>0.976</td><td>0.931</td></tr><tr><td>\\( REFRAG_{32} \\)</td><td>1.215</td><td>1.154</td><td>1.103</td><td>1.946</td><td>1.896</td><td>1.862</td><td>2.039</td><td>1.987</td><td>1.949</td><td>1.097</td><td>1.020</td><td>0.961</td></tr></table>",
                                            "image_path": "fb166c4a669d6f86db47203f418e41b4a2e3beff209f1bb8405d580fb286ea00.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 1,
                            "angle": 0,
                            "type": "table_body"
                        }
                    ],
                    "index": 1
                },
                {
                    "type": "table",
                    "bbox": [
                        70,
                        263,
                        542,
                        357
                    ],
                    "blocks": [
                        {
                            "bbox": [
                                67,
                                221,
                                542,
                                255
                            ],
                            "lines": [
                                {
                                    "bbox": [
                                        67,
                                        220,
                                        543,
                                        234
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                67,
                                                220,
                                                231,
                                                234
                                            ],
                                            "type": "text",
                                            "content": "Table 2 Log-Perplexity on output tokens",
                                            "score": 1.0
                                        },
                                        {
                                            "bbox": [
                                                231,
                                                226,
                                                265,
                                                233
                                            ],
                                            "type": "inline_equation",
                                            "content": "x _ { s + 1 : s + o }",
                                            "score": 0.89
                                        },
                                        {
                                            "bbox": [
                                                265,
                                                220,
                                                430,
                                                234
                                            ],
                                            "type": "text",
                                            "content": "given different length of context. We use",
                                            "score": 1.0
                                        },
                                        {
                                            "bbox": [
                                                431,
                                                221,
                                                523,
                                                233
                                            ],
                                            "type": "inline_equation",
                                            "content": "s \\in \\{ 4 0 9 6 , 8 1 9 2 , 1 6 3 8 4 \\}",
                                            "score": 0.86
                                        },
                                        {
                                            "bbox": [
                                                524,
                                                220,
                                                543,
                                                234
                                            ],
                                            "type": "text",
                                            "content": "and",
                                            "score": 1.0
                                        }
                                    ]
                                },
                                {
                                    "bbox": [
                                        70,
                                        232,
                                        542,
                                        244
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                70,
                                                233,
                                                105,
                                                242
                                            ],
                                            "type": "inline_equation",
                                            "content": "o = 2 0 4 8",
                                            "score": 0.84
                                        },
                                        {
                                            "bbox": [
                                                106,
                                                232,
                                                542,
                                                244
                                            ],
                                            "type": "text",
                                            "content": "here. Bolding are based on comparing baselines excluding LLaMA-Full Context and LLaMA-32K since",
                                            "score": 1.0
                                        }
                                    ]
                                },
                                {
                                    "bbox": [
                                        69,
                                        243,
                                        345,
                                        255
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                69,
                                                243,
                                                345,
                                                255
                                            ],
                                            "type": "text",
                                            "content": "they are expected to be the best (ideally). The lower the better ().",
                                            "score": 1.0
                                        }
                                    ]
                                }
                            ],
                            "index": 2,
                            "angle": 0,
                            "type": "table_caption"
                        },
                        {
                            "bbox": [
                                70,
                                263,
                                542,
                                357
                            ],
                            "lines": [
                                {
                                    "bbox": [
                                        70,
                                        263,
                                        542,
                                        357
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                70,
                                                263,
                                                542,
                                                357
                                            ],
                                            "type": "table",
                                            "html": "<table><tr><td></td><td colspan=\"4\">Context Length =4096</td><td colspan=\"4\">Context Length=8192</td><td colspan=\"4\">Context Length=16384</td></tr><tr><td></td><td>Arxiv</td><td>Book</td><td>PG19</td><td>ProofPile</td><td>Arxiv</td><td>Book</td><td>PG19</td><td>ProofPile</td><td>Arxiv</td><td>Book</td><td>PG19</td><td>ProofPile </td></tr><tr><td>LLAMA-FULL CONTEXT</td><td>6.751</td><td>6.956</td><td>6.829</td><td>6.701</td><td>9.675</td><td>9.069</td><td>8.963</td><td>9.401</td><td>9.043</td><td>8.913</td><td>8.848</td><td>8.989</td></tr><tr><td>LLAMA-32K</td><td>1.037</td><td>1.862</td><td>1.960</td><td>0.898</td><td>0.965</td><td>1.867</td><td>1.947</td><td>0.834</td><td>0.865</td><td>1.840</td><td>1.943</td><td>0.770</td></tr><tr><td>LLAMA-No CONTEXT</td><td>1.253</td><td>1.925</td><td>2.030</td><td>1.126</td><td>1.226</td><td>1.949</td><td>2.032</td><td>1.110</td><td>1.174</td><td>1.939</td><td>2.041</td><td>1.081</td></tr><tr><td>REPLUG</td><td>1.253</td><td>1.925</td><td>2.030</td><td>1.126</td><td>1.226</td><td>1.949</td><td>2.032</td><td>1.110</td><td>1.174</td><td>1.939</td><td>2.041</td><td>1.081</td></tr><tr><td>CEPE</td><td>1.085</td><td>1.856</td><td>1.959</td><td>0.945</td><td>1.032</td><td>1.878</td><td>1.958</td><td>0.904</td><td>0.960</td><td>1.864</td><td>1.966</td><td>0.863</td></tr><tr><td>REFRAG8</td><td>1.042</td><td>1.837</td><td>1.922</td><td>0.894</td><td>0.983</td><td>1.839</td><td>1.922</td><td>0.858</td><td>0.977</td><td>1.840</td><td>1.939</td><td>0.891</td></tr><tr><td>REFRAG16</td><td>1.058</td><td>1.847</td><td>1.934</td><td>0.910</td><td>0.994</td><td>1.845</td><td>1.932</td><td>0.871</td><td>0.942</td><td>1.840</td><td>1.945</td><td>0.850</td></tr><tr><td>REFRAG32</td><td>1.088</td><td>1.857</td><td>1.946</td><td>0.944</td><td>1.032</td><td>1.860</td><td>1.945</td><td>0.912</td><td>0.969</td><td>1.852</td><td>1.955</td><td>0.880</td></tr></table>",
                                            "image_path": "2126713f80b581f6736151e08d8935600ce900c54f56500fc5af5d09b2301ae7.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 3,
                            "angle": 0,
                            "type": "table_body"
                        }
                    ],
                    "index": 3
                },
                {
                    "bbox": [
                        67,
                        376,
                        543,
                        411
                    ],
                    "type": "text",
                    "angle": 0,
                    "index": 4,
                    "lines": [
                        {
                            "bbox": [
                                68,
                                375,
                                543,
                                389
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        375,
                                        501,
                                        389
                                    ],
                                    "type": "text",
                                    "content": "performance of the reconstruction task with and without curriculum learning (i.e., reconstruction of",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        501,
                                        380,
                                        517,
                                        388
                                    ],
                                    "type": "inline_equation",
                                    "content": "x _ { 1 : s }",
                                    "score": 0.9
                                },
                                {
                                    "bbox": [
                                        517,
                                        375,
                                        543,
                                        389
                                    ],
                                    "type": "text",
                                    "content": "from",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                70,
                                388,
                                542,
                                400
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        390,
                                        85,
                                        400
                                    ],
                                    "type": "inline_equation",
                                    "content": "s / k",
                                    "score": 0.91
                                },
                                {
                                    "bbox": [
                                        86,
                                        388,
                                        542,
                                        400
                                    ],
                                    "type": "text",
                                    "content": "chunk embedding directly). The results indicate that curriculum learning is essential for the success of",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                69,
                                399,
                                175,
                                412
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        399,
                                        175,
                                        412
                                    ],
                                    "type": "text",
                                    "content": "the reconstruction task.",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                },
                {
                    "bbox": [
                        67,
                        418,
                        543,
                        465
                    ],
                    "type": "text",
                    "angle": 0,
                    "index": 5,
                    "lines": [
                        {
                            "bbox": [
                                69,
                                417,
                                543,
                                430
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        417,
                                        543,
                                        430
                                    ],
                                    "type": "text",
                                    "content": "Reconstruction task is essential for the model to learn the continual pre-training task. Table 12 shows the",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                68,
                                430,
                                543,
                                441
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        430,
                                        543,
                                        441
                                    ],
                                    "type": "text",
                                    "content": "performance of the continual pre-training task with and without initialization from the reconstruction task.",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                69,
                                441,
                                542,
                                454
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        441,
                                        542,
                                        454
                                    ],
                                    "type": "text",
                                    "content": "The results indicate that pre-training on the reconstruction task is important for the success of continual",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                453,
                                127,
                                468
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        453,
                                        127,
                                        468
                                    ],
                                    "type": "text",
                                    "content": "pre-training.",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                },
                {
                    "bbox": [
                        67,
                        472,
                        543,
                        544
                    ],
                    "type": "text",
                    "angle": 0,
                    "index": 6,
                    "lines": [
                        {
                            "bbox": [
                                67,
                                470,
                                543,
                                486
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        470,
                                        543,
                                        486
                                    ],
                                    "type": "text",
                                    "content": "Advantages of RL-based selective compression. Figure 3 under various compression rates, achieved by varying",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                68,
                                483,
                                542,
                                497
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        483,
                                        285,
                                        497
                                    ],
                                    "type": "text",
                                    "content": "the number of chunks to compress (i.e., adjusting",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        285,
                                        486,
                                        291,
                                        495
                                    ],
                                    "type": "inline_equation",
                                    "content": "p",
                                    "score": 0.59
                                },
                                {
                                    "bbox": [
                                        292,
                                        483,
                                        542,
                                        497
                                    ],
                                    "type": "text",
                                    "content": "). Notably, a compression rate of 8 can be obtained either",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                69,
                                495,
                                541,
                                509
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        495,
                                        536,
                                        509
                                    ],
                                    "type": "text",
                                    "content": "by configuring REFRAG16 to compress the appropriate number of chunks, or by employing REFRAG",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        536,
                                        502,
                                        541,
                                        507
                                    ],
                                    "type": "inline_equation",
                                    "content": "^ { 8 }",
                                    "score": 0.59
                                }
                            ]
                        },
                        {
                            "bbox": [
                                69,
                                507,
                                543,
                                520
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        507,
                                        543,
                                        520
                                    ],
                                    "type": "text",
                                    "content": "with full compression, which is natively trained at a compression rate of 8. This raises a natural question:",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                69,
                                519,
                                542,
                                532
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        519,
                                        542,
                                        532
                                    ],
                                    "type": "text",
                                    "content": "does the former approach outperform the latter? Table 13 demonstrates that REFRAG16 with RL-based",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                530,
                                544,
                                544
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        530,
                                        544,
                                        544
                                    ],
                                    "type": "text",
                                    "content": "selective compression consistently outperforms REFRAG8 across different datasets and context lengths.",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "image",
                    "bbox": [
                        70,
                        563,
                        541,
                        676
                    ],
                    "blocks": [
                        {
                            "bbox": [
                                70,
                                563,
                                541,
                                676
                            ],
                            "lines": [
                                {
                                    "bbox": [
                                        70,
                                        563,
                                        541,
                                        676
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                70,
                                                563,
                                                541,
                                                676
                                            ],
                                            "type": "image",
                                            "image_path": "caa26511083be1c2d8491f6c0d90b86f45d424ae0ec30e112af7645512163b91.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 7,
                            "angle": 0,
                            "type": "image_body"
                        },
                        {
                            "bbox": [
                                67,
                                687,
                                543,
                                721
                            ],
                            "lines": [
                                {
                                    "bbox": [
                                        69,
                                        687,
                                        542,
                                        699
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                69,
                                                687,
                                                179,
                                                699
                                            ],
                                            "type": "text",
                                            "content": "Figure 3 Log-Perplexity on",
                                            "score": 1.0
                                        },
                                        {
                                            "bbox": [
                                                180,
                                                691,
                                                214,
                                                697
                                            ],
                                            "type": "inline_equation",
                                            "content": "x _ { s + 1 : s + o }",
                                            "score": 0.85
                                        },
                                        {
                                            "bbox": [
                                                214,
                                                687,
                                                542,
                                                699
                                            ],
                                            "type": "text",
                                            "content": "under varying compression rates by selectively compressing different percentages",
                                            "score": 1.0
                                        }
                                    ]
                                },
                                {
                                    "bbox": [
                                        68,
                                        696,
                                        542,
                                        710
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                68,
                                                696,
                                                542,
                                                710
                                            ],
                                            "type": "text",
                                            "content": "of chunks. We compare three selection methods: RL (trained policy), Perplexity-desc (heuristic: lower perplexity),",
                                            "score": 1.0
                                        }
                                    ]
                                },
                                {
                                    "bbox": [
                                        69,
                                        708,
                                        381,
                                        721
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                69,
                                                708,
                                                381,
                                                721
                                            ],
                                            "type": "text",
                                            "content": "Perplexity-asc (heuristic: higher perplexity), and Random (random selection).",
                                            "score": 1.0
                                        }
                                    ]
                                }
                            ],
                            "index": 8,
                            "angle": 0,
                            "type": "image_caption"
                        }
                    ],
                    "index": 7
                }
            ],
            "discarded_blocks": [
                {
                    "bbox": [
                        302,
                        742,
                        309,
                        751
                    ],
                    "type": "page_number",
                    "angle": 0,
                    "index": 9,
                    "lines": [
                        {
                            "bbox": [
                                302,
                                742,
                                310,
                                753
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        302,
                                        742,
                                        310,
                                        753
                                    ],
                                    "type": "text",
                                    "content": "6",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                }
            ],
            "page_size": [
                612,
                792
            ],
            "page_idx": 5
        },
        {
            "para_blocks": [
                {
                    "type": "image",
                    "bbox": [
                        77,
                        62,
                        195,
                        137
                    ],
                    "blocks": [
                        {
                            "bbox": [
                                77,
                                62,
                                195,
                                137
                            ],
                            "lines": [
                                {
                                    "bbox": [
                                        77,
                                        62,
                                        195,
                                        137
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                77,
                                                62,
                                                195,
                                                137
                                            ],
                                            "type": "image",
                                            "image_path": "5ed1e334dd0dd0ee255404c503d13de58df6eb58f1d659bded347401843848bd.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 0,
                            "angle": 0,
                            "type": "image_body"
                        },
                        {
                            "bbox": [
                                134,
                                141,
                                247,
                                151
                            ],
                            "lines": [
                                {
                                    "bbox": [
                                        137,
                                        140,
                                        247,
                                        151
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                137,
                                                140,
                                                167,
                                                151
                                            ],
                                            "type": "text",
                                            "content": "Llama",
                                            "score": 1.0
                                        },
                                        {
                                            "bbox": [
                                                174,
                                                142,
                                                247,
                                                150
                                            ],
                                            "type": "text",
                                            "content": "REFRAG 8  compression",
                                            "score": 1.0
                                        }
                                    ]
                                }
                            ],
                            "index": 1,
                            "angle": 0,
                            "type": "image_caption"
                        }
                    ],
                    "index": 0
                },
                {
                    "type": "image",
                    "bbox": [
                        194,
                        63,
                        304,
                        137
                    ],
                    "blocks": [
                        {
                            "bbox": [
                                194,
                                63,
                                304,
                                137
                            ],
                            "lines": [
                                {
                                    "bbox": [
                                        194,
                                        63,
                                        304,
                                        137
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                194,
                                                63,
                                                304,
                                                137
                                            ],
                                            "type": "image",
                                            "image_path": "c126ce94c05521d2d2dd378093d26ea8904ee02bfe52f69ad864cb5c4e7bc0fb.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 2,
                            "angle": 0,
                            "type": "image_body"
                        }
                    ],
                    "index": 2
                },
                {
                    "type": "image",
                    "bbox": [
                        306,
                        62,
                        420,
                        137
                    ],
                    "blocks": [
                        {
                            "bbox": [
                                306,
                                62,
                                420,
                                137
                            ],
                            "lines": [
                                {
                                    "bbox": [
                                        306,
                                        62,
                                        420,
                                        137
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                306,
                                                62,
                                                420,
                                                137
                                            ],
                                            "type": "image",
                                            "image_path": "217313673a454435fb8dde43fad52ad13bf8769c37b8d91fa6af4adf8049bb65.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 3,
                            "angle": 0,
                            "type": "image_body"
                        }
                    ],
                    "index": 3
                },
                {
                    "type": "image",
                    "bbox": [
                        422,
                        63,
                        533,
                        137
                    ],
                    "blocks": [
                        {
                            "bbox": [
                                422,
                                63,
                                533,
                                137
                            ],
                            "lines": [
                                {
                                    "bbox": [
                                        422,
                                        63,
                                        533,
                                        137
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                422,
                                                63,
                                                533,
                                                137
                                            ],
                                            "type": "image",
                                            "image_path": "120659b02c8920d157a2354370b4b55412bab8f19b9dd8f56d3626c25153c89b.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 4,
                            "angle": 0,
                            "type": "image_body"
                        },
                        {
                            "bbox": [
                                363,
                                141,
                                476,
                                151
                            ],
                            "lines": [
                                {
                                    "bbox": [
                                        366,
                                        142,
                                        476,
                                        151
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                366,
                                                142,
                                                395,
                                                151
                                            ],
                                            "type": "text",
                                            "content": "Llama",
                                            "score": 1.0
                                        },
                                        {
                                            "bbox": [
                                                402,
                                                142,
                                                476,
                                                150
                                            ],
                                            "type": "text",
                                            "content": "REFRAG 8  compression",
                                            "score": 1.0
                                        }
                                    ]
                                }
                            ],
                            "index": 5,
                            "angle": 0,
                            "type": "image_caption"
                        },
                        {
                            "bbox": [
                                67,
                                162,
                                542,
                                196
                            ],
                            "lines": [
                                {
                                    "bbox": [
                                        70,
                                        163,
                                        542,
                                        174
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                70,
                                                163,
                                                542,
                                                174
                                            ],
                                            "type": "text",
                                            "content": "Figure 4 RAG performance comparison under a strong retriever scenario (left) and a weak retriever scenario and a",
                                            "score": 1.0
                                        }
                                    ]
                                },
                                {
                                    "bbox": [
                                        69,
                                        174,
                                        542,
                                        186
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                69,
                                                174,
                                                542,
                                                186
                                            ],
                                            "type": "text",
                                            "content": "strong retriever scenario (right). REFRAG perform similarly to LLaMA model under the same retrieved passages",
                                            "score": 1.0
                                        }
                                    ]
                                },
                                {
                                    "bbox": [
                                        67,
                                        183,
                                        462,
                                        198
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                67,
                                                183,
                                                462,
                                                198
                                            ],
                                            "type": "text",
                                            "content": "(slightly better in a weaker retriever case) while outperform significantly under the same latency.",
                                            "score": 1.0
                                        }
                                    ]
                                }
                            ],
                            "index": 6,
                            "angle": 0,
                            "type": "image_caption"
                        }
                    ],
                    "index": 4
                },
                {
                    "bbox": [
                        67,
                        217,
                        543,
                        266
                    ],
                    "type": "text",
                    "angle": 0,
                    "index": 7,
                    "lines": [
                        {
                            "bbox": [
                                67,
                                215,
                                543,
                                232
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        215,
                                        543,
                                        232
                                    ],
                                    "type": "text",
                                    "content": "This finding is particularly surprising, as REFRAG16 achieves a compression rate of 8 without recomputing",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                69,
                                229,
                                542,
                                241
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        229,
                                        374,
                                        241
                                    ],
                                    "type": "text",
                                    "content": "chunk embeddings, yet still surpasses the performance of REFRAG",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        374,
                                        236,
                                        379,
                                        240
                                    ],
                                    "type": "inline_equation",
                                    "content": "^ { 8 }",
                                    "score": 0.78
                                },
                                {
                                    "bbox": [
                                        380,
                                        229,
                                        542,
                                        241
                                    ],
                                    "type": "text",
                                    "content": ". These results further highlight the",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                69,
                                240,
                                542,
                                254
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        240,
                                        542,
                                        254
                                    ],
                                    "type": "text",
                                    "content": "effectiveness of the RL-trained policy and underscore the practicality of dynamically adjusting the compression",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                68,
                                253,
                                250,
                                266
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        253,
                                        250,
                                        266
                                    ],
                                    "type": "text",
                                    "content": "rate without compromising performance.",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                },
                {
                    "bbox": [
                        67,
                        270,
                        543,
                        344
                    ],
                    "type": "text",
                    "angle": 0,
                    "index": 8,
                    "lines": [
                        {
                            "bbox": [
                                69,
                                270,
                                542,
                                283
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        270,
                                        542,
                                        283
                                    ],
                                    "type": "text",
                                    "content": "REFRAG trained under different compression rates. Figure 10 illustrates the training trajectory of REFRAG",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                68,
                                282,
                                542,
                                296
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        282,
                                        542,
                                        296
                                    ],
                                    "type": "text",
                                    "content": "under different compression rates in the continual pre-training task. We observe a performance regression as",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                69,
                                295,
                                542,
                                307
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        295,
                                        542,
                                        307
                                    ],
                                    "type": "text",
                                    "content": "the compression rate increases; however, even at a compression rate of 32, our model remains competitive",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                69,
                                306,
                                542,
                                319
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        306,
                                        542,
                                        319
                                    ],
                                    "type": "text",
                                    "content": "(as shown in table 1). In contrast, a compression rate of 64 appears to be overly aggressive, resulting in",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                68,
                                318,
                                543,
                                332
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        318,
                                        543,
                                        332
                                    ],
                                    "type": "text",
                                    "content": "diminished performance. These findings suggest a practical limit to the compression rate beyond which the",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                69,
                                331,
                                255,
                                343
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        331,
                                        255,
                                        343
                                    ],
                                    "type": "text",
                                    "content": "models capability is significantly reduced.",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                },
                {
                    "bbox": [
                        67,
                        348,
                        543,
                        529
                    ],
                    "type": "text",
                    "angle": 0,
                    "index": 9,
                    "lines": [
                        {
                            "bbox": [
                                70,
                                349,
                                542,
                                360
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        349,
                                        542,
                                        360
                                    ],
                                    "type": "text",
                                    "content": "Different combinations of encoder and decoder models for REFRAG. We employ LLaMA-2-7B and LLaMA-2-13B",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                360,
                                543,
                                373
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        360,
                                        543,
                                        373
                                    ],
                                    "type": "text",
                                    "content": "as decoders, and RoBERTa-Base and RoBERTa-Large as encoders, to investigate how model performance",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                69,
                                373,
                                542,
                                384
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        373,
                                        542,
                                        384
                                    ],
                                    "type": "text",
                                    "content": "varies with different encoder and decoder sizes. Figure 11 presents results for various encoder-decoder",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                69,
                                384,
                                542,
                                396
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        384,
                                        542,
                                        396
                                    ],
                                    "type": "text",
                                    "content": "combinations. We observe that increasing the number of parameters in the decoder leads to a substantial",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                395,
                                543,
                                411
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        395,
                                        543,
                                        411
                                    ],
                                    "type": "text",
                                    "content": "reduction in loss, whereas enlarging the encoder yields only a modest improvement. This discrepancy may",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                407,
                                543,
                                422
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        407,
                                        543,
                                        422
                                    ],
                                    "type": "text",
                                    "content": "be attributed to the relatively minor increase in size from RoBERTa-Base to RoBERTa-Large compared to",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                418,
                                543,
                                434
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        418,
                                        543,
                                        434
                                    ],
                                    "type": "text",
                                    "content": "the substantial jump from 7B to 13B in the decoder. Additional results in figure 12 indicate that a larger",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                66,
                                430,
                                544,
                                446
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        66,
                                        430,
                                        544,
                                        446
                                    ],
                                    "type": "text",
                                    "content": "encoder may not always be advantageous when training with limited data in the continual pre-training setting.",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                69,
                                444,
                                542,
                                456
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        444,
                                        542,
                                        456
                                    ],
                                    "type": "text",
                                    "content": "This observation aligns with previous findings by Li et al. (2024), which demonstrate that larger encoders in",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                68,
                                455,
                                543,
                                469
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        455,
                                        543,
                                        469
                                    ],
                                    "type": "text",
                                    "content": "multi-modal models can negatively impact performance when data is scarce. To further validate our training",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                468,
                                543,
                                480
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        468,
                                        543,
                                        480
                                    ],
                                    "type": "text",
                                    "content": "approach on other decoder models, we conduct experiments with LLaMA-3.1-8B and LLaMA-3.2-3B. Table 14",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                479,
                                543,
                                492
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        479,
                                        543,
                                        492
                                    ],
                                    "type": "text",
                                    "content": "reports the performance of these models paired with RoBERTa-Base and RoBERTa-Large encoders on the",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                490,
                                543,
                                506
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        490,
                                        543,
                                        506
                                    ],
                                    "type": "text",
                                    "content": "Arxiv domain. Models trained with our recipe achieve performance comparable to the Full Context setting",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                68,
                                504,
                                543,
                                517
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        504,
                                        543,
                                        517
                                    ],
                                    "type": "text",
                                    "content": "(i.e., without context compression). Moreover, increasing the context length continues to benefit our model,",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                516,
                                421,
                                529
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        516,
                                        421,
                                        529
                                    ],
                                    "type": "text",
                                    "content": "as evidenced by lower perplexity for a context length of 4096 compared to 2048.",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                },
                {
                    "bbox": [
                        67,
                        546,
                        293,
                        562
                    ],
                    "type": "title",
                    "angle": 0,
                    "index": 10,
                    "lines": [
                        {
                            "bbox": [
                                66,
                                544,
                                294,
                                563
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        66,
                                        544,
                                        294,
                                        563
                                    ],
                                    "type": "text",
                                    "content": "5 Contextual Learning Applications",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                },
                {
                    "bbox": [
                        67,
                        571,
                        543,
                        608
                    ],
                    "type": "text",
                    "angle": 0,
                    "index": 11,
                    "lines": [
                        {
                            "bbox": [
                                69,
                                572,
                                542,
                                584
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        572,
                                        542,
                                        584
                                    ],
                                    "type": "text",
                                    "content": "In this section, we investigate fine-tuning the model obtained from the pre-training stage to address various",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                69,
                                584,
                                542,
                                596
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        584,
                                        542,
                                        596
                                    ],
                                    "type": "text",
                                    "content": "downstream tasks, including RAG, long document summarization, and multi-turn conversation with RAG.",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                594,
                                474,
                                609
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        594,
                                        474,
                                        609
                                    ],
                                    "type": "text",
                                    "content": "For each application, we curate an instruction-tuning dataset to facilitate model fine-tuning.",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                },
                {
                    "bbox": [
                        67,
                        623,
                        261,
                        635
                    ],
                    "type": "title",
                    "angle": 0,
                    "index": 12,
                    "lines": [
                        {
                            "bbox": [
                                68,
                                621,
                                262,
                                638
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        621,
                                        262,
                                        638
                                    ],
                                    "type": "text",
                                    "content": "5.1 Retrieval Augmented Generation",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                },
                {
                    "bbox": [
                        67,
                        641,
                        544,
                        715
                    ],
                    "type": "text",
                    "angle": 0,
                    "index": 13,
                    "lines": [
                        {
                            "bbox": [
                                67,
                                640,
                                542,
                                655
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        640,
                                        542,
                                        655
                                    ],
                                    "type": "text",
                                    "content": "Training dataset. We follow the work of Lin et al. (2024) and use a combination of question answering datasets",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                68,
                                653,
                                542,
                                667
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        653,
                                        542,
                                        667
                                    ],
                                    "type": "text",
                                    "content": "from 5 domains to fine-tune our model, which contains 1.1 million data points. Dialogue: OpenAssistant",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                69,
                                665,
                                543,
                                680
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        665,
                                        543,
                                        680
                                    ],
                                    "type": "text",
                                    "content": "Conversations Dataset. Open-Domain QA: CommonsenseQA, MathQA, Web Questions, Wiki Question",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                676,
                                544,
                                693
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        676,
                                        544,
                                        693
                                    ],
                                    "type": "text",
                                    "content": "Answering, Yahoo! Answers QA, FreebaseQA, MS MARCO. Reading Comprehension: Discrete Reasoning",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                688,
                                544,
                                704
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        688,
                                        544,
                                        704
                                    ],
                                    "type": "text",
                                    "content": "Over Paragraphs, PubMedQA, QuaRel, SQuADv2. Chain-of-thought Reasoning: Algebra QA with Rationales,",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                68,
                                701,
                                430,
                                715
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        701,
                                        430,
                                        715
                                    ],
                                    "type": "text",
                                    "content": "Explanations for CommonsenseQ, Grade School Math 8K, MathQA, StrategyQA.",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                }
            ],
            "discarded_blocks": [
                {
                    "bbox": [
                        302,
                        742,
                        309,
                        751
                    ],
                    "type": "page_number",
                    "angle": 0,
                    "index": 14,
                    "lines": [
                        {
                            "bbox": [
                                301,
                                742,
                                310,
                                753
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        301,
                                        742,
                                        310,
                                        753
                                    ],
                                    "type": "text",
                                    "content": "7",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                }
            ],
            "page_size": [
                612,
                792
            ],
            "page_idx": 6
        },
        {
            "para_blocks": [
                {
                    "bbox": [
                        67,
                        64,
                        544,
                        184
                    ],
                    "type": "text",
                    "angle": 0,
                    "index": 0,
                    "lines": [
                        {
                            "bbox": [
                                68,
                                63,
                                544,
                                77
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        63,
                                        544,
                                        77
                                    ],
                                    "type": "text",
                                    "content": "Evaluation dataset. We hold out 5% of the data for each dataset in the training dataset for evaluation.",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                69,
                                76,
                                542,
                                88
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        76,
                                        542,
                                        88
                                    ],
                                    "type": "text",
                                    "content": "Additionally, we use the datasets that are commonly used in RAG literature (Izacard et al., 2023b; Lin",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                87,
                                543,
                                102
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        87,
                                        543,
                                        102
                                    ],
                                    "type": "text",
                                    "content": "et al., 2024), including MMLU (Hendrycks et al., 2021), BoolQ (Clark et al., 2019), SIQA (Sap et al., 2019),",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                68,
                                99,
                                542,
                                113
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        99,
                                        542,
                                        113
                                    ],
                                    "type": "text",
                                    "content": "PIQA (Bisk et al., 2020), and Knowledge Intensive Language Tasks (KILT) (Petroni et al., 2020) (including",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                110,
                                544,
                                125
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        110,
                                        544,
                                        125
                                    ],
                                    "type": "text",
                                    "content": "HellaSwag, Winogrande, TQA, FEVER, NQ). We evaluate our performance on 2 settings: 1) Strong Retriever:",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                122,
                                543,
                                137
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        122,
                                        543,
                                        137
                                    ],
                                    "type": "text",
                                    "content": "In this setting we use a strong retriever and retrieve the K-nearest neighbors to answer the question; 2) Weak",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                68,
                                136,
                                543,
                                149
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        136,
                                        543,
                                        149
                                    ],
                                    "type": "text",
                                    "content": "Retriever: In this setting we retrieve 200 passages and pick random K passages to answer the question. The",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                69,
                                148,
                                542,
                                160
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        148,
                                        542,
                                        160
                                    ],
                                    "type": "text",
                                    "content": "weak retriever setting closely resembles real-world systems, as RAG retrieval systems often suffer from error",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                159,
                                542,
                                173
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        159,
                                        542,
                                        173
                                    ],
                                    "type": "text",
                                    "content": "accumulation across subsystems. A table summarizing the evaluation metrics for each dataset is included in",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                68,
                                171,
                                105,
                                184
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        171,
                                        105,
                                        184
                                    ],
                                    "type": "text",
                                    "content": "table 7.",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                },
                {
                    "bbox": [
                        67,
                        190,
                        543,
                        239
                    ],
                    "type": "text",
                    "angle": 0,
                    "index": 1,
                    "lines": [
                        {
                            "bbox": [
                                67,
                                190,
                                542,
                                201
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        190,
                                        542,
                                        201
                                    ],
                                    "type": "text",
                                    "content": "Retriever and retrieval corpus. We follow the work of Lin et al. (2024) to use Wikipedia dumps and CommonCrawl",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                201,
                                543,
                                214
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        201,
                                        543,
                                        214
                                    ],
                                    "type": "text",
                                    "content": "dumps to create a retrieval corpus with 400 million passages. Each passage contains less than 200 words. We",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                213,
                                543,
                                225
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        213,
                                        543,
                                        225
                                    ],
                                    "type": "text",
                                    "content": "use the DRAGON+ model Lin et al. (2023) as our retriever and use the implementation of Izacard et al.",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                69,
                                225,
                                449,
                                237
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        225,
                                        449,
                                        237
                                    ],
                                    "type": "text",
                                    "content": "(2023a) to retrieve the K-nearest neighbors as the retrieved passages for each question.",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                },
                {
                    "bbox": [
                        67,
                        243,
                        544,
                        460
                    ],
                    "type": "text",
                    "angle": 0,
                    "index": 2,
                    "lines": [
                        {
                            "bbox": [
                                67,
                                241,
                                545,
                                258
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        241,
                                        545,
                                        258
                                    ],
                                    "type": "text",
                                    "content": "Result analysis. Table 3 shows the performance of different baselines under short and long contexts (i.e.,",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                255,
                                544,
                                269
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        255,
                                        544,
                                        269
                                    ],
                                    "type": "text",
                                    "content": "varying number of retrieved passages)3. (1/# tokens) is inverse for the number of tokens in the decoder model.",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                266,
                                544,
                                281
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        266,
                                        544,
                                        281
                                    ],
                                    "type": "text",
                                    "content": "This is used as a metric to gauge the latency of the model (the higher, the lower latency). LLaMAFT is",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                69,
                                280,
                                542,
                                292
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        280,
                                        542,
                                        292
                                    ],
                                    "type": "text",
                                    "content": "the original LLaMA-2-7B model that is fine-tuned on the same RAG dataset used to train our model. We",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                66,
                                291,
                                544,
                                305
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        66,
                                        291,
                                        544,
                                        305
                                    ],
                                    "type": "text",
                                    "content": "compare the performance under both the short context and the long context scenarios. For the short context,",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                303,
                                543,
                                316
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        303,
                                        543,
                                        316
                                    ],
                                    "type": "text",
                                    "content": "we use 1 passage for LLaMAFT and use 8 passages for all our models. The baseline of REFRAG8 will",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                315,
                                544,
                                328
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        315,
                                        544,
                                        328
                                    ],
                                    "type": "text",
                                    "content": "have the same latency as the LLaMAFT model. However, due to the compression, we are able to have more",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                69,
                                328,
                                542,
                                339
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        328,
                                        431,
                                        339
                                    ],
                                    "type": "text",
                                    "content": "context information and hence achieve better performance. Surprisingly, REFRAG",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        431,
                                        333,
                                        440,
                                        338
                                    ],
                                    "type": "inline_equation",
                                    "content": "^ { 1 6 }",
                                    "score": 0.78
                                },
                                {
                                    "bbox": [
                                        440,
                                        328,
                                        508,
                                        339
                                    ],
                                    "type": "text",
                                    "content": "and REFRAG",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        509,
                                        334,
                                        517,
                                        339
                                    ],
                                    "type": "inline_equation",
                                    "content": "^ { 3 2 }",
                                    "score": 0.82
                                },
                                {
                                    "bbox": [
                                        517,
                                        328,
                                        542,
                                        339
                                    ],
                                    "type": "text",
                                    "content": "both",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                338,
                                544,
                                353
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        338,
                                        290,
                                        353
                                    ],
                                    "type": "text",
                                    "content": "outperform the LLaMAFT model despite having 2",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        290,
                                        342,
                                        298,
                                        350
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\times",
                                    "score": 0.63
                                },
                                {
                                    "bbox": [
                                        298,
                                        338,
                                        325,
                                        353
                                    ],
                                    "type": "text",
                                    "content": "and 4",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        325,
                                        343,
                                        332,
                                        350
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\times",
                                    "score": 0.54
                                },
                                {
                                    "bbox": [
                                        333,
                                        338,
                                        544,
                                        353
                                    ],
                                    "type": "text",
                                    "content": "fewer tokens in the decoder (i.e., lower latency).",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                68,
                                350,
                                543,
                                364
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        350,
                                        543,
                                        364
                                    ],
                                    "type": "text",
                                    "content": "The same result occurs in long context scenarios. Our model has even higher performance gains in multi-choice",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                362,
                                543,
                                376
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        362,
                                        543,
                                        376
                                    ],
                                    "type": "text",
                                    "content": "tasks. Table 15 shows the performance of our model under different numbers of passages. The result suggests",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                69,
                                375,
                                541,
                                388
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        375,
                                        541,
                                        388
                                    ],
                                    "type": "text",
                                    "content": "that most tasks still benefit from more passages in our model. Figure 4 shows the performance averaged",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                387,
                                543,
                                399
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        387,
                                        543,
                                        399
                                    ],
                                    "type": "text",
                                    "content": "over all 16 tasks in table 3 for both strong retriever and weak retriever setting. The result demonstrates that",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                398,
                                543,
                                414
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        398,
                                        543,
                                        414
                                    ],
                                    "type": "text",
                                    "content": "under the same number of retrieved passages, we are able to match the performance of LLaMA in the strong",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                411,
                                542,
                                423
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        411,
                                        542,
                                        423
                                    ],
                                    "type": "text",
                                    "content": "retriever setting and even outperform LLaMA under the weak retriever setting. This is because our model",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                422,
                                543,
                                436
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        422,
                                        543,
                                        436
                                    ],
                                    "type": "text",
                                    "content": "enables larger context and hence enables extract more useful information when the retrieved passages are less",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                66,
                                432,
                                543,
                                450
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        66,
                                        432,
                                        543,
                                        450
                                    ],
                                    "type": "text",
                                    "content": "relevant. Under equivalent latency constraints, REFRAG consistently outperform LLaMA on both settings",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                66,
                                445,
                                530,
                                460
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        66,
                                        445,
                                        530,
                                        460
                                    ],
                                    "type": "text",
                                    "content": "as the saved context can be reinvested to include additional information within the same latency budget.",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                },
                {
                    "bbox": [
                        67,
                        464,
                        544,
                        550
                    ],
                    "type": "text",
                    "angle": 0,
                    "index": 3,
                    "lines": [
                        {
                            "bbox": [
                                68,
                                463,
                                542,
                                479
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        463,
                                        542,
                                        479
                                    ],
                                    "type": "text",
                                    "content": "Figure 4 compares the performance of REFRAG and the LLaMA model under two conditions: 1) an equal",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                66,
                                475,
                                544,
                                491
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        66,
                                        475,
                                        544,
                                        491
                                    ],
                                    "type": "text",
                                    "content": "number of retrieved passages, and 2) equal latency, for both strong and weak retriever settings. With a strong",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                488,
                                541,
                                502
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        488,
                                        533,
                                        502
                                    ],
                                    "type": "text",
                                    "content": "retriever and a maximum of 10 passages, REFRAG matches LLaMAs performance while achieving a 5.26",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        533,
                                        492,
                                        541,
                                        499
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\times",
                                    "score": 0.59
                                }
                            ]
                        },
                        {
                            "bbox": [
                                68,
                                499,
                                543,
                                514
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        499,
                                        543,
                                        514
                                    ],
                                    "type": "text",
                                    "content": "speedup in TTFT. At equal latency (8 passages for REFRAG vs. 1 for LLaMA), REFRAG attains a 1.22%",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                511,
                                544,
                                526
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        511,
                                        544,
                                        526
                                    ],
                                    "type": "text",
                                    "content": "average improvement across 16 RAG tasks. With a weak retriever setting, at 10 passages, REFRAG improves",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                68,
                                523,
                                544,
                                539
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        523,
                                        298,
                                        539
                                    ],
                                    "type": "text",
                                    "content": "performance by 0.71% and accelerates TTFT by 5.26",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        298,
                                        528,
                                        306,
                                        535
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\times",
                                    "score": 0.69
                                },
                                {
                                    "bbox": [
                                        306,
                                        523,
                                        544,
                                        539
                                    ],
                                    "type": "text",
                                    "content": "compared to LLaMA. At equal latency (8 passages for",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                68,
                                535,
                                478,
                                551
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        535,
                                        478,
                                        551
                                    ],
                                    "type": "text",
                                    "content": "REFRAG vs. 1 for LLaMA), REFRAG achieves a 1.93% average gain over 16 RAG tasks.",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                },
                {
                    "bbox": [
                        67,
                        563,
                        222,
                        575
                    ],
                    "type": "title",
                    "angle": 0,
                    "index": 4,
                    "lines": [
                        {
                            "bbox": [
                                68,
                                562,
                                221,
                                578
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        562,
                                        221,
                                        578
                                    ],
                                    "type": "text",
                                    "content": "5.2 Multi-Turn Conversation",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                },
                {
                    "bbox": [
                        67,
                        582,
                        543,
                        619
                    ],
                    "type": "text",
                    "angle": 0,
                    "index": 5,
                    "lines": [
                        {
                            "bbox": [
                                69,
                                582,
                                543,
                                595
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        582,
                                        543,
                                        595
                                    ],
                                    "type": "text",
                                    "content": "We use three different knowledge-intensive multi-turn conversation datasets: TopiOCQA (Adlakha et al.,",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                68,
                                594,
                                543,
                                608
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        594,
                                        543,
                                        608
                                    ],
                                    "type": "text",
                                    "content": "2022), ORConvQA (Qu et al., 2020), and QReCC (Anantha et al., 2021). For each conversation turn, we",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                605,
                                474,
                                619
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        605,
                                        105,
                                        619
                                    ],
                                    "type": "text",
                                    "content": "retrieve",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        106,
                                        609,
                                        115,
                                        616
                                    ],
                                    "type": "inline_equation",
                                    "content": "K",
                                    "score": 0.87
                                },
                                {
                                    "bbox": [
                                        116,
                                        605,
                                        474,
                                        619
                                    ],
                                    "type": "text",
                                    "content": "passages using the same retriever and retrieval corpus as described in section 5.1.",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                },
                {
                    "bbox": [
                        67,
                        624,
                        544,
                        696
                    ],
                    "type": "text",
                    "angle": 0,
                    "index": 6,
                    "lines": [
                        {
                            "bbox": [
                                67,
                                622,
                                545,
                                639
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        622,
                                        545,
                                        639
                                    ],
                                    "type": "text",
                                    "content": "Result analysis. Table 4 presents results across varying numbers of conversational turns and retrieved passages.",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                68,
                                635,
                                544,
                                650
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        635,
                                        544,
                                        650
                                    ],
                                    "type": "text",
                                    "content": "Our model outperforms LLaMAFT on two out of three datasets in the 5-passage setting, and on all three",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                647,
                                543,
                                662
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        647,
                                        543,
                                        662
                                    ],
                                    "type": "text",
                                    "content": "datasets in the 10-passage setting. This improvement is attributable to the limited 4k-token context window of",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                659,
                                543,
                                674
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        659,
                                        543,
                                        674
                                    ],
                                    "type": "text",
                                    "content": "LLaMAFT, which necessitates truncating portions of the conversational history in longer contexts, resulting",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                671,
                                543,
                                685
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        671,
                                        543,
                                        685
                                    ],
                                    "type": "text",
                                    "content": "in the loss of crucial information required to answer subsequent questions. In contrast, our model, trained on",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                68,
                                683,
                                543,
                                698
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        683,
                                        543,
                                        698
                                    ],
                                    "type": "text",
                                    "content": "the same LLaMA model without extending its effective positional encoding, maintains robust performance",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                }
            ],
            "discarded_blocks": [
                {
                    "bbox": [
                        67,
                        703,
                        543,
                        723
                    ],
                    "type": "page_footnote",
                    "angle": 0,
                    "index": 7,
                    "lines": [
                        {
                            "bbox": [
                                78,
                                700,
                                543,
                                716
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        78,
                                        700,
                                        543,
                                        716
                                    ],
                                    "type": "text",
                                    "content": "3Note that the implementation of our exact match is stricter than other works. We follow the work of Lin et al. (2024) to use",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                69,
                                712,
                                342,
                                723
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        712,
                                        342,
                                        723
                                    ],
                                    "type": "text",
                                    "content": "the stricter version and hence the reported numbers are lower in general.",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                },
                {
                    "bbox": [
                        302,
                        742,
                        309,
                        751
                    ],
                    "type": "page_number",
                    "angle": 0,
                    "index": 8,
                    "lines": [
                        {
                            "bbox": [
                                302,
                                742,
                                309,
                                752
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        302,
                                        742,
                                        309,
                                        752
                                    ],
                                    "type": "text",
                                    "content": "8",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                }
            ],
            "page_size": [
                612,
                792
            ],
            "page_idx": 7
        },
        {
            "para_blocks": [
                {
                    "type": "table",
                    "bbox": [
                        70,
                        92,
                        541,
                        320
                    ],
                    "blocks": [
                        {
                            "bbox": [
                                67,
                                62,
                                541,
                                85
                            ],
                            "lines": [
                                {
                                    "bbox": [
                                        69,
                                        61,
                                        541,
                                        75
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                69,
                                                61,
                                                541,
                                                75
                                            ],
                                            "type": "text",
                                            "content": "Table 3 Comparison of model performance of different models with different number of retrieved passages for RAG",
                                            "score": 1.0
                                        }
                                    ]
                                },
                                {
                                    "bbox": [
                                        68,
                                        72,
                                        214,
                                        87
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                68,
                                                72,
                                                214,
                                                87
                                            ],
                                            "type": "text",
                                            "content": "under the strong retriever scenario.",
                                            "score": 1.0
                                        }
                                    ]
                                }
                            ],
                            "index": 0,
                            "angle": 0,
                            "type": "table_caption"
                        },
                        {
                            "bbox": [
                                70,
                                92,
                                541,
                                320
                            ],
                            "lines": [
                                {
                                    "bbox": [
                                        70,
                                        92,
                                        541,
                                        320
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                70,
                                                92,
                                                541,
                                                320
                                            ],
                                            "type": "table",
                                            "html": "<table><tr><td>Generation</td><td>NQ</td><td>FEVER</td><td>TQA</td><td>WebQA</td><td>FreebaseQA</td><td>GSM8K</td><td>StrategyQA</td><td>BoolQ </td><td>(1/# tokens)</td></tr><tr><td colspan=\"10\">Short context with the same latency</td></tr><tr><td>\\( LLAMA_{FT} + 1 \\) passage</td><td>23.96</td><td>62.04</td><td>9.64</td><td>37.33</td><td>75.18</td><td>7.38</td><td>64.44</td><td>29.24</td><td>1</td></tr><tr><td>\\( REFRAG_{8} + 8 \\) passages</td><td>22.96</td><td>66.59</td><td>13.05</td><td>38.67</td><td>73.46</td><td>7.38</td><td>75.56</td><td>3.30</td><td>1</td></tr><tr><td>\\( REFRAG_{16} + 8 \\) passages</td><td>22.94</td><td>62.88</td><td>12.97</td><td>42.67</td><td>71.50</td><td>9.40</td><td>71.11</td><td>5.87</td><td>2</td></tr><tr><td>\\( REFRAG_{32} + 8 \\) passages</td><td>22.11</td><td>64.24</td><td>12.57</td><td>41.33</td><td>71.74</td><td>12.75</td><td>73.33</td><td>1.99</td><td>4</td></tr><tr><td colspan=\"10\">Long context</td></tr><tr><td>\\( LLAMA_{FT} + 10 \\) passages</td><td>26.08</td><td>65.44</td><td>9.68</td><td>40.00</td><td>76.17</td><td>6.71</td><td>68.89</td><td>30.00</td><td>1</td></tr><tr><td>CEPED +80 passages</td><td>0.03</td><td>65.68</td><td>0.01</td><td>0.00</td><td>0.00</td><td>0.00</td><td>0.00</td><td>57.80</td><td></td></tr><tr><td>REPLUG +80 passages</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>64.44</td><td>-</td><td></td></tr><tr><td>\\( LLAMA-32K +80 \\) passages</td><td>1.24</td><td>0.14</td><td>0.52</td><td>10.67</td><td>9.83</td><td>0.00</td><td>0.00</td><td>0.03</td><td></td></tr><tr><td>\\( REFRAG_{8} +80 \\) passages</td><td>24.15</td><td>68.83</td><td>13.06</td><td>37.33</td><td>74.20</td><td>7.38</td><td>71.11</td><td>7.03</td><td>1</td></tr><tr><td>\\( REFRAG_{16} +80 \\) passages</td><td>23.30</td><td>66.01</td><td>12.65</td><td>38.67</td><td>75.43</td><td>12.08</td><td>73.33</td><td>12.23</td><td>2</td></tr><tr><td>\\( REFRAG_{32} +80 \\) passages</td><td>23.02</td><td>68.48</td><td>12.14</td><td>38.67</td><td>71.74</td><td>9.40</td><td>68.89</td><td>6.42</td><td>4</td></tr><tr><td>Multi-Choice</td><td>MMLU</td><td>CommonsenseQA</td><td>MathQA</td><td>ECQA</td><td>HellaSwag</td><td>SIQA</td><td>PIQA</td><td>Winogrande </td><td></td></tr><tr><td colspan=\"10\">Short context with the same latency</td></tr><tr><td>\\( LLAMA_{FT} + 1 \\) context</td><td>50.23</td><td>85.05</td><td>99.50</td><td>84.77</td><td>41.80</td><td>68.12</td><td>67.36</td><td>55.64</td><td>1</td></tr><tr><td>\\( REFRAG_{8} + 8 \\) passages</td><td>50.29</td><td>92.27</td><td>99.66</td><td>94.70</td><td>45.23</td><td>68.94</td><td>71.38</td><td>57.70</td><td>1</td></tr><tr><td>\\( REFRAG_{16} + 8 \\) passages</td><td>49.84</td><td>89.18</td><td>99.66</td><td>98.01</td><td>39.33</td><td>68.42</td><td>70.29</td><td>56.67</td><td>2</td></tr><tr><td>\\( REFRAG_{32} + 8 \\) passages</td><td>49.51</td><td>91.75</td><td>99.50</td><td>97.35</td><td>42.86</td><td>68.17</td><td>68.34</td><td>56.75</td><td>4</td></tr><tr><td colspan=\"10\">Long context</td></tr><tr><td>\\( LLAMA_{FT} + 10 \\) passages</td><td>48.66</td><td>82.99</td><td>68.46</td><td>84.11</td><td>41.77</td><td>67.45</td><td>68.01</td><td>53.91</td><td>1</td></tr><tr><td>CEPED +80 passages</td><td>26.26</td><td>26.29</td><td>23.66</td><td>24.50</td><td>24.95</td><td>32.86</td><td>48.53</td><td>44.51</td><td></td></tr><tr><td>REPLUG +80 passages</td><td>-</td><td>78.35</td><td>-</td><td>76.16</td><td>-</td><td>65.51</td><td>-</td><td>-</td><td></td></tr><tr><td>\\( LLAMA-32K +80 \\) passages</td><td>22.21</td><td>16.49</td><td>19.80</td><td>16.56</td><td>23.76</td><td>24.16</td><td>34.17</td><td>48.86</td><td></td></tr><tr><td>\\( REFRAG_{8} +80 \\) passages</td><td>50.42</td><td>92.27</td><td>99.66</td><td>97.35</td><td>44.61</td><td>68.22</td><td>69.37</td><td>57.54</td><td>1</td></tr><tr><td>\\( REFRAG_{16} +80 \\) passages</td><td>50.88</td><td>89.69</td><td>99.66</td><td>96.69</td><td>38.50</td><td>68.47</td><td>70.89</td><td>56.99</td><td>2</td></tr><tr><td>\\( REFRAG_{32} +80 \\) passages</td><td>49.77</td><td>90.72</td><td>99.50</td><td>98.01</td><td>43.37</td><td>68.47</td><td>69.04</td><td>56.99</td><td>4</td></tr></table>",
                                            "image_path": "300b99a8528e98a1b98d6493c929e3e254c122ce013292eeeb757c5d032a9221.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 1,
                            "angle": 0,
                            "type": "table_body"
                        },
                        {
                            "bbox": [
                                74,
                                319,
                                249,
                                327
                            ],
                            "lines": [
                                {
                                    "bbox": [
                                        75,
                                        319,
                                        250,
                                        328
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                75,
                                                319,
                                                250,
                                                328
                                            ],
                                            "type": "text",
                                            "content": "- means the corresponding model has out-of-memory error.",
                                            "score": 1.0
                                        }
                                    ]
                                }
                            ],
                            "index": 2,
                            "angle": 0,
                            "type": "table_footnote"
                        }
                    ],
                    "index": 1
                },
                {
                    "bbox": [
                        67,
                        346,
                        541,
                        383
                    ],
                    "type": "text",
                    "angle": 0,
                    "index": 3,
                    "lines": [
                        {
                            "bbox": [
                                68,
                                346,
                                542,
                                360
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        346,
                                        542,
                                        360
                                    ],
                                    "type": "text",
                                    "content": "even with a large number of passages, owing to the benefits of our compression approach. Table 5 further",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                69,
                                359,
                                541,
                                371
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        359,
                                        541,
                                        371
                                    ],
                                    "type": "text",
                                    "content": "reports the performance of different models under varying numbers of passages, with our model consistently",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                69,
                                371,
                                445,
                                384
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        371,
                                        445,
                                        384
                                    ],
                                    "type": "text",
                                    "content": "achieving superior results on two out of three datasets for the reasons outlined above.",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "table",
                    "bbox": [
                        70,
                        411,
                        302,
                        536
                    ],
                    "blocks": [
                        {
                            "bbox": [
                                67,
                                392,
                                430,
                                403
                            ],
                            "lines": [
                                {
                                    "bbox": [
                                        68,
                                        391,
                                        431,
                                        404
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                68,
                                                391,
                                                431,
                                                404
                                            ],
                                            "type": "text",
                                            "content": "Table 4 Performance on multi-turn RAG tasks for # Passages = 5 and # Passages = 10.",
                                            "score": 1.0
                                        }
                                    ]
                                }
                            ],
                            "index": 4,
                            "angle": 0,
                            "type": "table_caption"
                        },
                        {
                            "bbox": [
                                70,
                                411,
                                302,
                                536
                            ],
                            "lines": [
                                {
                                    "bbox": [
                                        70,
                                        411,
                                        302,
                                        536
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                70,
                                                411,
                                                302,
                                                536
                                            ],
                                            "type": "table",
                                            "html": "<table><tr><td></td><td># Turns ()</td><td>ORConvQA</td><td>QReCC</td><td>TopiOCQA </td></tr><tr><td></td><td colspan=\"4\"># Passages = 5</td></tr><tr><td>\\( LLAMA_{FT} \\)</td><td>2</td><td>20.73</td><td>18.72</td><td>26.98</td></tr><tr><td>\\( REFRAG_{8} \\)</td><td>2</td><td>21.17</td><td>17.73</td><td>28.04</td></tr><tr><td>\\( REFRAG_{16} \\)</td><td>2</td><td>20.19</td><td>17.30</td><td>27.89</td></tr><tr><td>\\( REFRAG_{32} \\)</td><td>2</td><td>19.70</td><td>17.35</td><td>28.67</td></tr><tr><td>\\( LLAMA_{FT} \\)</td><td>4</td><td>20.33</td><td>16.42</td><td>23.50</td></tr><tr><td>\\( REFRAG_{8} \\)</td><td>4</td><td>22.78</td><td>15.61</td><td>26.93</td></tr><tr><td>\\( REFRAG_{16} \\)</td><td>4</td><td>21.94</td><td>15.27</td><td>27.03</td></tr><tr><td>\\( REFRAG_{32} \\)</td><td>4</td><td>21.68</td><td>15.45</td><td>26.45</td></tr><tr><td>\\( LLAMA_{FT} \\)</td><td>6</td><td>20.76</td><td>11.92</td><td>23.10</td></tr><tr><td>\\( REFRAG_{8} \\)</td><td>6</td><td>23.11</td><td>10.88</td><td>25.37</td></tr><tr><td>\\( REFRAG_{16} \\)</td><td>6</td><td>21.69</td><td>10.75</td><td>26.17</td></tr><tr><td>\\( REFRAG_{32} \\)</td><td>6</td><td>21.19</td><td>10.69</td><td>25.51</td></tr></table>",
                                            "image_path": "b2853c8d93458f21afe49843980bc511868409703ae23a014b2910820c44d1c5.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 5,
                            "angle": 0,
                            "type": "table_body"
                        }
                    ],
                    "index": 5
                },
                {
                    "type": "table",
                    "bbox": [
                        310,
                        411,
                        542,
                        535
                    ],
                    "blocks": [
                        {
                            "bbox": [
                                310,
                                411,
                                542,
                                535
                            ],
                            "lines": [
                                {
                                    "bbox": [
                                        310,
                                        411,
                                        542,
                                        535
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                310,
                                                411,
                                                542,
                                                535
                                            ],
                                            "type": "table",
                                            "html": "<table><tr><td></td><td># Turns ()</td><td>ORConvQA</td><td>QReCC</td><td>TopiOCQA </td></tr><tr><td></td><td colspan=\"4\"># Passages = 10</td></tr><tr><td>\\( LLAMA_{FT} \\)</td><td>2</td><td>16.52</td><td>17.31</td><td>23.02</td></tr><tr><td>\\( REFRAG_{8} \\)</td><td>2</td><td>21.15</td><td>17.92</td><td>27.97</td></tr><tr><td>\\( REFRAG_{16} \\)</td><td>2</td><td>20.79</td><td>17.37</td><td>28.45</td></tr><tr><td>\\( REFRAG_{32} \\)</td><td>2</td><td>19.67</td><td>17.16</td><td>28.31</td></tr><tr><td>\\( LLAMA_{FT} \\)</td><td>4</td><td>16.90</td><td>14.69</td><td>20.23</td></tr><tr><td>\\( REFRAG_{8} \\)</td><td>4</td><td>22.63</td><td>15.68</td><td>25.95</td></tr><tr><td>\\( REFRAG_{16} \\)</td><td>4</td><td>21.84</td><td>15.21</td><td>26.12</td></tr><tr><td>\\( REFRAG_{32} \\)</td><td>4</td><td>21.75</td><td>15.33</td><td>25.77</td></tr><tr><td>\\( LLAMA_{FT} \\)</td><td>6</td><td>14.44</td><td>10.72</td><td>19.52</td></tr><tr><td>\\( REFRAG_{8} \\)</td><td>6</td><td>20.59</td><td>11.00</td><td>25.16</td></tr><tr><td>\\( REFRAG_{16} \\)</td><td>6</td><td>21.05</td><td>10.50</td><td>24.96</td></tr><tr><td>\\( REFRAG_{32} \\)</td><td>6</td><td>21.67</td><td>10.79</td><td>25.23</td></tr></table>",
                                            "image_path": "7d8b12cbd985facd1b3470b4a91410f4cc51f1040ee9322e5f48b13e01a0ae18.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 6,
                            "angle": 0,
                            "type": "table_body"
                        }
                    ],
                    "index": 6
                },
                {
                    "type": "table",
                    "bbox": [
                        141,
                        568,
                        472,
                        628
                    ],
                    "blocks": [
                        {
                            "bbox": [
                                67,
                                548,
                                398,
                                560
                            ],
                            "lines": [
                                {
                                    "bbox": [
                                        67,
                                        547,
                                        399,
                                        562
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                67,
                                                547,
                                                399,
                                                562
                                            ],
                                            "type": "text",
                                            "content": "Table 5 Performance on multi-turn RAG tasks with different number of passages.",
                                            "score": 1.0
                                        }
                                    ]
                                }
                            ],
                            "index": 7,
                            "angle": 0,
                            "type": "table_caption"
                        },
                        {
                            "bbox": [
                                141,
                                568,
                                472,
                                628
                            ],
                            "lines": [
                                {
                                    "bbox": [
                                        141,
                                        568,
                                        472,
                                        628
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                141,
                                                568,
                                                472,
                                                628
                                            ],
                                            "type": "table",
                                            "html": "<table><tr><td colspan=\"4\">REFRAG</td><td colspan=\"3\">LLAMAFT</td></tr><tr><td># Passages</td><td>ORConvQA</td><td>QReCC</td><td>TopiOCQA </td><td>ORConvQA</td><td>QReCC</td><td>TopiOCQA </td></tr><tr><td>0</td><td>19.27</td><td>15.32</td><td>28.19</td><td>19.16</td><td>15.49</td><td>28.22</td></tr><tr><td>5</td><td>20.18</td><td>17.37</td><td>28.24</td><td>19.65</td><td>18.71</td><td>27.08</td></tr><tr><td>8</td><td>20.52</td><td>17.60</td><td>28.17</td><td>16.87</td><td>18.05</td><td>25.36</td></tr><tr><td>10</td><td>19.67</td><td>17.41</td><td>27.62</td><td>15.72</td><td>17.42</td><td>23.60</td></tr></table>",
                                            "image_path": "04f31501fb6a6b74a0bda78a9616fd9ec1fdcd157631ba54b519c095408b77cb.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 8,
                            "angle": 0,
                            "type": "table_body"
                        }
                    ],
                    "index": 8
                },
                {
                    "bbox": [
                        67,
                        650,
                        180,
                        664
                    ],
                    "type": "title",
                    "angle": 0,
                    "index": 9,
                    "lines": [
                        {
                            "bbox": [
                                68,
                                648,
                                180,
                                666
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        648,
                                        180,
                                        666
                                    ],
                                    "type": "text",
                                    "content": "6 Related Works",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                },
                {
                    "bbox": [
                        67,
                        675,
                        542,
                        724
                    ],
                    "type": "text",
                    "angle": 0,
                    "index": 10,
                    "lines": [
                        {
                            "bbox": [
                                69,
                                676,
                                543,
                                689
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        676,
                                        543,
                                        689
                                    ],
                                    "type": "text",
                                    "content": "Retrieval-Augmented Language Modeling. Recent research has extensively investigated novel model archi-",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                68,
                                688,
                                543,
                                700
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        688,
                                        543,
                                        700
                                    ],
                                    "type": "text",
                                    "content": "tectures to improve retrieval-augmented generation. Guu et al. (2020) introduced pre-training for retrieval-",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                699,
                                543,
                                713
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        699,
                                        543,
                                        713
                                    ],
                                    "type": "text",
                                    "content": "augmented masked language models. Building on this, Borgeaud et al. (2022) proposed a new architecture",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                69,
                                712,
                                542,
                                724
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        712,
                                        542,
                                        724
                                    ],
                                    "type": "text",
                                    "content": "and pre-training paradigm for generative LLMs, leveraging cross-attention and end-to-end pre-training with",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                }
            ],
            "discarded_blocks": [
                {
                    "bbox": [
                        302,
                        742,
                        309,
                        751
                    ],
                    "type": "page_number",
                    "angle": 0,
                    "index": 11,
                    "lines": [
                        {
                            "bbox": [
                                302,
                                742,
                                309,
                                753
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        302,
                                        742,
                                        309,
                                        753
                                    ],
                                    "type": "text",
                                    "content": "9",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                }
            ],
            "page_size": [
                612,
                792
            ],
            "page_idx": 8
        },
        {
            "para_blocks": [
                {
                    "bbox": [
                        67,
                        64,
                        543,
                        138
                    ],
                    "type": "text",
                    "angle": 0,
                    "index": 0,
                    "lines": [
                        {
                            "bbox": [
                                67,
                                62,
                                542,
                                78
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        62,
                                        542,
                                        78
                                    ],
                                    "type": "text",
                                    "content": "retrieval from a trillion-token data store, achieving strong performance. Subsequent work by Shi et al. (2024)",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                76,
                                542,
                                90
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        76,
                                        542,
                                        90
                                    ],
                                    "type": "text",
                                    "content": "and Lin et al. (2024) focused on fine-tuning existing LLMs by prepending retrieved passages to prompts and",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                68,
                                88,
                                542,
                                101
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        88,
                                        542,
                                        101
                                    ],
                                    "type": "text",
                                    "content": "employing ensemble methods for response generation. Additionally, Izacard and Grave (2021) introduced",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                99,
                                543,
                                114
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        99,
                                        543,
                                        114
                                    ],
                                    "type": "text",
                                    "content": "fusion-in-decoder, which uses an encoder to process each passage in parallel and concatenates the hidden states",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                69,
                                112,
                                542,
                                125
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        112,
                                        542,
                                        125
                                    ],
                                    "type": "text",
                                    "content": "for generation via a decoder. This approach accelerates attention computation by removing cross-document",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                121,
                                481,
                                139
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        121,
                                        481,
                                        139
                                    ],
                                    "type": "text",
                                    "content": "attention, but does not apply compression in the decoder, which could further reduce latency.",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                },
                {
                    "bbox": [
                        69,
                        149,
                        544,
                        366
                    ],
                    "type": "text",
                    "angle": 0,
                    "index": 1,
                    "lines": [
                        {
                            "bbox": [
                                69,
                                148,
                                543,
                                165
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        148,
                                        543,
                                        165
                                    ],
                                    "type": "text",
                                    "content": "Efficient Long-Context LLMs. Recent research has investigated various strategies to reduce memory usage",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                68,
                                162,
                                542,
                                175
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        162,
                                        542,
                                        175
                                    ],
                                    "type": "text",
                                    "content": "and accelerate latency in long-context generation for LLMs. Choromanski et al. (2021) introduced compressed",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                173,
                                542,
                                186
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        173,
                                        542,
                                        186
                                    ],
                                    "type": "text",
                                    "content": "attention, reducing attention complexity from quadratic to linear; however, this method does not address",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                185,
                                544,
                                200
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        185,
                                        544,
                                        200
                                    ],
                                    "type": "text",
                                    "content": "memory requirements. It is complementary to our approach and can be integrated to further improve latency.",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                68,
                                198,
                                542,
                                211
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        198,
                                        542,
                                        211
                                    ],
                                    "type": "text",
                                    "content": "StreamingLLM(Xiao et al., 2024) proposed attention sinks to decrease KV cache memory for long-context",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                66,
                                209,
                                544,
                                224
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        66,
                                        209,
                                        544,
                                        224
                                    ],
                                    "type": "text",
                                    "content": "generation, though this does not reduce latency during the pre-filling stage. CEPE (Yen et al., 2024) employs",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                66,
                                221,
                                544,
                                236
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        66,
                                        221,
                                        544,
                                        236
                                    ],
                                    "type": "text",
                                    "content": "cross-attention to token embeddings from context tokens, reducing both KV cache memory and attention",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                234,
                                543,
                                247
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        234,
                                        543,
                                        247
                                    ],
                                    "type": "text",
                                    "content": "computations. However, CEPE is limited to prefix context applications, as it disrupts the causal structure of",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                69,
                                246,
                                541,
                                258
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        246,
                                        541,
                                        258
                                    ],
                                    "type": "text",
                                    "content": "the context, making it unsuitable for tasks such as multi-turn RAG or summarization. Additionally, CEPE",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                68,
                                258,
                                542,
                                270
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        258,
                                        542,
                                        270
                                    ],
                                    "type": "text",
                                    "content": "does not utilize token compression, resulting in similar or even increased decoding latency. Concurrently with",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                269,
                                542,
                                282
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        269,
                                        542,
                                        282
                                    ],
                                    "type": "text",
                                    "content": "our work, Dai et al. (2025) proposed PCC, an embedding-based memory mechanism that summarizes past",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                68,
                                281,
                                543,
                                294
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        281,
                                        543,
                                        294
                                    ],
                                    "type": "text",
                                    "content": "context into compact vectors, enabling retrieval of salient information during subsequent processing. Like",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                69,
                                293,
                                543,
                                307
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        293,
                                        543,
                                        307
                                    ],
                                    "type": "text",
                                    "content": "CEPE, PCC is limited to prefix context applications and does not support arbitrary folding or expansion of",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                305,
                                543,
                                318
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        305,
                                        543,
                                        318
                                    ],
                                    "type": "text",
                                    "content": "contexts at any position. Interestingly, Kuratov et al. (2025) investigated the capacity of LLMs to encode",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                68,
                                317,
                                543,
                                331
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        317,
                                        543,
                                        331
                                    ],
                                    "type": "text",
                                    "content": "long contexts into a single embedding, demonstrating minimal information loss for sequences up to 1500",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                327,
                                544,
                                344
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        327,
                                        544,
                                        344
                                    ],
                                    "type": "text",
                                    "content": "tokens. Their work examines the extent to which information can be compressed into a single embedding,",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                69,
                                341,
                                542,
                                354
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        341,
                                        542,
                                        354
                                    ],
                                    "type": "text",
                                    "content": "offering a complementary perspective to REFRAG, which is designed for decoding from multiple compact",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                69,
                                353,
                                307,
                                366
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        353,
                                        307,
                                        366
                                    ],
                                    "type": "text",
                                    "content": "embeddings within the standard decoder architecture.",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                },
                {
                    "bbox": [
                        67,
                        379,
                        544,
                        548
                    ],
                    "type": "text",
                    "angle": 0,
                    "index": 2,
                    "lines": [
                        {
                            "bbox": [
                                70,
                                378,
                                542,
                                392
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        379,
                                        186,
                                        392
                                    ],
                                    "type": "text",
                                    "content": "Compressive transformer.",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        187,
                                        378,
                                        542,
                                        392
                                    ],
                                    "type": "text",
                                    "content": "Rae et al. (2020) first introduced the compressive transformer, which compresses",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                69,
                                392,
                                542,
                                404
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        392,
                                        542,
                                        404
                                    ],
                                    "type": "text",
                                    "content": "the KV cache to reduce memory requirements for long-context applications. However, this approach only",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                69,
                                403,
                                542,
                                416
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        403,
                                        542,
                                        416
                                    ],
                                    "type": "text",
                                    "content": "decreases KV cache memory usage, does not improve time-to-first-token latency, and requires training the",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                414,
                                544,
                                429
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        414,
                                        544,
                                        429
                                    ],
                                    "type": "text",
                                    "content": "model from scratch. Yoshida et al. (2021) extended this idea by employing recursive context compression,",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                426,
                                544,
                                441
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        426,
                                        544,
                                        441
                                    ],
                                    "type": "text",
                                    "content": "generating a summary hidden state for each chunk to inform the next chunks computation. The recursive",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                439,
                                542,
                                452
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        439,
                                        542,
                                        452
                                    ],
                                    "type": "text",
                                    "content": "nature, however, prevents pre-computation and reuse of chunk embeddings, and does not reduce decoding",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                66,
                                449,
                                543,
                                465
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        66,
                                        449,
                                        543,
                                        465
                                    ],
                                    "type": "text",
                                    "content": "latency. Chevalier et al. (2023) proposed recursive compression for documents, using compressed embeddings",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                68,
                                462,
                                543,
                                477
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        462,
                                        543,
                                        477
                                    ],
                                    "type": "text",
                                    "content": "for prediction, similar to our method. However, their sequential compression process results in high latency",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                474,
                                543,
                                488
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        474,
                                        543,
                                        488
                                    ],
                                    "type": "text",
                                    "content": "when the summary vector is not cached, and their approach only supports applications where the summary",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                68,
                                487,
                                542,
                                500
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        487,
                                        542,
                                        500
                                    ],
                                    "type": "text",
                                    "content": "token is restricted to the prefix of the language model (e.g., RAG), limiting applicability. In contrast, our",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                68,
                                498,
                                542,
                                511
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        498,
                                        542,
                                        511
                                    ],
                                    "type": "text",
                                    "content": "work is the first to enable pre-computation of chunk embeddings and their use at arbitrary positions within",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                510,
                                544,
                                525
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        510,
                                        544,
                                        525
                                    ],
                                    "type": "text",
                                    "content": "the prompt, supporting diverse applications such as RAG and multi-turn conversation. Furthermore, our",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                521,
                                544,
                                536
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        521,
                                        544,
                                        536
                                    ],
                                    "type": "text",
                                    "content": "method learns where to apply compression, allowing for adaptive compression rates at inference time without",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                66,
                                533,
                                212,
                                549
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        66,
                                        533,
                                        212,
                                        549
                                    ],
                                    "type": "text",
                                    "content": "recomputing chunk embeddings.",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                },
                {
                    "bbox": [
                        67,
                        560,
                        543,
                        669
                    ],
                    "type": "text",
                    "angle": 0,
                    "index": 3,
                    "lines": [
                        {
                            "bbox": [
                                69,
                                559,
                                543,
                                574
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        559,
                                        543,
                                        574
                                    ],
                                    "type": "text",
                                    "content": "Prompt compression. Prompt compression seeks to reduce input token length to lower latency and cost",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                69,
                                573,
                                542,
                                585
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        573,
                                        542,
                                        585
                                    ],
                                    "type": "text",
                                    "content": "while maintaining task performance. A prominent approach is LLMLingua(Jiang et al., 2023),which employs",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                68,
                                584,
                                542,
                                597
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        584,
                                        542,
                                        597
                                    ],
                                    "type": "text",
                                    "content": "coarse-to-fine, budget-controlled compression with token-level iterative refinement, achieving high compression",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                69,
                                597,
                                542,
                                609
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        597,
                                        542,
                                        609
                                    ],
                                    "type": "text",
                                    "content": "ratios with minimal performance loss. LongLLMLingua (Jiang et al., 2024) extends this method to long-context",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                68,
                                609,
                                542,
                                621
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        609,
                                        542,
                                        621
                                    ],
                                    "type": "text",
                                    "content": "scenarios, demonstrating significant cost and end-to-end speed improvements. Complementary approaches",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                620,
                                542,
                                633
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        620,
                                        542,
                                        633
                                    ],
                                    "type": "text",
                                    "content": "rank or prune context by estimated informativeness, e.g., Selective Context uses self-information to drop",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                68,
                                631,
                                542,
                                645
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        631,
                                        542,
                                        645
                                    ],
                                    "type": "text",
                                    "content": "low-value tokens, and sentence-level methods learn context-aware encoders for question-specific compression",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                643,
                                543,
                                657
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        643,
                                        543,
                                        657
                                    ],
                                    "type": "text",
                                    "content": "and faster inference Li et al. (2023); Liskavets et al. (2024). These approaches are complementary to our work",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                68,
                                656,
                                361,
                                669
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        656,
                                        361,
                                        669
                                    ],
                                    "type": "text",
                                    "content": "and can be integrated to further reduce the latency of REFRAG.",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                }
            ],
            "discarded_blocks": [
                {
                    "bbox": [
                        300,
                        742,
                        312,
                        752
                    ],
                    "type": "page_number",
                    "angle": 0,
                    "index": 4,
                    "lines": [
                        {
                            "bbox": [
                                299,
                                742,
                                313,
                                755
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        299,
                                        742,
                                        313,
                                        755
                                    ],
                                    "type": "text",
                                    "content": "10",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                }
            ],
            "page_size": [
                612,
                792
            ],
            "page_idx": 9
        },
        {
            "para_blocks": [
                {
                    "bbox": [
                        69,
                        64,
                        157,
                        77
                    ],
                    "type": "title",
                    "angle": 0,
                    "index": 0,
                    "lines": [
                        {
                            "bbox": [
                                67,
                                61,
                                159,
                                83
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        61,
                                        159,
                                        83
                                    ],
                                    "type": "text",
                                    "content": "7 Conclusion",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                },
                {
                    "bbox": [
                        69,
                        89,
                        541,
                        209
                    ],
                    "type": "text",
                    "angle": 0,
                    "index": 1,
                    "lines": [
                        {
                            "bbox": [
                                67,
                                88,
                                543,
                                103
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        88,
                                        543,
                                        103
                                    ],
                                    "type": "text",
                                    "content": "In this work, we introduced REFRAG, a novel and efficient decoding framework tailored for RAG applications.",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                69,
                                102,
                                541,
                                115
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        102,
                                        541,
                                        115
                                    ],
                                    "type": "text",
                                    "content": "By leveraging the inherent sparsity and block-diagonal attention patterns present in RAG contexts, REFRAG",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                69,
                                114,
                                542,
                                127
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        114,
                                        542,
                                        127
                                    ],
                                    "type": "text",
                                    "content": "compresses, senses, and expands context representations to significantly reduce both memory usage and",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                68,
                                126,
                                543,
                                139
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        126,
                                        543,
                                        139
                                    ],
                                    "type": "text",
                                    "content": "inference latency, particularly the TTFT. Extensive experiments across a range of long-context applications,",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                68,
                                137,
                                542,
                                151
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        137,
                                        542,
                                        151
                                    ],
                                    "type": "text",
                                    "content": "including RAG, multi-turn conversations, and long document summarization, demonstrate that REFRAG",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                69,
                                149,
                                542,
                                163
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        149,
                                        157,
                                        163
                                    ],
                                    "type": "text",
                                    "content": "achieves up to 30.85",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        157,
                                        153,
                                        165,
                                        160
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\times",
                                    "score": 0.64
                                },
                                {
                                    "bbox": [
                                        165,
                                        149,
                                        275,
                                        163
                                    ],
                                    "type": "text",
                                    "content": "TTFT acceleration (3.75",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        276,
                                        153,
                                        282,
                                        160
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\times",
                                    "score": 0.62
                                },
                                {
                                    "bbox": [
                                        283,
                                        149,
                                        542,
                                        163
                                    ],
                                    "type": "text",
                                    "content": "over previous state-of-the-art methods) without any loss in",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                68,
                                161,
                                542,
                                175
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        161,
                                        542,
                                        175
                                    ],
                                    "type": "text",
                                    "content": "perplexity or downstream accuracy. Our results highlight the importance of specialized treatment for RAG-",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                68,
                                174,
                                541,
                                186
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        174,
                                        541,
                                        186
                                    ],
                                    "type": "text",
                                    "content": "based systems and open new directions for efficient large-context LLM inference. We believe that REFRAG",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                185,
                                542,
                                199
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        185,
                                        542,
                                        199
                                    ],
                                    "type": "text",
                                    "content": "provides a practical and scalable solution for deploying LLMs in latency-sensitive, knowledge-intensive",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                68,
                                198,
                                127,
                                209
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        198,
                                        127,
                                        209
                                    ],
                                    "type": "text",
                                    "content": "applications.",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                },
                {
                    "bbox": [
                        69,
                        228,
                        210,
                        243
                    ],
                    "type": "title",
                    "angle": 0,
                    "index": 2,
                    "lines": [
                        {
                            "bbox": [
                                67,
                                225,
                                212,
                                246
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        225,
                                        212,
                                        246
                                    ],
                                    "type": "text",
                                    "content": "8 Acknowledgements",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                },
                {
                    "bbox": [
                        69,
                        253,
                        541,
                        277
                    ],
                    "type": "text",
                    "angle": 0,
                    "index": 3,
                    "lines": [
                        {
                            "bbox": [
                                69,
                                253,
                                541,
                                266
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        253,
                                        541,
                                        266
                                    ],
                                    "type": "text",
                                    "content": "We thank for Jason Chen, Yao Liu, Norman Huang, Xueyuan Su, Pranesh Srinivasan, Avinash Atreya, Riham",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                68,
                                265,
                                349,
                                278
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        265,
                                        349,
                                        278
                                    ],
                                    "type": "text",
                                    "content": "Mansour, Jeremy Teboul for insightful discussions and support.",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                }
            ],
            "discarded_blocks": [
                {
                    "bbox": [
                        301,
                        742,
                        310,
                        751
                    ],
                    "type": "page_number",
                    "angle": 0,
                    "index": 4,
                    "lines": []
                }
            ],
            "page_size": [
                612,
                792
            ],
            "page_idx": 10
        },
        {
            "para_blocks": [
                {
                    "bbox": [
                        69,
                        64,
                        139,
                        77
                    ],
                    "type": "title",
                    "angle": 0,
                    "index": 0,
                    "lines": [
                        {
                            "bbox": [
                                69,
                                64,
                                141,
                                81
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        64,
                                        141,
                                        81
                                    ],
                                    "type": "text",
                                    "content": "References",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                },
                {
                    "bbox": [
                        68,
                        89,
                        543,
                        716
                    ],
                    "type": "list",
                    "angle": 0,
                    "index": 15,
                    "blocks": [
                        {
                            "bbox": [
                                69,
                                89,
                                542,
                                124
                            ],
                            "type": "ref_text",
                            "angle": 0,
                            "index": 1,
                            "lines": [
                                {
                                    "bbox": [
                                        68,
                                        88,
                                        542,
                                        102
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                68,
                                                88,
                                                542,
                                                102
                                            ],
                                            "type": "text",
                                            "content": "Vaibhav Adlakha, Shehzaad Dhuliawala, Kaheer Suleman, Harm de Vries, and Siva Reddy. TopiOCQA: Open-domain",
                                            "score": 1.0
                                        }
                                    ]
                                },
                                {
                                    "bbox": [
                                        78,
                                        101,
                                        543,
                                        114
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                78,
                                                101,
                                                543,
                                                114
                                            ],
                                            "type": "text",
                                            "content": "conversational question answering with topic switching. Transactions of the Association for Computational Linguistics,",
                                            "score": 1.0
                                        }
                                    ]
                                },
                                {
                                    "bbox": [
                                        78,
                                        112,
                                        518,
                                        124
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                78,
                                                112,
                                                518,
                                                124
                                            ],
                                            "type": "text",
                                            "content": "10:468483, 04 2022. ISSN 2307-387X. doi: 10.1162/tacl_a_00471. https://doi.org/10.1162/tacl_a_00471.",
                                            "score": 1.0
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "bbox": [
                                68,
                                128,
                                543,
                                163
                            ],
                            "type": "ref_text",
                            "angle": 0,
                            "index": 2,
                            "lines": [
                                {
                                    "bbox": [
                                        69,
                                        129,
                                        542,
                                        141
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                69,
                                                129,
                                                542,
                                                141
                                            ],
                                            "type": "text",
                                            "content": "Raviteja Anantha, Svitlana Vakulenko, Zhucheng Tu, Shayne Longpre, Stephen Pulman, and Srinivas Chappidi.",
                                            "score": 1.0
                                        }
                                    ]
                                },
                                {
                                    "bbox": [
                                        79,
                                        140,
                                        541,
                                        152
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                79,
                                                140,
                                                541,
                                                152
                                            ],
                                            "type": "text",
                                            "content": "Open-domain question answering goes conversational via question rewriting. Proceedings of the 2021 Conference of",
                                            "score": 1.0
                                        }
                                    ]
                                },
                                {
                                    "bbox": [
                                        78,
                                        150,
                                        543,
                                        163
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                78,
                                                150,
                                                543,
                                                163
                                            ],
                                            "type": "text",
                                            "content": "the North American Chapter of the Association for Computational Linguistics: Human Language Technologies, 2021.",
                                            "score": 1.0
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "bbox": [
                                68,
                                167,
                                542,
                                224
                            ],
                            "type": "ref_text",
                            "angle": 0,
                            "index": 3,
                            "lines": [
                                {
                                    "bbox": [
                                        69,
                                        167,
                                        542,
                                        179
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                69,
                                                167,
                                                542,
                                                179
                                            ],
                                            "type": "text",
                                            "content": "Zhangir Azerbayev, Edward Ayers, and Bartosz Piotrowski. Proofpile: A pre-training dataset of mathematical",
                                            "score": 1.0
                                        }
                                    ]
                                },
                                {
                                    "bbox": [
                                        78,
                                        178,
                                        543,
                                        191
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                78,
                                                178,
                                                543,
                                                191
                                            ],
                                            "type": "text",
                                            "content": "texts. https://huggingface.co/datasets/hoskinson-center/proof-pile, 2023. Dataset available on Hugging Face. The",
                                            "score": 1.0
                                        }
                                    ]
                                },
                                {
                                    "bbox": [
                                        78,
                                        188,
                                        542,
                                        201
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                78,
                                                188,
                                                542,
                                                201
                                            ],
                                            "type": "text",
                                            "content": "dataset is 13GB and contains 8.3 billion tokens of informal and formal mathematics from diverse sources including",
                                            "score": 1.0
                                        }
                                    ]
                                },
                                {
                                    "bbox": [
                                        77,
                                        198,
                                        544,
                                        213
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                77,
                                                198,
                                                544,
                                                213
                                            ],
                                            "type": "text",
                                            "content": "arXiv.math, formal math libraries (Lean, Isabelle, Coq, HOL Light, Metamath, Mizar), Math Stack Exchange,",
                                            "score": 1.0
                                        }
                                    ]
                                },
                                {
                                    "bbox": [
                                        78,
                                        210,
                                        224,
                                        223
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                78,
                                                210,
                                                224,
                                                223
                                            ],
                                            "type": "text",
                                            "content": "Wikipedia math articles, and more.",
                                            "score": 1.0
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "bbox": [
                                69,
                                228,
                                542,
                                261
                            ],
                            "type": "ref_text",
                            "angle": 0,
                            "index": 4,
                            "lines": [
                                {
                                    "bbox": [
                                        67,
                                        228,
                                        542,
                                        240
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                67,
                                                228,
                                                542,
                                                240
                                            ],
                                            "type": "text",
                                            "content": "Irwan Bello, Hieu Pham, Quoc V. Le, Mohammad Norouzi, and Samy Bengio. Neural combinatorial optimization with",
                                            "score": 1.0
                                        }
                                    ]
                                },
                                {
                                    "bbox": [
                                        77,
                                        238,
                                        544,
                                        252
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                77,
                                                238,
                                                544,
                                                252
                                            ],
                                            "type": "text",
                                            "content": "reinforcement learning. In Workshop track of the International Conference on Learning Representations (ICLR),",
                                            "score": 1.0
                                        }
                                    ]
                                },
                                {
                                    "bbox": [
                                        78,
                                        250,
                                        103,
                                        262
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                78,
                                                250,
                                                103,
                                                262
                                            ],
                                            "type": "text",
                                            "content": "2017.",
                                            "score": 1.0
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "bbox": [
                                69,
                                266,
                                542,
                                289
                            ],
                            "type": "ref_text",
                            "angle": 0,
                            "index": 5,
                            "lines": [
                                {
                                    "bbox": [
                                        67,
                                        265,
                                        544,
                                        281
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                67,
                                                265,
                                                544,
                                                281
                                            ],
                                            "type": "text",
                                            "content": "Iz Beltagy, Matthew E. Peters, and Arman Cohan. Longformer: The long-document transformer. arXiv:2004.05150,",
                                            "score": 1.0
                                        }
                                    ]
                                },
                                {
                                    "bbox": [
                                        78,
                                        277,
                                        102,
                                        289
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                78,
                                                277,
                                                102,
                                                289
                                            ],
                                            "type": "text",
                                            "content": "2020.",
                                            "score": 1.0
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "bbox": [
                                69,
                                294,
                                541,
                                318
                            ],
                            "type": "ref_text",
                            "angle": 0,
                            "index": 6,
                            "lines": [
                                {
                                    "bbox": [
                                        69,
                                        294,
                                        542,
                                        308
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                69,
                                                294,
                                                542,
                                                308
                                            ],
                                            "type": "text",
                                            "content": "Yonatan Bisk, Rowan Zellers, Ronan Le Bras, Jianfeng Gao, and Yejin Choi. Piqa: Reasoning about physical",
                                            "score": 1.0
                                        }
                                    ]
                                },
                                {
                                    "bbox": [
                                        77,
                                        306,
                                        493,
                                        317
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                77,
                                                306,
                                                493,
                                                317
                                            ],
                                            "type": "text",
                                            "content": "commonsense in natural language. In Thirty-Fourth AAAI Conference on Artificial Intelligence, 2020.",
                                            "score": 1.0
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "bbox": [
                                69,
                                322,
                                542,
                                411
                            ],
                            "type": "ref_text",
                            "angle": 0,
                            "index": 7,
                            "lines": [
                                {
                                    "bbox": [
                                        69,
                                        323,
                                        542,
                                        335
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                69,
                                                323,
                                                542,
                                                335
                                            ],
                                            "type": "text",
                                            "content": "Sebastian Borgeaud, Arthur Mensch, Jordan Hoffmann, Trevor Cai, Eliza Rutherford, Katie Millican, George Bm",
                                            "score": 1.0
                                        }
                                    ]
                                },
                                {
                                    "bbox": [
                                        78,
                                        334,
                                        542,
                                        346
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                78,
                                                334,
                                                542,
                                                346
                                            ],
                                            "type": "text",
                                            "content": "Van Den Driessche, Jean-Baptiste Lespiau, Bogdan Damoc, Aidan Clark, Diego De Las Casas, Aurelia Guy, Jacob",
                                            "score": 1.0
                                        }
                                    ]
                                },
                                {
                                    "bbox": [
                                        77,
                                        344,
                                        542,
                                        358
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                77,
                                                344,
                                                542,
                                                358
                                            ],
                                            "type": "text",
                                            "content": "Menick, Roman Ring, Tom Hennigan, Saffron Huang, Loren Maggiore, Chris Jones, Albin Cassirer, Andy Brock,",
                                            "score": 1.0
                                        }
                                    ]
                                },
                                {
                                    "bbox": [
                                        78,
                                        356,
                                        542,
                                        368
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                78,
                                                356,
                                                542,
                                                368
                                            ],
                                            "type": "text",
                                            "content": "Michela Paganini, Geoffrey Irving, Oriol Vinyals, Simon Osindero, Karen Simonyan, Jack Rae, Erich Elsen, and",
                                            "score": 1.0
                                        }
                                    ]
                                },
                                {
                                    "bbox": [
                                        78,
                                        367,
                                        542,
                                        380
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                78,
                                                367,
                                                542,
                                                380
                                            ],
                                            "type": "text",
                                            "content": "Laurent Sifre. Improving language models by retrieving from trillions of tokens. In Kamalika Chaudhuri, Stefanie",
                                            "score": 1.0
                                        }
                                    ]
                                },
                                {
                                    "bbox": [
                                        78,
                                        377,
                                        542,
                                        389
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                78,
                                                377,
                                                542,
                                                389
                                            ],
                                            "type": "text",
                                            "content": "Jegelka, Le Song, Csaba Szepesvari, Gang Niu, and Sivan Sabato, editors, Proceedings of the 39th International",
                                            "score": 1.0
                                        }
                                    ]
                                },
                                {
                                    "bbox": [
                                        78,
                                        389,
                                        544,
                                        401
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                78,
                                                389,
                                                544,
                                                401
                                            ],
                                            "type": "text",
                                            "content": "Conference on Machine Learning, volume 162 of Proceedings of Machine Learning Research, pages 22062240. PMLR,",
                                            "score": 1.0
                                        }
                                    ]
                                },
                                {
                                    "bbox": [
                                        78,
                                        399,
                                        373,
                                        412
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                78,
                                                399,
                                                373,
                                                412
                                            ],
                                            "type": "text",
                                            "content": "1723 Jul 2022. https://proceedings.mlr.press/v162/borgeaud22a.html.",
                                            "score": 1.0
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "bbox": [
                                69,
                                416,
                                542,
                                460
                            ],
                            "type": "ref_text",
                            "angle": 0,
                            "index": 8,
                            "lines": [
                                {
                                    "bbox": [
                                        68,
                                        415,
                                        544,
                                        429
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                68,
                                                415,
                                                544,
                                                429
                                            ],
                                            "type": "text",
                                            "content": "Alexis Chevalier, Alexander Wettig, Anirudh Ajith, and Danqi Chen. Adapting language models to compress contexts.",
                                            "score": 1.0
                                        }
                                    ]
                                },
                                {
                                    "bbox": [
                                        78,
                                        427,
                                        541,
                                        438
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                78,
                                                427,
                                                541,
                                                438
                                            ],
                                            "type": "text",
                                            "content": "In Houda Bouamor, Juan Pino, and Kalika Bali, editors, Proceedings of the 2023 Conference on Empirical Methods",
                                            "score": 1.0
                                        }
                                    ]
                                },
                                {
                                    "bbox": [
                                        78,
                                        438,
                                        542,
                                        451
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                78,
                                                438,
                                                542,
                                                451
                                            ],
                                            "type": "text",
                                            "content": "in Natural Language Processing, pages 38293846, Singapore, December 2023. Association for Computational",
                                            "score": 1.0
                                        }
                                    ]
                                },
                                {
                                    "bbox": [
                                        78,
                                        449,
                                        488,
                                        462
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                78,
                                                449,
                                                488,
                                                462
                                            ],
                                            "type": "text",
                                            "content": "Linguistics. doi: 10.18653/v1/2023.emnlp-main.232. https://aclanthology.org/2023.emnlp-main.232.",
                                            "score": 1.0
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "bbox": [
                                69,
                                466,
                                542,
                                489
                            ],
                            "type": "ref_text",
                            "angle": 0,
                            "index": 9,
                            "lines": [
                                {
                                    "bbox": [
                                        69,
                                        466,
                                        543,
                                        479
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                69,
                                                466,
                                                543,
                                                479
                                            ],
                                            "type": "text",
                                            "content": "Rewon Child, Scott Gray, Alec Radford, and Ilya Sutskever. Generating long sequences with sparse transformers.",
                                            "score": 1.0
                                        }
                                    ]
                                },
                                {
                                    "bbox": [
                                        78,
                                        478,
                                        239,
                                        490
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                78,
                                                478,
                                                239,
                                                490
                                            ],
                                            "type": "text",
                                            "content": "arXiv preprint arXiv:1904.10509, 2019.",
                                            "score": 1.0
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "bbox": [
                                69,
                                494,
                                542,
                                538
                            ],
                            "type": "ref_text",
                            "angle": 0,
                            "index": 10,
                            "lines": [
                                {
                                    "bbox": [
                                        69,
                                        495,
                                        542,
                                        506
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                69,
                                                495,
                                                542,
                                                506
                                            ],
                                            "type": "text",
                                            "content": "Krzysztof Marcin Choromanski, Valerii Likhosherstov, David Dohan, Xingyou Song, Andreea Gane, Tamas Sarlos,",
                                            "score": 1.0
                                        }
                                    ]
                                },
                                {
                                    "bbox": [
                                        78,
                                        504,
                                        543,
                                        517
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                78,
                                                504,
                                                543,
                                                517
                                            ],
                                            "type": "text",
                                            "content": "Peter Hawkins, Jared Quincy Davis, Afroz Mohiuddin, Lukasz Kaiser, David Benjamin Belanger, Lucy J Colwell,",
                                            "score": 1.0
                                        }
                                    ]
                                },
                                {
                                    "bbox": [
                                        78,
                                        515,
                                        544,
                                        529
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                78,
                                                515,
                                                544,
                                                529
                                            ],
                                            "type": "text",
                                            "content": "and Adrian Weller. Rethinking attention with performers. In International Conference on Learning Representations,",
                                            "score": 1.0
                                        }
                                    ]
                                },
                                {
                                    "bbox": [
                                        78,
                                        527,
                                        310,
                                        538
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                78,
                                                527,
                                                310,
                                                538
                                            ],
                                            "type": "text",
                                            "content": "2021. https://openreview.net/forum?id=Ua6zuk0WRH.",
                                            "score": 1.0
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "bbox": [
                                69,
                                543,
                                542,
                                567
                            ],
                            "type": "ref_text",
                            "angle": 0,
                            "index": 11,
                            "lines": [
                                {
                                    "bbox": [
                                        68,
                                        542,
                                        543,
                                        556
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                68,
                                                542,
                                                543,
                                                556
                                            ],
                                            "type": "text",
                                            "content": "Christopher Clark, Kenton Lee, Ming-Wei Chang, Tom Kwiatkowski, Michael Collins, and Kristina Toutanova. Boolq:",
                                            "score": 1.0
                                        }
                                    ]
                                },
                                {
                                    "bbox": [
                                        78,
                                        555,
                                        408,
                                        566
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                78,
                                                555,
                                                408,
                                                566
                                            ],
                                            "type": "text",
                                            "content": "Exploring the surprising difficulty of natural yes/no questions. In NAACL, 2019.",
                                            "score": 1.0
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "bbox": [
                                69,
                                571,
                                542,
                                639
                            ],
                            "type": "ref_text",
                            "angle": 0,
                            "index": 12,
                            "lines": [
                                {
                                    "bbox": [
                                        68,
                                        571,
                                        544,
                                        584
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                68,
                                                571,
                                                544,
                                                584
                                            ],
                                            "type": "text",
                                            "content": "Arman Cohan, Franck Dernoncourt, Doo Soon Kim, Trung Bui, Seokhwan Kim, Walter Chang, and Nazli Goharian.",
                                            "score": 1.0
                                        }
                                    ]
                                },
                                {
                                    "bbox": [
                                        77,
                                        581,
                                        544,
                                        597
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                77,
                                                581,
                                                544,
                                                597
                                            ],
                                            "type": "text",
                                            "content": "A discourse-aware attention model for abstractive summarization of long documents. In Marilyn Walker, Heng Ji,",
                                            "score": 1.0
                                        }
                                    ]
                                },
                                {
                                    "bbox": [
                                        78,
                                        594,
                                        542,
                                        605
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                78,
                                                594,
                                                542,
                                                605
                                            ],
                                            "type": "text",
                                            "content": "and Amanda Stent, editors, Proceedings of the 2018 Conference of the North American Chapter of the Association",
                                            "score": 1.0
                                        }
                                    ]
                                },
                                {
                                    "bbox": [
                                        78,
                                        605,
                                        542,
                                        616
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                78,
                                                605,
                                                542,
                                                616
                                            ],
                                            "type": "text",
                                            "content": "for Computational Linguistics: Human Language Technologies, Volume 2 (Short Papers), pages 615621, New",
                                            "score": 1.0
                                        }
                                    ]
                                },
                                {
                                    "bbox": [
                                        78,
                                        614,
                                        544,
                                        628
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                78,
                                                614,
                                                544,
                                                628
                                            ],
                                            "type": "text",
                                            "content": "Orleans, Louisiana, June 2018. Association for Computational Linguistics. doi: 10.18653/v1/N18-2097. https:",
                                            "score": 1.0
                                        }
                                    ]
                                },
                                {
                                    "bbox": [
                                        78,
                                        626,
                                        208,
                                        638
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                78,
                                                626,
                                                208,
                                                638
                                            ],
                                            "type": "text",
                                            "content": "//aclanthology.org/N18-2097/.",
                                            "score": 1.0
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "bbox": [
                                69,
                                643,
                                541,
                                666
                            ],
                            "type": "ref_text",
                            "angle": 0,
                            "index": 13,
                            "lines": [
                                {
                                    "bbox": [
                                        68,
                                        643,
                                        542,
                                        657
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                68,
                                                643,
                                                542,
                                                657
                                            ],
                                            "type": "text",
                                            "content": "Hanjun Dai, Elias B. Khalil, Yuyu Zhang, Bistra Dilkina, and Le Song. Learning combinatorial optimization algorithms",
                                            "score": 1.0
                                        }
                                    ]
                                },
                                {
                                    "bbox": [
                                        78,
                                        654,
                                        512,
                                        668
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                78,
                                                654,
                                                512,
                                                668
                                            ],
                                            "type": "text",
                                            "content": "over graphs. In Advances in Neural Information Processing Systems (NeurIPS) 30, pages 63486358, 2017.",
                                            "score": 1.0
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "bbox": [
                                69,
                                671,
                                542,
                                716
                            ],
                            "type": "ref_text",
                            "angle": 0,
                            "index": 14,
                            "lines": [
                                {
                                    "bbox": [
                                        69,
                                        671,
                                        544,
                                        684
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                69,
                                                671,
                                                544,
                                                684
                                            ],
                                            "type": "text",
                                            "content": "Yuhong Dai, Jianxun Lian, Yitian Huang, Wei Zhang, Mingyang Zhou, Mingqi Wu, Xing Xie, and Hao Liao.",
                                            "score": 1.0
                                        }
                                    ]
                                },
                                {
                                    "bbox": [
                                        77,
                                        681,
                                        543,
                                        696
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                77,
                                                681,
                                                543,
                                                696
                                            ],
                                            "type": "text",
                                            "content": "Pretraining context compressor for large language models with embedding-based memory. In Wanxiang Che, Joyce",
                                            "score": 1.0
                                        }
                                    ]
                                },
                                {
                                    "bbox": [
                                        78,
                                        692,
                                        542,
                                        707
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                78,
                                                692,
                                                542,
                                                707
                                            ],
                                            "type": "text",
                                            "content": "Nabende, Ekaterina Shutova, and Mohammad Taher Pilehvar, editors, Proceedings of the 63rd Annual Meeting of",
                                            "score": 1.0
                                        }
                                    ]
                                },
                                {
                                    "bbox": [
                                        77,
                                        703,
                                        542,
                                        718
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                77,
                                                703,
                                                542,
                                                718
                                            ],
                                            "type": "text",
                                            "content": "the Association for Computational Linguistics (Volume 1: Long Papers), pages 2871528732, Vienna, Austria, July",
                                            "score": 1.0
                                        }
                                    ]
                                }
                            ]
                        }
                    ],
                    "sub_type": "ref_text"
                }
            ],
            "discarded_blocks": [
                {
                    "bbox": [
                        299,
                        742,
                        311,
                        751
                    ],
                    "type": "page_number",
                    "angle": 0,
                    "index": 16,
                    "lines": [
                        {
                            "bbox": [
                                298,
                                742,
                                313,
                                755
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        298,
                                        742,
                                        313,
                                        755
                                    ],
                                    "type": "text",
                                    "content": "12",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                }
            ],
            "page_size": [
                612,
                792
            ],
            "page_idx": 11
        },
        {
            "para_blocks": [
                {
                    "bbox": [
                        69,
                        64,
                        541,
                        696
                    ],
                    "type": "list",
                    "angle": 0,
                    "index": 15,
                    "blocks": [
                        {
                            "bbox": [
                                78,
                                64,
                                541,
                                87
                            ],
                            "type": "ref_text",
                            "angle": 0,
                            "index": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        78,
                                        64,
                                        544,
                                        76
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                78,
                                                64,
                                                544,
                                                76
                                            ],
                                            "type": "text",
                                            "content": "2025. Association for Computational Linguistics. ISBN 979-8-89176-251-0. doi: 10.18653/v1/2025.acl-long.1394.",
                                            "score": 1.0
                                        }
                                    ]
                                },
                                {
                                    "bbox": [
                                        78,
                                        76,
                                        268,
                                        87
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                78,
                                                76,
                                                268,
                                                87
                                            ],
                                            "type": "text",
                                            "content": "https://aclanthology.org/2025.acl-long.1394/.",
                                            "score": 1.0
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "bbox": [
                                69,
                                92,
                                541,
                                116
                            ],
                            "type": "ref_text",
                            "angle": 0,
                            "index": 1,
                            "lines": [
                                {
                                    "bbox": [
                                        69,
                                        93,
                                        541,
                                        104
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                69,
                                                93,
                                                541,
                                                104
                                            ],
                                            "type": "text",
                                            "content": "Kelvin Guu, Kenton Lee, Zora Tung, Panupong Pasupat, and Mingwei Chang. Retrieval augmented language model",
                                            "score": 1.0
                                        }
                                    ]
                                },
                                {
                                    "bbox": [
                                        78,
                                        104,
                                        462,
                                        115
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                78,
                                                104,
                                                462,
                                                115
                                            ],
                                            "type": "text",
                                            "content": "pre-training. In International conference on machine learning, pages 39293938. PMLR, 2020.",
                                            "score": 1.0
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "bbox": [
                                69,
                                121,
                                541,
                                143
                            ],
                            "type": "ref_text",
                            "angle": 0,
                            "index": 2,
                            "lines": [
                                {
                                    "bbox": [
                                        69,
                                        120,
                                        542,
                                        133
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                69,
                                                120,
                                                542,
                                                133
                                            ],
                                            "type": "text",
                                            "content": "Dan Hendrycks, Collin Burns, Steven Basart, Andy Zou, Mantas Mazeika, Dawn Song, and Jacob Steinhardt. Measuring",
                                            "score": 1.0
                                        }
                                    ]
                                },
                                {
                                    "bbox": [
                                        78,
                                        132,
                                        343,
                                        143
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                78,
                                                132,
                                                343,
                                                143
                                            ],
                                            "type": "text",
                                            "content": "massive multitask language understanding. In Proc. ICLR, 2021.",
                                            "score": 1.0
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "bbox": [
                                69,
                                148,
                                541,
                                203
                            ],
                            "type": "ref_text",
                            "angle": 0,
                            "index": 3,
                            "lines": [
                                {
                                    "bbox": [
                                        67,
                                        147,
                                        542,
                                        162
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                67,
                                                147,
                                                542,
                                                162
                                            ],
                                            "type": "text",
                                            "content": "Gautier Izacard and Edouard Grave. Leveraging passage retrieval with generative models for open domain question",
                                            "score": 1.0
                                        }
                                    ]
                                },
                                {
                                    "bbox": [
                                        78,
                                        159,
                                        542,
                                        171
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                78,
                                                159,
                                                542,
                                                171
                                            ],
                                            "type": "text",
                                            "content": "answering. In Paola Merlo, Jorg Tiedemann, and Reut Tsarfaty, editors, Proceedings of the 16th Conference of the",
                                            "score": 1.0
                                        }
                                    ]
                                },
                                {
                                    "bbox": [
                                        79,
                                        170,
                                        542,
                                        182
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                79,
                                                170,
                                                542,
                                                182
                                            ],
                                            "type": "text",
                                            "content": "European Chapter of the Association for Computational Linguistics: Main Volume, pages 874880, Online, April",
                                            "score": 1.0
                                        }
                                    ]
                                },
                                {
                                    "bbox": [
                                        78,
                                        180,
                                        542,
                                        194
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                78,
                                                180,
                                                542,
                                                194
                                            ],
                                            "type": "text",
                                            "content": "2021. Association for Computational Linguistics. doi: 10.18653/v1/2021.eacl-main.74. https://aclanthology.org/",
                                            "score": 1.0
                                        }
                                    ]
                                },
                                {
                                    "bbox": [
                                        79,
                                        193,
                                        161,
                                        203
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                79,
                                                193,
                                                161,
                                                203
                                            ],
                                            "type": "text",
                                            "content": "2021.eacl-main.74/.",
                                            "score": 1.0
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "bbox": [
                                69,
                                209,
                                541,
                                241
                            ],
                            "type": "ref_text",
                            "angle": 0,
                            "index": 4,
                            "lines": [
                                {
                                    "bbox": [
                                        70,
                                        209,
                                        541,
                                        220
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                70,
                                                209,
                                                541,
                                                220
                                            ],
                                            "type": "text",
                                            "content": "Gautier Izacard, Mostafa Dehghani, Sina Hosseini, Holger Schwenk, Fabio Petroni, and Sebastian Riedel. Few-shot",
                                            "score": 1.0
                                        }
                                    ]
                                },
                                {
                                    "bbox": [
                                        78,
                                        220,
                                        541,
                                        232
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                78,
                                                220,
                                                541,
                                                232
                                            ],
                                            "type": "text",
                                            "content": "learning with retrieval augmented language models. arXiv preprint arXiv:2208.03299, 2022. https://arxiv.org/abs/",
                                            "score": 1.0
                                        }
                                    ]
                                },
                                {
                                    "bbox": [
                                        78,
                                        232,
                                        128,
                                        242
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                78,
                                                232,
                                                128,
                                                242
                                            ],
                                            "type": "text",
                                            "content": "2208.03299.",
                                            "score": 1.0
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "bbox": [
                                69,
                                247,
                                541,
                                281
                            ],
                            "type": "ref_text",
                            "angle": 0,
                            "index": 5,
                            "lines": [
                                {
                                    "bbox": [
                                        70,
                                        248,
                                        541,
                                        258
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                70,
                                                248,
                                                541,
                                                258
                                            ],
                                            "type": "text",
                                            "content": "Gautier Izacard, Patrick Lewis, Maria Lomeli, Lucas Hosseini, Fabio Petroni, Timo Schick, Jane Dwivedi-Yu, Armand",
                                            "score": 1.0
                                        }
                                    ]
                                },
                                {
                                    "bbox": [
                                        78,
                                        258,
                                        542,
                                        271
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                78,
                                                258,
                                                542,
                                                271
                                            ],
                                            "type": "text",
                                            "content": "Joulin, Edouard Grave, and Sebastian Riedel. Atlas: Few-shot learning with retrieval augmented language models.",
                                            "score": 1.0
                                        }
                                    ]
                                },
                                {
                                    "bbox": [
                                        78,
                                        270,
                                        257,
                                        281
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                78,
                                                270,
                                                257,
                                                281
                                            ],
                                            "type": "text",
                                            "content": "J. Mach. Learn. Res., 24:37:137:37, 2023a.",
                                            "score": 1.0
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "bbox": [
                                69,
                                286,
                                541,
                                320
                            ],
                            "type": "ref_text",
                            "angle": 0,
                            "index": 6,
                            "lines": [
                                {
                                    "bbox": [
                                        69,
                                        287,
                                        542,
                                        299
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                69,
                                                287,
                                                542,
                                                299
                                            ],
                                            "type": "text",
                                            "content": "Gautier Izacard, Patrick Lewis, Maria Lomeli, Lucas Hosseini, Fabio Petroni, Timo Schick, Jane Dwivedi-Yu, Armand",
                                            "score": 1.0
                                        }
                                    ]
                                },
                                {
                                    "bbox": [
                                        78,
                                        297,
                                        542,
                                        310
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                78,
                                                297,
                                                542,
                                                310
                                            ],
                                            "type": "text",
                                            "content": "Joulin, Sebastian Riedel, and Edouard Grave. Atlas: Few-shot learning with retrieval augmented language models.",
                                            "score": 1.0
                                        }
                                    ]
                                },
                                {
                                    "bbox": [
                                        79,
                                        310,
                                        324,
                                        320
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                79,
                                                310,
                                                324,
                                                320
                                            ],
                                            "type": "text",
                                            "content": "Journal of Machine Learning Research, 24(251):143, 2023b.",
                                            "score": 1.0
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "bbox": [
                                69,
                                326,
                                541,
                                370
                            ],
                            "type": "ref_text",
                            "angle": 0,
                            "index": 7,
                            "lines": [
                                {
                                    "bbox": [
                                        69,
                                        327,
                                        542,
                                        337
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                69,
                                                327,
                                                542,
                                                337
                                            ],
                                            "type": "text",
                                            "content": "Huiqiang Jiang, Qianhui Wu, Chin-Yew Lin, Yuqing Yang, and Lili Qiu. Llmlingua: Compressing prompts for",
                                            "score": 1.0
                                        }
                                    ]
                                },
                                {
                                    "bbox": [
                                        78,
                                        336,
                                        542,
                                        349
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                78,
                                                336,
                                                542,
                                                349
                                            ],
                                            "type": "text",
                                            "content": "accelerated inference of large language models. In Proceedings of the 2023 Conference on Empirical Methods",
                                            "score": 1.0
                                        }
                                    ]
                                },
                                {
                                    "bbox": [
                                        77,
                                        347,
                                        543,
                                        361
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                77,
                                                347,
                                                543,
                                                361
                                            ],
                                            "type": "text",
                                            "content": "in Natural Language Processing, pages 1335813376, Singapore, December 2023. Association for Computational",
                                            "score": 1.0
                                        }
                                    ]
                                },
                                {
                                    "bbox": [
                                        78,
                                        358,
                                        493,
                                        371
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                78,
                                                358,
                                                493,
                                                371
                                            ],
                                            "type": "text",
                                            "content": "Linguistics. doi: 10.18653/v1/2023.emnlp-main.825. https://aclanthology.org/2023.emnlp-main.825/.",
                                            "score": 1.0
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "bbox": [
                                69,
                                375,
                                541,
                                420
                            ],
                            "type": "ref_text",
                            "angle": 0,
                            "index": 8,
                            "lines": [
                                {
                                    "bbox": [
                                        69,
                                        376,
                                        543,
                                        388
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                69,
                                                376,
                                                543,
                                                388
                                            ],
                                            "type": "text",
                                            "content": "Huiqiang Jiang, Qianhui Wu, Xufang Luo, Dongsheng Li, Chin-Yew Lin, Yuqing Yang, and Lili Qiu. LongLLMLingua:",
                                            "score": 1.0
                                        }
                                    ]
                                },
                                {
                                    "bbox": [
                                        78,
                                        387,
                                        543,
                                        399
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                78,
                                                387,
                                                543,
                                                399
                                            ],
                                            "type": "text",
                                            "content": "Accelerating and enhancing LLMs in long context scenarios via prompt compression. In Proceedings of the 62nd",
                                            "score": 1.0
                                        }
                                    ]
                                },
                                {
                                    "bbox": [
                                        78,
                                        396,
                                        543,
                                        410
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                78,
                                                396,
                                                543,
                                                410
                                            ],
                                            "type": "text",
                                            "content": "Annual Meeting of the Association for Computational Linguistics (Volume 1: Long Papers), Bangkok, Thailand,",
                                            "score": 1.0
                                        }
                                    ]
                                },
                                {
                                    "bbox": [
                                        78,
                                        408,
                                        309,
                                        421
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                78,
                                                408,
                                                309,
                                                421
                                            ],
                                            "type": "text",
                                            "content": "August 2024. Association for Computational Linguistics.",
                                            "score": 1.0
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "bbox": [
                                69,
                                426,
                                541,
                                491
                            ],
                            "type": "ref_text",
                            "angle": 0,
                            "index": 9,
                            "lines": [
                                {
                                    "bbox": [
                                        69,
                                        424,
                                        542,
                                        438
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                69,
                                                424,
                                                542,
                                                438
                                            ],
                                            "type": "text",
                                            "content": "Yuri Kuratov, Mikhail Arkhipov, Aydar Bulatov, and Mikhail Burtsev. Cramming 1568 tokens into a single vector",
                                            "score": 1.0
                                        }
                                    ]
                                },
                                {
                                    "bbox": [
                                        78,
                                        436,
                                        543,
                                        449
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                78,
                                                436,
                                                543,
                                                449
                                            ],
                                            "type": "text",
                                            "content": "and back again: Exploring the limits of embedding space capacity. In Wanxiang Che, Joyce Nabende, Ekaterina",
                                            "score": 1.0
                                        }
                                    ]
                                },
                                {
                                    "bbox": [
                                        78,
                                        448,
                                        542,
                                        459
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                78,
                                                448,
                                                542,
                                                459
                                            ],
                                            "type": "text",
                                            "content": "Shutova, and Mohammad Taher Pilehvar, editors, Proceedings of the 63rd Annual Meeting of the Association for",
                                            "score": 1.0
                                        }
                                    ]
                                },
                                {
                                    "bbox": [
                                        78,
                                        458,
                                        542,
                                        471
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                78,
                                                458,
                                                542,
                                                471
                                            ],
                                            "type": "text",
                                            "content": "Computational Linguistics (Volume 1: Long Papers), pages 1932319339, Vienna, Austria, July 2025. Association",
                                            "score": 1.0
                                        }
                                    ]
                                },
                                {
                                    "bbox": [
                                        77,
                                        466,
                                        544,
                                        484
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                77,
                                                466,
                                                544,
                                                484
                                            ],
                                            "type": "text",
                                            "content": "for Computational Linguistics. ISBN 979-8-89176-251-0. doi: 10.18653/v1/2025.acl-long.948. https://aclanthology.",
                                            "score": 1.0
                                        }
                                    ]
                                },
                                {
                                    "bbox": [
                                        78,
                                        480,
                                        176,
                                        491
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                78,
                                                480,
                                                176,
                                                491
                                            ],
                                            "type": "text",
                                            "content": "org/2025.acl-long.948/.",
                                            "score": 1.0
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "bbox": [
                                69,
                                497,
                                541,
                                520
                            ],
                            "type": "ref_text",
                            "angle": 0,
                            "index": 10,
                            "lines": [
                                {
                                    "bbox": [
                                        69,
                                        497,
                                        542,
                                        510
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                69,
                                                497,
                                                542,
                                                510
                                            ],
                                            "type": "text",
                                            "content": "Bozhou Li, Hao Liang, Zimo Meng, and Wentao Zhang. Are bigger encoders always better in vision large models?",
                                            "score": 1.0
                                        }
                                    ]
                                },
                                {
                                    "bbox": [
                                        78,
                                        508,
                                        311,
                                        520
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                78,
                                                508,
                                                311,
                                                520
                                            ],
                                            "type": "text",
                                            "content": "arXiv preprint arXiv:2408.00620, August 2024. Preprint.",
                                            "score": 1.0
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "bbox": [
                                69,
                                525,
                                541,
                                570
                            ],
                            "type": "ref_text",
                            "angle": 0,
                            "index": 11,
                            "lines": [
                                {
                                    "bbox": [
                                        68,
                                        524,
                                        542,
                                        537
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                68,
                                                524,
                                                542,
                                                537
                                            ],
                                            "type": "text",
                                            "content": "Yucheng Li, Bo Dong, Frank Guerin, and Chenghua Lin. Compressing context to enhance inference efficiency of large",
                                            "score": 1.0
                                        }
                                    ]
                                },
                                {
                                    "bbox": [
                                        78,
                                        535,
                                        543,
                                        548
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                78,
                                                535,
                                                543,
                                                548
                                            ],
                                            "type": "text",
                                            "content": "language models. In Proceedings of the 2023 Conference on Empirical Methods in Natural Language Processing,",
                                            "score": 1.0
                                        }
                                    ]
                                },
                                {
                                    "bbox": [
                                        77,
                                        545,
                                        542,
                                        562
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                77,
                                                545,
                                                542,
                                                562
                                            ],
                                            "type": "text",
                                            "content": "pages 63426353, Singapore, December 2023. Association for Computational Linguistics. https://aclanthology.org/",
                                            "score": 1.0
                                        }
                                    ]
                                },
                                {
                                    "bbox": [
                                        78,
                                        558,
                                        188,
                                        571
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                78,
                                                558,
                                                188,
                                                571
                                            ],
                                            "type": "text",
                                            "content": "2023.emnlp-main.391.pdf.",
                                            "score": 1.0
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "bbox": [
                                69,
                                574,
                                541,
                                609
                            ],
                            "type": "ref_text",
                            "angle": 0,
                            "index": 12,
                            "lines": [
                                {
                                    "bbox": [
                                        68,
                                        574,
                                        544,
                                        587
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                68,
                                                574,
                                                544,
                                                587
                                            ],
                                            "type": "text",
                                            "content": "Sheng-Chieh Lin, Akari Asai, Minghan Li, Barlas Oguz, Jimmy Lin, Yashar Mehdad, Wen tau Yih, and Xilun Chen.",
                                            "score": 1.0
                                        }
                                    ]
                                },
                                {
                                    "bbox": [
                                        78,
                                        586,
                                        542,
                                        597
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                78,
                                                586,
                                                542,
                                                597
                                            ],
                                            "type": "text",
                                            "content": "How to train your dragon: Diverse augmentation towards generalizable dense retrieval. In The 2023 Conference on",
                                            "score": 1.0
                                        }
                                    ]
                                },
                                {
                                    "bbox": [
                                        78,
                                        597,
                                        512,
                                        609
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                78,
                                                597,
                                                512,
                                                609
                                            ],
                                            "type": "text",
                                            "content": "Empirical Methods in Natural Language Processing, 2023. https://openreview.net/forum?id=d00kbjbYv2.",
                                            "score": 1.0
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "bbox": [
                                69,
                                613,
                                541,
                                658
                            ],
                            "type": "ref_text",
                            "angle": 0,
                            "index": 13,
                            "lines": [
                                {
                                    "bbox": [
                                        67,
                                        613,
                                        543,
                                        626
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                67,
                                                613,
                                                543,
                                                626
                                            ],
                                            "type": "text",
                                            "content": "Xi Victoria Lin, Xilun Chen, Mingda Chen, Weijia Shi, Maria Lomeli, Richard James, Pedro Rodriguez, Jacob Kahn,",
                                            "score": 1.0
                                        }
                                    ]
                                },
                                {
                                    "bbox": [
                                        78,
                                        624,
                                        542,
                                        636
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                78,
                                                624,
                                                542,
                                                636
                                            ],
                                            "type": "text",
                                            "content": "Gergely Szilvasy, Mike Lewis, Luke Zettlemoyer, and Wen tau Yih. RA-DIT: Retrieval-augmented dual instruction",
                                            "score": 1.0
                                        }
                                    ]
                                },
                                {
                                    "bbox": [
                                        78,
                                        635,
                                        542,
                                        647
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                78,
                                                635,
                                                542,
                                                647
                                            ],
                                            "type": "text",
                                            "content": "tuning. In The Twelfth International Conference on Learning Representations, 2024. https://openreview.net/",
                                            "score": 1.0
                                        }
                                    ]
                                },
                                {
                                    "bbox": [
                                        78,
                                        645,
                                        180,
                                        658
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                78,
                                                645,
                                                180,
                                                658
                                            ],
                                            "type": "text",
                                            "content": "forum?id=22OTbutug9.",
                                            "score": 1.0
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "bbox": [
                                69,
                                663,
                                541,
                                696
                            ],
                            "type": "ref_text",
                            "angle": 0,
                            "index": 14,
                            "lines": [
                                {
                                    "bbox": [
                                        69,
                                        663,
                                        542,
                                        675
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                69,
                                                663,
                                                542,
                                                675
                                            ],
                                            "type": "text",
                                            "content": "Barys Liskavets, Maxim Ushakov, Shuvendu Roy, Mark Klibanov, Ali Etemad, and Shane Luke. Prompt compression",
                                            "score": 1.0
                                        }
                                    ]
                                },
                                {
                                    "bbox": [
                                        78,
                                        674,
                                        542,
                                        686
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                78,
                                                674,
                                                542,
                                                686
                                            ],
                                            "type": "text",
                                            "content": "with context-aware sentence encoding for fast and improved llm inference. arXiv preprint arXiv:2409.01227, 2024.",
                                            "score": 1.0
                                        }
                                    ]
                                },
                                {
                                    "bbox": [
                                        78,
                                        685,
                                        325,
                                        697
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                78,
                                                685,
                                                325,
                                                697
                                            ],
                                            "type": "text",
                                            "content": "https://arxiv.org/abs/2409.01227. Accepted at AAAI 2025.",
                                            "score": 1.0
                                        }
                                    ]
                                }
                            ]
                        }
                    ],
                    "sub_type": "ref_text"
                }
            ],
            "discarded_blocks": [
                {
                    "bbox": [
                        299,
                        742,
                        310,
                        751
                    ],
                    "type": "page_number",
                    "angle": 0,
                    "index": 16,
                    "lines": [
                        {
                            "bbox": [
                                299,
                                742,
                                312,
                                755
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        299,
                                        742,
                                        312,
                                        755
                                    ],
                                    "type": "text",
                                    "content": "13",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                }
            ],
            "page_size": [
                612,
                792
            ],
            "page_idx": 12
        },
        {
            "para_blocks": [
                {
                    "bbox": [
                        67,
                        64,
                        543,
                        713
                    ],
                    "type": "list",
                    "angle": 0,
                    "index": 16,
                    "blocks": [
                        {
                            "bbox": [
                                69,
                                64,
                                542,
                                99
                            ],
                            "type": "ref_text",
                            "angle": 0,
                            "index": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        68,
                                        63,
                                        544,
                                        78
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                68,
                                                63,
                                                544,
                                                78
                                            ],
                                            "type": "text",
                                            "content": "Jingyu Liu, Beidi Chen, and Ce Zhang. Speculative prefill: Turbocharging TTFT with lightweight and training-",
                                            "score": 1.0
                                        }
                                    ]
                                },
                                {
                                    "bbox": [
                                        77,
                                        74,
                                        544,
                                        89
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                77,
                                                74,
                                                544,
                                                89
                                            ],
                                            "type": "text",
                                            "content": "free token importance estimation. In Forty-second International Conference on Machine Learning, 2025. https:",
                                            "score": 1.0
                                        }
                                    ]
                                },
                                {
                                    "bbox": [
                                        78,
                                        86,
                                        252,
                                        100
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                78,
                                                86,
                                                252,
                                                100
                                            ],
                                            "type": "text",
                                            "content": "//openreview.net/forum?id=bzbuZ0ItBq.",
                                            "score": 1.0
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                103,
                                543,
                                137
                            ],
                            "type": "ref_text",
                            "angle": 0,
                            "index": 1,
                            "lines": [
                                {
                                    "bbox": [
                                        68,
                                        102,
                                        544,
                                        117
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                68,
                                                102,
                                                544,
                                                117
                                            ],
                                            "type": "text",
                                            "content": "Yinhan Liu, Myle Ott, Naman Goyal, Jingfei Du, Mandar Joshi, Danqi Chen, Omer Levy, Mike Lewis, Luke Zettlemoyer,",
                                            "score": 1.0
                                        }
                                    ]
                                },
                                {
                                    "bbox": [
                                        78,
                                        114,
                                        543,
                                        127
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                78,
                                                114,
                                                543,
                                                127
                                            ],
                                            "type": "text",
                                            "content": "and Veselin Stoyanov. Roberta: A robustly optimized bert pretraining approach. arXiv preprint arXiv:1907.11692,",
                                            "score": 1.0
                                        }
                                    ]
                                },
                                {
                                    "bbox": [
                                        78,
                                        125,
                                        102,
                                        137
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                78,
                                                125,
                                                102,
                                                137
                                            ],
                                            "type": "text",
                                            "content": "2019.",
                                            "score": 1.0
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "bbox": [
                                69,
                                142,
                                541,
                                165
                            ],
                            "type": "ref_text",
                            "angle": 0,
                            "index": 2,
                            "lines": [
                                {
                                    "bbox": [
                                        66,
                                        139,
                                        544,
                                        158
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                66,
                                                139,
                                                544,
                                                158
                                            ],
                                            "type": "text",
                                            "content": "Ilya Loshchilov and Frank Hutter. Decoupled weight decay regularization. In International Conference on Learning",
                                            "score": 1.0
                                        }
                                    ]
                                },
                                {
                                    "bbox": [
                                        78,
                                        153,
                                        205,
                                        166
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                78,
                                                153,
                                                205,
                                                166
                                            ],
                                            "type": "text",
                                            "content": "Representations (ICLR), 2019.",
                                            "score": 1.0
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "bbox": [
                                69,
                                170,
                                541,
                                203
                            ],
                            "type": "ref_text",
                            "angle": 0,
                            "index": 3,
                            "lines": [
                                {
                                    "bbox": [
                                        67,
                                        169,
                                        542,
                                        183
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                67,
                                                169,
                                                542,
                                                183
                                            ],
                                            "type": "text",
                                            "content": "Fabio Petroni, Aleksandra Piktus, Angela Fan, Patrick Lewis, Majid Yazdani, Nicola De Cao, James Thorne, Yacine",
                                            "score": 1.0
                                        }
                                    ]
                                },
                                {
                                    "bbox": [
                                        78,
                                        182,
                                        542,
                                        194
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                78,
                                                182,
                                                542,
                                                194
                                            ],
                                            "type": "text",
                                            "content": "Jernite, Vladimir Karpukhin, Jean Maillard, et al. Kilt: a benchmark for knowledge intensive language tasks. arXiv",
                                            "score": 1.0
                                        }
                                    ]
                                },
                                {
                                    "bbox": [
                                        78,
                                        193,
                                        214,
                                        205
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                78,
                                                193,
                                                214,
                                                205
                                            ],
                                            "type": "text",
                                            "content": "preprint arXiv:2009.02252, 2020.",
                                            "score": 1.0
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "bbox": [
                                69,
                                209,
                                541,
                                232
                            ],
                            "type": "ref_text",
                            "angle": 0,
                            "index": 4,
                            "lines": [
                                {
                                    "bbox": [
                                        69,
                                        209,
                                        542,
                                        221
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                69,
                                                209,
                                                542,
                                                221
                                            ],
                                            "type": "text",
                                            "content": "Chen Qu, Liu Yang, Cen Chen, Minghui Qiu, W. Bruce Croft, and Mohit Iyyer. Open-Retrieval Conversational",
                                            "score": 1.0
                                        }
                                    ]
                                },
                                {
                                    "bbox": [
                                        79,
                                        220,
                                        233,
                                        232
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                79,
                                                220,
                                                233,
                                                232
                                            ],
                                            "type": "text",
                                            "content": "Question Answering. In SIGIR, 2020.",
                                            "score": 1.0
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "bbox": [
                                69,
                                237,
                                541,
                                259
                            ],
                            "type": "ref_text",
                            "angle": 0,
                            "index": 5,
                            "lines": [
                                {
                                    "bbox": [
                                        69,
                                        237,
                                        541,
                                        248
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                69,
                                                237,
                                                541,
                                                248
                                            ],
                                            "type": "text",
                                            "content": "Jack W Rae, Anna Potapenko, Siddhant M Jayakumar, Chloe Hillier, and Timothy P Lillicrap. Compressive",
                                            "score": 1.0
                                        }
                                    ]
                                },
                                {
                                    "bbox": [
                                        78,
                                        247,
                                        506,
                                        261
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                78,
                                                247,
                                                506,
                                                261
                                            ],
                                            "type": "text",
                                            "content": "transformers for long-range sequence modelling. arXiv preprint, 2019. https://arxiv.org/abs/1911.05507.",
                                            "score": 1.0
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "bbox": [
                                69,
                                265,
                                541,
                                298
                            ],
                            "type": "ref_text",
                            "angle": 0,
                            "index": 6,
                            "lines": [
                                {
                                    "bbox": [
                                        67,
                                        263,
                                        542,
                                        277
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                67,
                                                263,
                                                542,
                                                277
                                            ],
                                            "type": "text",
                                            "content": "Jack W. Rae, Anna Potapenko, Siddhant M. Jayakumar, Chloe Hillier, and Timothy P. Lillicrap. Compressive",
                                            "score": 1.0
                                        }
                                    ]
                                },
                                {
                                    "bbox": [
                                        78,
                                        276,
                                        542,
                                        289
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                78,
                                                276,
                                                542,
                                                289
                                            ],
                                            "type": "text",
                                            "content": "transformers for long-range sequence modelling. In International Conference on Learning Representations, 2020.",
                                            "score": 1.0
                                        }
                                    ]
                                },
                                {
                                    "bbox": [
                                        78,
                                        288,
                                        280,
                                        298
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                78,
                                                288,
                                                280,
                                                298
                                            ],
                                            "type": "text",
                                            "content": "https://openreview.net/forum?id=SylKikSYDH.",
                                            "score": 1.0
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "bbox": [
                                69,
                                304,
                                541,
                                359
                            ],
                            "type": "ref_text",
                            "angle": 0,
                            "index": 7,
                            "lines": [
                                {
                                    "bbox": [
                                        69,
                                        304,
                                        542,
                                        316
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                69,
                                                304,
                                                542,
                                                316
                                            ],
                                            "type": "text",
                                            "content": "Stephen Roller, Emily Dinan, Naman Goyal, Da Ju, Mary Williamson, Yinhan Liu, Jing Xu, Myle Ott, Eric Michael",
                                            "score": 1.0
                                        }
                                    ]
                                },
                                {
                                    "bbox": [
                                        77,
                                        312,
                                        542,
                                        328
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                77,
                                                312,
                                                542,
                                                328
                                            ],
                                            "type": "text",
                                            "content": "Smith, Y-Lan Boureau, and Jason Weston. Recipes for building an open-domain chatbot. In Paola Merlo, Jorg",
                                            "score": 1.0
                                        }
                                    ]
                                },
                                {
                                    "bbox": [
                                        78,
                                        326,
                                        542,
                                        338
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                78,
                                                326,
                                                542,
                                                338
                                            ],
                                            "type": "text",
                                            "content": "Tiedemann, and Reut Tsarfaty, editors, Proceedings of the 16th Conference of the European Chapter of the Association",
                                            "score": 1.0
                                        }
                                    ]
                                },
                                {
                                    "bbox": [
                                        78,
                                        337,
                                        542,
                                        350
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                78,
                                                337,
                                                542,
                                                350
                                            ],
                                            "type": "text",
                                            "content": "for Computational Linguistics: Main Volume, pages 300325, Online, April 2021. Association for Computational",
                                            "score": 1.0
                                        }
                                    ]
                                },
                                {
                                    "bbox": [
                                        78,
                                        348,
                                        466,
                                        360
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                78,
                                                348,
                                                466,
                                                360
                                            ],
                                            "type": "text",
                                            "content": "Linguistics. doi: 10.18653/v1/2021.eacl-main.24. https://aclanthology.org/2021.eacl-main.24/.",
                                            "score": 1.0
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "bbox": [
                                69,
                                365,
                                541,
                                420
                            ],
                            "type": "ref_text",
                            "angle": 0,
                            "index": 8,
                            "lines": [
                                {
                                    "bbox": [
                                        67,
                                        362,
                                        542,
                                        379
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                67,
                                                362,
                                                542,
                                                379
                                            ],
                                            "type": "text",
                                            "content": "Maarten Sap, Hannah Rashkin, Derek Chen, Ronan Le Bras, and Yejin Choi. Social IQa: Commonsense reasoning",
                                            "score": 1.0
                                        }
                                    ]
                                },
                                {
                                    "bbox": [
                                        78,
                                        376,
                                        541,
                                        388
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                78,
                                                376,
                                                541,
                                                388
                                            ],
                                            "type": "text",
                                            "content": "about social interactions. In Kentaro Inui, Jing Jiang, Vincent Ng, and Xiaojun Wan, editors, Proceedings of the 2019",
                                            "score": 1.0
                                        }
                                    ]
                                },
                                {
                                    "bbox": [
                                        78,
                                        386,
                                        542,
                                        399
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                78,
                                                386,
                                                542,
                                                399
                                            ],
                                            "type": "text",
                                            "content": "Conference on Empirical Methods in Natural Language Processing and the 9th International Joint Conference on",
                                            "score": 1.0
                                        }
                                    ]
                                },
                                {
                                    "bbox": [
                                        78,
                                        397,
                                        542,
                                        410
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                78,
                                                397,
                                                542,
                                                410
                                            ],
                                            "type": "text",
                                            "content": "Natural Language Processing (EMNLP-IJCNLP), pages 44634473, Hong Kong, China, November 2019. Association",
                                            "score": 1.0
                                        }
                                    ]
                                },
                                {
                                    "bbox": [
                                        78,
                                        408,
                                        205,
                                        421
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                78,
                                                408,
                                                205,
                                                421
                                            ],
                                            "type": "text",
                                            "content": "for Computational Linguistics.",
                                            "score": 1.0
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "bbox": [
                                69,
                                426,
                                541,
                                448
                            ],
                            "type": "ref_text",
                            "angle": 0,
                            "index": 9,
                            "lines": [
                                {
                                    "bbox": [
                                        67,
                                        423,
                                        542,
                                        439
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                67,
                                                423,
                                                542,
                                                439
                                            ],
                                            "type": "text",
                                            "content": "John Schulman, Filip Wolski, Prafulla Dhariwal, Alec Radford, and Oleg Klimov. Proximal policy optimization",
                                            "score": 1.0
                                        }
                                    ]
                                },
                                {
                                    "bbox": [
                                        78,
                                        436,
                                        289,
                                        449
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                78,
                                                436,
                                                289,
                                                449
                                            ],
                                            "type": "text",
                                            "content": "algorithms. arXiv preprint arXiv:1707.06347, 2017.",
                                            "score": 1.0
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "bbox": [
                                69,
                                453,
                                541,
                                486
                            ],
                            "type": "ref_text",
                            "angle": 0,
                            "index": 10,
                            "lines": [
                                {
                                    "bbox": [
                                        69,
                                        453,
                                        542,
                                        465
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                69,
                                                453,
                                                542,
                                                465
                                            ],
                                            "type": "text",
                                            "content": "Zhihong Shao, Peiyi Wang, Qihao Zhu, Runxin Xu, Junxiao Song, Xiao Bi, Haowei Zhang, Mingchuan Zhang, YK Li,",
                                            "score": 1.0
                                        }
                                    ]
                                },
                                {
                                    "bbox": [
                                        79,
                                        464,
                                        542,
                                        476
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                79,
                                                464,
                                                542,
                                                476
                                            ],
                                            "type": "text",
                                            "content": "Yang Wu, et al. Deepseekmath: Pushing the limits of mathematical reasoning in open language models. arXiv",
                                            "score": 1.0
                                        }
                                    ]
                                },
                                {
                                    "bbox": [
                                        77,
                                        475,
                                        214,
                                        487
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                77,
                                                475,
                                                214,
                                                487
                                            ],
                                            "type": "text",
                                            "content": "preprint arXiv:2402.03300, 2024.",
                                            "score": 1.0
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "bbox": [
                                69,
                                492,
                                541,
                                558
                            ],
                            "type": "ref_text",
                            "angle": 0,
                            "index": 11,
                            "lines": [
                                {
                                    "bbox": [
                                        70,
                                        492,
                                        542,
                                        504
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                70,
                                                492,
                                                542,
                                                504
                                            ],
                                            "type": "text",
                                            "content": "Weijia Shi, Sewon Min, Michihiro Yasunaga, Minjoon Seo, Richard James, Mike Lewis, Luke Zettlemoyer, and",
                                            "score": 1.0
                                        }
                                    ]
                                },
                                {
                                    "bbox": [
                                        78,
                                        503,
                                        542,
                                        514
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                78,
                                                503,
                                                542,
                                                514
                                            ],
                                            "type": "text",
                                            "content": "Wen-tau Yih. REPLUG: Retrieval-augmented black-box language models. In Kevin Duh, Helena Gomez, and",
                                            "score": 1.0
                                        }
                                    ]
                                },
                                {
                                    "bbox": [
                                        78,
                                        514,
                                        542,
                                        526
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                78,
                                                514,
                                                542,
                                                526
                                            ],
                                            "type": "text",
                                            "content": "Steven Bethard, editors, Proceedings of the 2024 Conference of the North American Chapter of the Association",
                                            "score": 1.0
                                        }
                                    ]
                                },
                                {
                                    "bbox": [
                                        78,
                                        525,
                                        542,
                                        538
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                78,
                                                525,
                                                542,
                                                538
                                            ],
                                            "type": "text",
                                            "content": "for Computational Linguistics: Human Language Technologies (Volume 1: Long Papers), pages 83718384, Mexico",
                                            "score": 1.0
                                        }
                                    ]
                                },
                                {
                                    "bbox": [
                                        78,
                                        535,
                                        544,
                                        549
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                78,
                                                535,
                                                544,
                                                549
                                            ],
                                            "type": "text",
                                            "content": "City, Mexico, June 2024. Association for Computational Linguistics. doi: 10.18653/v1/2024.naacl-long.463. https:",
                                            "score": 1.0
                                        }
                                    ]
                                },
                                {
                                    "bbox": [
                                        78,
                                        547,
                                        247,
                                        558
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                78,
                                                547,
                                                247,
                                                558
                                            ],
                                            "type": "text",
                                            "content": "//aclanthology.org/2024.naacl-long.463/.",
                                            "score": 1.0
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "bbox": [
                                69,
                                564,
                                541,
                                586
                            ],
                            "type": "ref_text",
                            "angle": 0,
                            "index": 12,
                            "lines": [
                                {
                                    "bbox": [
                                        69,
                                        563,
                                        542,
                                        576
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                69,
                                                563,
                                                542,
                                                576
                                            ],
                                            "type": "text",
                                            "content": "Xiaoxiang Shi, Colin Cai, and Junjia Du. Proactive intra-gpu disaggregation of prefill and decode in llm serving, 2025.",
                                            "score": 1.0
                                        }
                                    ]
                                },
                                {
                                    "bbox": [
                                        78,
                                        575,
                                        221,
                                        586
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                78,
                                                575,
                                                221,
                                                586
                                            ],
                                            "type": "text",
                                            "content": "https://arxiv.org/abs/2507.06608.",
                                            "score": 1.0
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "bbox": [
                                69,
                                592,
                                541,
                                635
                            ],
                            "type": "ref_text",
                            "angle": 0,
                            "index": 13,
                            "lines": [
                                {
                                    "bbox": [
                                        67,
                                        590,
                                        542,
                                        604
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                67,
                                                590,
                                                542,
                                                604
                                            ],
                                            "type": "text",
                                            "content": "Daria Soboleva, Faisal Al-Khateeb, Robert Myers, Jacob R Steeves, Joel Hestness, and Nolan Dey. SlimPa-",
                                            "score": 1.0
                                        }
                                    ]
                                },
                                {
                                    "bbox": [
                                        77,
                                        602,
                                        542,
                                        615
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                77,
                                                602,
                                                401,
                                                614
                                            ],
                                            "type": "text",
                                            "content": "jama: A 627B token cleaned and deduplicated version of RedPajama.",
                                            "score": 1.0
                                        },
                                        {
                                            "bbox": [
                                                406,
                                                602,
                                                542,
                                                615
                                            ],
                                            "type": "text",
                                            "content": "https://www.cerebras.net/blog/",
                                            "score": 1.0
                                        }
                                    ]
                                },
                                {
                                    "bbox": [
                                        78,
                                        613,
                                        542,
                                        626
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                78,
                                                613,
                                                542,
                                                626
                                            ],
                                            "type": "text",
                                            "content": "slimpajama-a-627b-token-cleaned-and-deduplicated-version-of-redpajama, June 2023. https://huggingface.co/",
                                            "score": 1.0
                                        }
                                    ]
                                },
                                {
                                    "bbox": [
                                        79,
                                        625,
                                        233,
                                        636
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                79,
                                                625,
                                                233,
                                                636
                                            ],
                                            "type": "text",
                                            "content": "datasets/cerebras/SlimPajama-627B.",
                                            "score": 1.0
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "bbox": [
                                69,
                                642,
                                541,
                                674
                            ],
                            "type": "ref_text",
                            "angle": 0,
                            "index": 14,
                            "lines": [
                                {
                                    "bbox": [
                                        69,
                                        640,
                                        543,
                                        654
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                69,
                                                640,
                                                543,
                                                654
                                            ],
                                            "type": "text",
                                            "content": "Hugo Touvron, Louis Martin, Kevin Stone, Peter Albert, Amjad Almahairi, Yasmine Babaei, Nikolay Bashlykov,",
                                            "score": 1.0
                                        }
                                    ]
                                },
                                {
                                    "bbox": [
                                        78,
                                        653,
                                        543,
                                        665
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                78,
                                                653,
                                                543,
                                                665
                                            ],
                                            "type": "text",
                                            "content": "Soumya Batra, Prajjwal Bhargava, Shruti Bhosale, et al. Llama 2: Open foundation and fine-tuned chat models.",
                                            "score": 1.0
                                        }
                                    ]
                                },
                                {
                                    "bbox": [
                                        78,
                                        664,
                                        238,
                                        676
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                78,
                                                664,
                                                238,
                                                676
                                            ],
                                            "type": "text",
                                            "content": "arXiv preprint arXiv:2307.09288, 2023.",
                                            "score": 1.0
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "bbox": [
                                69,
                                681,
                                541,
                                713
                            ],
                            "type": "ref_text",
                            "angle": 0,
                            "index": 15,
                            "lines": [
                                {
                                    "bbox": [
                                        69,
                                        679,
                                        542,
                                        693
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                69,
                                                679,
                                                542,
                                                693
                                            ],
                                            "type": "text",
                                            "content": "Guangxuan Xiao, Yuandong Tian, Beidi Chen, Song Han, and Mike Lewis. Efficient streaming language models with",
                                            "score": 1.0
                                        }
                                    ]
                                },
                                {
                                    "bbox": [
                                        78,
                                        690,
                                        542,
                                        704
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                78,
                                                690,
                                                542,
                                                704
                                            ],
                                            "type": "text",
                                            "content": "attention sinks. In The Twelfth International Conference on Learning Representations, 2024. https://openreview.",
                                            "score": 1.0
                                        }
                                    ]
                                },
                                {
                                    "bbox": [
                                        78,
                                        704,
                                        199,
                                        713
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                78,
                                                704,
                                                199,
                                                713
                                            ],
                                            "type": "text",
                                            "content": "net/forum?id=NG7sS51zVF.",
                                            "score": 1.0
                                        }
                                    ]
                                }
                            ]
                        }
                    ],
                    "sub_type": "ref_text"
                }
            ],
            "discarded_blocks": [
                {
                    "bbox": [
                        299,
                        742,
                        311,
                        752
                    ],
                    "type": "page_number",
                    "angle": 0,
                    "index": 17,
                    "lines": [
                        {
                            "bbox": [
                                298,
                                742,
                                313,
                                755
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        298,
                                        742,
                                        313,
                                        755
                                    ],
                                    "type": "text",
                                    "content": "14",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                }
            ],
            "page_size": [
                612,
                792
            ],
            "page_idx": 13
        },
        {
            "para_blocks": [
                {
                    "bbox": [
                        69,
                        64,
                        542,
                        176
                    ],
                    "type": "list",
                    "angle": 0,
                    "index": 3,
                    "blocks": [
                        {
                            "bbox": [
                                69,
                                64,
                                542,
                                87
                            ],
                            "type": "ref_text",
                            "angle": 0,
                            "index": 0,
                            "lines": [
                                {
                                    "bbox": [
                                        69,
                                        64,
                                        542,
                                        78
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                69,
                                                64,
                                                542,
                                                78
                                            ],
                                            "type": "text",
                                            "content": "Howard Yen, Tianyu Gao, and Danqi Chen. Long-context language modeling with parallel context encoding. In",
                                            "score": 1.0
                                        }
                                    ]
                                },
                                {
                                    "bbox": [
                                        78,
                                        75,
                                        307,
                                        89
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                78,
                                                75,
                                                307,
                                                89
                                            ],
                                            "type": "text",
                                            "content": "Association for Computational Linguistics (ACL), 2024.",
                                            "score": 1.0
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "bbox": [
                                69,
                                92,
                                542,
                                115
                            ],
                            "type": "ref_text",
                            "angle": 0,
                            "index": 1,
                            "lines": [
                                {
                                    "bbox": [
                                        67,
                                        91,
                                        544,
                                        106
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                67,
                                                91,
                                                544,
                                                106
                                            ],
                                            "type": "text",
                                            "content": "Davis Yoshida, Allyson Ettinger, and Kevin Gimpel. Adding recurrence to pretrained transformers, 2021. https:",
                                            "score": 1.0
                                        }
                                    ]
                                },
                                {
                                    "bbox": [
                                        80,
                                        103,
                                        253,
                                        115
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                80,
                                                103,
                                                253,
                                                115
                                            ],
                                            "type": "text",
                                            "content": "//openreview.net/forum?id=taQNxF9Sj6.",
                                            "score": 1.0
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "bbox": [
                                69,
                                120,
                                542,
                                176
                            ],
                            "type": "ref_text",
                            "angle": 0,
                            "index": 2,
                            "lines": [
                                {
                                    "bbox": [
                                        69,
                                        120,
                                        542,
                                        133
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                69,
                                                120,
                                                542,
                                                133
                                            ],
                                            "type": "text",
                                            "content": "Yizhe Zhang, Siqi Sun, Michel Galley, Yen-Chun Chen, Chris Brockett, Xiang Gao, Jianfeng Gao, Jingjing Liu, and Bill",
                                            "score": 1.0
                                        }
                                    ]
                                },
                                {
                                    "bbox": [
                                        78,
                                        131,
                                        542,
                                        144
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                78,
                                                131,
                                                542,
                                                144
                                            ],
                                            "type": "text",
                                            "content": "Dolan. DIALOGPT : Large-scale generative pre-training for conversational response generation. In Asli Celikyilmaz",
                                            "score": 1.0
                                        }
                                    ]
                                },
                                {
                                    "bbox": [
                                        78,
                                        143,
                                        542,
                                        156
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                78,
                                                143,
                                                542,
                                                156
                                            ],
                                            "type": "text",
                                            "content": "and Tsung-Hsien Wen, editors, Proceedings of the 58th Annual Meeting of the Association for Computational",
                                            "score": 1.0
                                        }
                                    ]
                                },
                                {
                                    "bbox": [
                                        78,
                                        152,
                                        544,
                                        166
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                78,
                                                152,
                                                544,
                                                166
                                            ],
                                            "type": "text",
                                            "content": "Linguistics: System Demonstrations, pages 270278, Online, July 2020. Association for Computational Linguistics.",
                                            "score": 1.0
                                        }
                                    ]
                                },
                                {
                                    "bbox": [
                                        77,
                                        163,
                                        445,
                                        178
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                77,
                                                163,
                                                445,
                                                178
                                            ],
                                            "type": "text",
                                            "content": "doi: 10.18653/v1/2020.acldemos.30. https://aclanthology.org/2020.acldemos.30/.",
                                            "score": 1.0
                                        }
                                    ]
                                }
                            ]
                        }
                    ],
                    "sub_type": "ref_text"
                }
            ],
            "discarded_blocks": [
                {
                    "bbox": [
                        300,
                        742,
                        311,
                        751
                    ],
                    "type": "page_number",
                    "angle": 0,
                    "index": 4,
                    "lines": [
                        {
                            "bbox": [
                                299,
                                742,
                                313,
                                755
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        299,
                                        742,
                                        313,
                                        755
                                    ],
                                    "type": "text",
                                    "content": "15",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                }
            ],
            "page_size": [
                612,
                792
            ],
            "page_idx": 14
        },
        {
            "para_blocks": [
                {
                    "bbox": [
                        67,
                        60,
                        153,
                        80
                    ],
                    "type": "title",
                    "angle": 0,
                    "index": 0,
                    "lines": [
                        {
                            "bbox": [
                                66,
                                58,
                                156,
                                83
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        66,
                                        58,
                                        156,
                                        83
                                    ],
                                    "type": "text",
                                    "content": "Appendix",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                },
                {
                    "bbox": [
                        67,
                        97,
                        222,
                        110
                    ],
                    "type": "title",
                    "angle": 0,
                    "index": 1,
                    "lines": [
                        {
                            "bbox": [
                                67,
                                95,
                                223,
                                114
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        95,
                                        223,
                                        114
                                    ],
                                    "type": "text",
                                    "content": "A Additional Discussion",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                },
                {
                    "bbox": [
                        67,
                        122,
                        543,
                        266
                    ],
                    "type": "text",
                    "angle": 0,
                    "index": 2,
                    "lines": [
                        {
                            "bbox": [
                                69,
                                123,
                                543,
                                136
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        123,
                                        469,
                                        136
                                    ],
                                    "type": "text",
                                    "content": "Analysis on latency and throughput improvement. We denote the following parameters:",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        470,
                                        128,
                                        474,
                                        133
                                    ],
                                    "type": "inline_equation",
                                    "content": "s",
                                    "score": 0.78
                                },
                                {
                                    "bbox": [
                                        474,
                                        123,
                                        543,
                                        136
                                    ],
                                    "type": "text",
                                    "content": "as the context",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                68,
                                135,
                                543,
                                148
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        135,
                                        104,
                                        148
                                    ],
                                    "type": "text",
                                    "content": "length,",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        105,
                                        140,
                                        110,
                                        144
                                    ],
                                    "type": "inline_equation",
                                    "content": "o",
                                    "score": 0.77
                                },
                                {
                                    "bbox": [
                                        110,
                                        135,
                                        212,
                                        148
                                    ],
                                    "type": "text",
                                    "content": "as the output length,",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        212,
                                        137,
                                        217,
                                        144
                                    ],
                                    "type": "inline_equation",
                                    "content": "b",
                                    "score": 0.8
                                },
                                {
                                    "bbox": [
                                        217,
                                        135,
                                        302,
                                        148
                                    ],
                                    "type": "text",
                                    "content": "as the batch size,",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        302,
                                        137,
                                        308,
                                        144
                                    ],
                                    "type": "inline_equation",
                                    "content": "d",
                                    "score": 0.88
                                },
                                {
                                    "bbox": [
                                        308,
                                        135,
                                        506,
                                        148
                                    ],
                                    "type": "text",
                                    "content": "as the dimensionality of the hidden states,",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        506,
                                        137,
                                        510,
                                        144
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\it { \\Delta } l",
                                    "score": 0.87
                                },
                                {
                                    "bbox": [
                                        510,
                                        135,
                                        543,
                                        148
                                    ],
                                    "type": "text",
                                    "content": "as the",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                68,
                                147,
                                543,
                                159
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        147,
                                        238,
                                        159
                                    ],
                                    "type": "text",
                                    "content": "number of layers in the decoder, and",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        239,
                                        152,
                                        245,
                                        156
                                    ],
                                    "type": "inline_equation",
                                    "content": "n",
                                    "score": 0.88
                                },
                                {
                                    "bbox": [
                                        245,
                                        147,
                                        543,
                                        159
                                    ],
                                    "type": "text",
                                    "content": "as the number of model parameters. The flop rate of the GPU is",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                70,
                                158,
                                544,
                                171
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        161,
                                        76,
                                        171
                                    ],
                                    "type": "inline_equation",
                                    "content": "f",
                                    "score": 0.89
                                },
                                {
                                    "bbox": [
                                        77,
                                        158,
                                        296,
                                        171
                                    ],
                                    "type": "text",
                                    "content": ", and the high bandwidth memory of the GPU is",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        296,
                                        163,
                                        305,
                                        168
                                    ],
                                    "type": "inline_equation",
                                    "content": "m",
                                    "score": 0.89
                                },
                                {
                                    "bbox": [
                                        306,
                                        158,
                                        466,
                                        171
                                    ],
                                    "type": "text",
                                    "content": "and we use the compression rate of",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        467,
                                        161,
                                        473,
                                        168
                                    ],
                                    "type": "inline_equation",
                                    "content": "k",
                                    "score": 0.9
                                },
                                {
                                    "bbox": [
                                        473,
                                        158,
                                        544,
                                        171
                                    ],
                                    "type": "text",
                                    "content": "in our encoder.",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                68,
                                170,
                                543,
                                185
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        170,
                                        543,
                                        185
                                    ],
                                    "type": "text",
                                    "content": "We assume that all our chunk embeddings are precomputed and cached. The model is loaded with bfloat16",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                182,
                                544,
                                195
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        182,
                                        544,
                                        195
                                    ],
                                    "type": "text",
                                    "content": "precision. We focus our analysis on LLaMA-2-7B model. The results should be generalizable to other models.",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                69,
                                194,
                                543,
                                208
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        194,
                                        543,
                                        208
                                    ],
                                    "type": "text",
                                    "content": "We use the following metrics: TTFT which is the latency for the system to generate the first token; TTIT",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                206,
                                543,
                                220
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        206,
                                        543,
                                        220
                                    ],
                                    "type": "text",
                                    "content": "which is the time that it takes to generate iterative token after the first token; Throughput which is the",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                69,
                                218,
                                543,
                                231
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        218,
                                        543,
                                        231
                                    ],
                                    "type": "text",
                                    "content": "number of tokens that are generated from the system in a unit time. Table 6 shows that with short context",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                68,
                                231,
                                543,
                                243
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        231,
                                        211,
                                        243
                                    ],
                                    "type": "text",
                                    "content": "length s we are able to achieve",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        211,
                                        233,
                                        224,
                                        241
                                    ],
                                    "type": "inline_equation",
                                    "content": "k \\times",
                                    "score": 0.88
                                },
                                {
                                    "bbox": [
                                        225,
                                        231,
                                        375,
                                        243
                                    ],
                                    "type": "text",
                                    "content": "acceleration in TTFT and up to",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        375,
                                        233,
                                        388,
                                        241
                                    ],
                                    "type": "inline_equation",
                                    "content": "k \\times",
                                    "score": 0.88
                                },
                                {
                                    "bbox": [
                                        388,
                                        231,
                                        543,
                                        243
                                    ],
                                    "type": "text",
                                    "content": "acceleration in throughput. With",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                68,
                                243,
                                543,
                                255
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        243,
                                        166,
                                        255
                                    ],
                                    "type": "text",
                                    "content": "longer context length",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        167,
                                        247,
                                        171,
                                        252
                                    ],
                                    "type": "inline_equation",
                                    "content": "s",
                                    "score": 0.74
                                },
                                {
                                    "bbox": [
                                        171,
                                        243,
                                        303,
                                        255
                                    ],
                                    "type": "text",
                                    "content": ", we are able to achieve up to",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        303,
                                        244,
                                        321,
                                        253
                                    ],
                                    "type": "inline_equation",
                                    "content": "k ^ { 2 } \\times",
                                    "score": 0.91
                                },
                                {
                                    "bbox": [
                                        321,
                                        243,
                                        543,
                                        255
                                    ],
                                    "type": "text",
                                    "content": "acceleration in both TTFT and throughput. The",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                69,
                                254,
                                370,
                                266
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        254,
                                        370,
                                        266
                                    ],
                                    "type": "text",
                                    "content": "details on the latency and throughput calculation are in section B.4.",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                },
                {
                    "bbox": [
                        67,
                        280,
                        543,
                        425
                    ],
                    "type": "text",
                    "angle": 0,
                    "index": 3,
                    "lines": [
                        {
                            "bbox": [
                                69,
                                280,
                                543,
                                293
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        280,
                                        543,
                                        293
                                    ],
                                    "type": "text",
                                    "content": "Empirical verification of latency/throughput improvement. Figure 2 shows the empirical measurement of",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                69,
                                292,
                                543,
                                304
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        292,
                                        543,
                                        304
                                    ],
                                    "type": "text",
                                    "content": "the acceleration of REFRAG compared with CEPE, a previous work that achieves significant acceleration",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                303,
                                542,
                                316
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        303,
                                        542,
                                        316
                                    ],
                                    "type": "text",
                                    "content": "in inference (Yen et al., 2024). Under the context length of 16384 (i.e., mid-to-long context), REFRAG",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                316,
                                543,
                                329
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        316,
                                        108,
                                        329
                                    ],
                                    "type": "text",
                                    "content": "achieves",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        109,
                                        318,
                                        140,
                                        327
                                    ],
                                    "type": "inline_equation",
                                    "content": "1 6 . 5 3 \\times",
                                    "score": 0.62
                                },
                                {
                                    "bbox": [
                                        141,
                                        316,
                                        543,
                                        329
                                    ],
                                    "type": "text",
                                    "content": "acceleration in TTFT with cache and 8.59 without cache. Both higher than CEPE (i.e.,",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                327,
                                543,
                                342
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        327,
                                        87,
                                        342
                                    ],
                                    "type": "text",
                                    "content": "2.01",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        88,
                                        332,
                                        95,
                                        338
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\times",
                                    "score": 0.66
                                },
                                {
                                    "bbox": [
                                        95,
                                        327,
                                        117,
                                        342
                                    ],
                                    "type": "text",
                                    "content": "and",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        117,
                                        331,
                                        143,
                                        339
                                    ],
                                    "type": "inline_equation",
                                    "content": "1 . 0 4 \\times",
                                    "score": 0.61
                                },
                                {
                                    "bbox": [
                                        143,
                                        327,
                                        543,
                                        342
                                    ],
                                    "type": "text",
                                    "content": "acceleration respectively) while having better model performance (see table 1). With longer",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                339,
                                542,
                                352
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        339,
                                        231,
                                        352
                                    ],
                                    "type": "text",
                                    "content": "context, we are able to achieve up to",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        231,
                                        340,
                                        263,
                                        351
                                    ],
                                    "type": "inline_equation",
                                    "content": "3 2 . 9 9 \\times",
                                    "score": 0.82
                                },
                                {
                                    "bbox": [
                                        263,
                                        339,
                                        542,
                                        352
                                    ],
                                    "type": "text",
                                    "content": "acceleration in TTFT. The reason why we get such acceleration",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                351,
                                543,
                                365
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        351,
                                        543,
                                        365
                                    ],
                                    "type": "text",
                                    "content": "even without cache is that the encoder is light-weight (e.g., Roberta-large is 355M-sized) and the chunks",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                364,
                                543,
                                376
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        364,
                                        459,
                                        376
                                    ],
                                    "type": "text",
                                    "content": "are processed parallel without attending to each other. In terms of TTIT, we achieve",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        459,
                                        367,
                                        472,
                                        375
                                    ],
                                    "type": "inline_equation",
                                    "content": "3 \\times",
                                    "score": 0.76
                                },
                                {
                                    "bbox": [
                                        473,
                                        364,
                                        543,
                                        376
                                    ],
                                    "type": "text",
                                    "content": "acceleration in",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                68,
                                376,
                                543,
                                388
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        376,
                                        543,
                                        388
                                    ],
                                    "type": "text",
                                    "content": "long context scenario in both cached and not cached scenarios. This is expected since they have the same",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                68,
                                388,
                                543,
                                400
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        388,
                                        543,
                                        400
                                    ],
                                    "type": "text",
                                    "content": "number of KV caches to attend to. However, CEPE is worse than original LLaMA in TTIT since it require",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                69,
                                399,
                                543,
                                412
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        399,
                                        514,
                                        412
                                    ],
                                    "type": "text",
                                    "content": "the additional computation of KV cache projection in the inference time. Overall we achieve upto 6.78",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        514,
                                        403,
                                        521,
                                        411
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\times",
                                    "score": 0.69
                                },
                                {
                                    "bbox": [
                                        522,
                                        399,
                                        543,
                                        412
                                    ],
                                    "type": "text",
                                    "content": "and",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                70,
                                411,
                                454,
                                425
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        415,
                                        96,
                                        422
                                    ],
                                    "type": "inline_equation",
                                    "content": "6 . 0 6 \\times",
                                    "score": 0.56
                                },
                                {
                                    "bbox": [
                                        88,
                                        415,
                                        96,
                                        422
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\times",
                                    "score": 0.52
                                },
                                {
                                    "bbox": [
                                        96,
                                        411,
                                        454,
                                        425
                                    ],
                                    "type": "text",
                                    "content": "acceleration in throughput much higher than CEPE in the long context scenario.",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "table",
                    "bbox": [
                        132,
                        432,
                        479,
                        506
                    ],
                    "blocks": [
                        {
                            "bbox": [
                                132,
                                432,
                                479,
                                506
                            ],
                            "lines": [
                                {
                                    "bbox": [
                                        132,
                                        432,
                                        479,
                                        506
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                132,
                                                432,
                                                479,
                                                506
                                            ],
                                            "type": "table",
                                            "html": "<table><tr><td></td><td>Acceleration/Save</td><td>Short s</td><td>Long s</td></tr><tr><td>KV cache memory</td><td>ks+ko/s+ko</td><td>1 ~ k</td><td>k</td></tr><tr><td>TTFT</td><td>k2(6ds+s2)/6dsk+s2</td><td>k</td><td>k2</td></tr><tr><td>TTIT</td><td>2dlbsk+nk+2dlbok/2dlbs+nk+2dlbok</td><td>1</td><td>k</td></tr><tr><td>Throughput</td><td>k*TTFT+k*TITT/TFT+kTTIT</td><td>1 ~ k</td><td>k ~ k2</td></tr></table>",
                                            "image_path": "710aac01ff4cd36ef00e65ccf583dc8e7e7bad0a851846b6003c0728c74779c5.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 4,
                            "angle": 0,
                            "type": "table_body"
                        },
                        {
                            "bbox": [
                                67,
                                513,
                                504,
                                525
                            ],
                            "lines": [
                                {
                                    "bbox": [
                                        69,
                                        512,
                                        504,
                                        525
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                69,
                                                512,
                                                504,
                                                525
                                            ],
                                            "type": "text",
                                            "content": "Table 6 The acceleration in latency/save in memory of REFRAG compared to the original LLaMA model.",
                                            "score": 1.0
                                        }
                                    ]
                                }
                            ],
                            "index": 5,
                            "angle": 0,
                            "type": "table_caption"
                        }
                    ],
                    "index": 4
                },
                {
                    "bbox": [
                        67,
                        546,
                        308,
                        560
                    ],
                    "type": "title",
                    "angle": 0,
                    "index": 6,
                    "lines": [
                        {
                            "bbox": [
                                67,
                                544,
                                309,
                                563
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        544,
                                        309,
                                        563
                                    ],
                                    "type": "text",
                                    "content": "A.1 Modeling REFRAG Selective Compression",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                },
                {
                    "bbox": [
                        67,
                        565,
                        542,
                        613
                    ],
                    "type": "text",
                    "angle": 0,
                    "index": 7,
                    "lines": [
                        {
                            "bbox": [
                                67,
                                565,
                                542,
                                578
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        565,
                                        542,
                                        578
                                    ],
                                    "type": "text",
                                    "content": "In this section, we introduce selective token compression, based on the hypothesis that different context",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                577,
                                543,
                                591
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        577,
                                        543,
                                        591
                                    ],
                                    "type": "text",
                                    "content": "segments contribute unequally to answer prediction. Less critical segments are compressed, while essential",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                68,
                                590,
                                542,
                                603
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        590,
                                        542,
                                        603
                                    ],
                                    "type": "text",
                                    "content": "ones remain intact, as illustrated in figure 5. We employ RL to train a policy that optimally determines which",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                68,
                                603,
                                168,
                                614
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        603,
                                        168,
                                        614
                                    ],
                                    "type": "text",
                                    "content": "segments to compress.",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                },
                {
                    "bbox": [
                        67,
                        620,
                        542,
                        680
                    ],
                    "type": "text",
                    "angle": 0,
                    "index": 8,
                    "lines": [
                        {
                            "bbox": [
                                69,
                                620,
                                542,
                                632
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        620,
                                        542,
                                        632
                                    ],
                                    "type": "text",
                                    "content": "To enable selective compression, we continue pretraining the encoder and decoder to process a combination",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                68,
                                631,
                                542,
                                645
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        631,
                                        299,
                                        645
                                    ],
                                    "type": "text",
                                    "content": "of token and chunk embeddings. Given a context of",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        299,
                                        637,
                                        304,
                                        641
                                    ],
                                    "type": "inline_equation",
                                    "content": "s",
                                    "score": 0.88
                                },
                                {
                                    "bbox": [
                                        304,
                                        631,
                                        339,
                                        645
                                    ],
                                    "type": "text",
                                    "content": "tokens",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        339,
                                        637,
                                        381,
                                        643
                                    ],
                                    "type": "inline_equation",
                                    "content": "x _ { 1 } , \\ldots , x _ { s }",
                                    "score": 0.91
                                },
                                {
                                    "bbox": [
                                        381,
                                        631,
                                        446,
                                        645
                                    ],
                                    "type": "text",
                                    "content": ", chunked into",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        446,
                                        634,
                                        453,
                                        641
                                    ],
                                    "type": "inline_equation",
                                    "content": "L",
                                    "score": 0.9
                                },
                                {
                                    "bbox": [
                                        453,
                                        631,
                                        542,
                                        645
                                    ],
                                    "type": "text",
                                    "content": "fixed-length chunks",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                70,
                                643,
                                543,
                                657
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        646,
                                        117,
                                        655
                                    ],
                                    "type": "inline_equation",
                                    "content": "C _ { 1 } , \\dots , C _ { L }",
                                    "score": 0.93
                                },
                                {
                                    "bbox": [
                                        118,
                                        643,
                                        291,
                                        657
                                    ],
                                    "type": "text",
                                    "content": ", we achieve a compression fraction of",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        291,
                                        647,
                                        315,
                                        655
                                    ],
                                    "type": "inline_equation",
                                    "content": "1 - p",
                                    "score": 0.93
                                },
                                {
                                    "bbox": [
                                        315,
                                        643,
                                        419,
                                        657
                                    ],
                                    "type": "text",
                                    "content": "by randomly selecting",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        420,
                                        645,
                                        459,
                                        655
                                    ],
                                    "type": "inline_equation",
                                    "content": "T ^ { \\prime } : = p L",
                                    "score": 0.94
                                },
                                {
                                    "bbox": [
                                        460,
                                        643,
                                        543,
                                        657
                                    ],
                                    "type": "text",
                                    "content": "chunks to remain",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                69,
                                655,
                                543,
                                669
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        655,
                                        543,
                                        669
                                    ],
                                    "type": "text",
                                    "content": "uncompressed for the decoder. This pretraining allows the model to effectively handle mixed inputs at",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                666,
                                404,
                                681
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        666,
                                        404,
                                        681
                                    ],
                                    "type": "text",
                                    "content": "arbitrary positions, which is essential for the subsequent RL policy learning.",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                },
                {
                    "bbox": [
                        67,
                        684,
                        541,
                        715
                    ],
                    "type": "text",
                    "angle": 0,
                    "index": 9,
                    "lines": [
                        {
                            "bbox": [
                                67,
                                681,
                                543,
                                701
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        681,
                                        162,
                                        701
                                    ],
                                    "type": "text",
                                    "content": "We sequentially pick",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        162,
                                        687,
                                        172,
                                        695
                                    ],
                                    "type": "inline_equation",
                                    "content": "T ^ { \\prime }",
                                    "score": 0.9
                                },
                                {
                                    "bbox": [
                                        172,
                                        681,
                                        237,
                                        701
                                    ],
                                    "type": "text",
                                    "content": "chunk indices",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        237,
                                        685,
                                        285,
                                        699
                                    ],
                                    "type": "inline_equation",
                                    "content": "l = \\{ l _ { j } \\} _ { j = 1 } ^ { T ^ { \\prime } }",
                                    "score": 0.94
                                },
                                {
                                    "bbox": [
                                        285,
                                        681,
                                        319,
                                        701
                                    ],
                                    "type": "text",
                                    "content": ", where",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        320,
                                        687,
                                        351,
                                        697
                                    ],
                                    "type": "inline_equation",
                                    "content": "l _ { t } \\in [ L ]",
                                    "score": 0.94
                                },
                                {
                                    "bbox": [
                                        351,
                                        681,
                                        472,
                                        701
                                    ],
                                    "type": "text",
                                    "content": ". The input arrangement is",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        473,
                                        685,
                                        543,
                                        699
                                    ],
                                    "type": "inline_equation",
                                    "content": "E ( x , \\{ l _ { j } \\} _ { j = 1 } ^ { T ^ { \\prime } } ) =",
                                    "score": 0.93
                                }
                            ]
                        },
                        {
                            "bbox": [
                                70,
                                696,
                                541,
                                716
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        701,
                                        127,
                                        712
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\{ E _ { 1 } , \\dots , E _ { L } \\}",
                                    "score": 0.94
                                },
                                {
                                    "bbox": [
                                        127,
                                        696,
                                        158,
                                        716
                                    ],
                                    "type": "text",
                                    "content": ", with",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        159,
                                        700,
                                        205,
                                        712
                                    ],
                                    "type": "inline_equation",
                                    "content": "E _ { i } = { \\bf e } _ { i } ^ { \\mathrm { c n k } }",
                                    "score": 0.93
                                },
                                {
                                    "bbox": [
                                        205,
                                        696,
                                        219,
                                        716
                                    ],
                                    "type": "text",
                                    "content": "if",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        219,
                                        700,
                                        270,
                                        713
                                    ],
                                    "type": "inline_equation",
                                    "content": "i \\not \\in \\{ l _ { j } \\} _ { j = 1 } ^ { T ^ { \\prime } }",
                                    "score": 0.92
                                },
                                {
                                    "bbox": [
                                        270,
                                        696,
                                        360,
                                        716
                                    ],
                                    "type": "text",
                                    "content": "(compressed), and",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        360,
                                        701,
                                        476,
                                        712
                                    ],
                                    "type": "inline_equation",
                                    "content": "E _ { i } = \\{ \\mathbf { e } _ { k * i } , \\dots , \\mathbf { e } _ { k * i + k - 1 } \\}",
                                    "score": 0.92
                                },
                                {
                                    "bbox": [
                                        476,
                                        696,
                                        489,
                                        716
                                    ],
                                    "type": "text",
                                    "content": "if",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        490,
                                        700,
                                        541,
                                        713
                                    ],
                                    "type": "inline_equation",
                                    "content": "i \\in \\{ l _ { j } \\} _ { j = 1 } ^ { T ^ { \\prime } }",
                                    "score": 0.91
                                }
                            ]
                        }
                    ]
                }
            ],
            "discarded_blocks": [
                {
                    "bbox": [
                        299,
                        742,
                        311,
                        752
                    ],
                    "type": "page_number",
                    "angle": 0,
                    "index": 10,
                    "lines": [
                        {
                            "bbox": [
                                298,
                                742,
                                313,
                                754
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        298,
                                        742,
                                        313,
                                        754
                                    ],
                                    "type": "text",
                                    "content": "16",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                }
            ],
            "page_size": [
                612,
                792
            ],
            "page_idx": 15
        },
        {
            "para_blocks": [
                {
                    "bbox": [
                        66,
                        64,
                        544,
                        123
                    ],
                    "type": "text",
                    "angle": 0,
                    "index": 0,
                    "lines": [
                        {
                            "bbox": [
                                68,
                                64,
                                543,
                                78
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        64,
                                        334,
                                        78
                                    ],
                                    "type": "text",
                                    "content": "(uncompressed). This arrangement is input to the decoder",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        335,
                                        67,
                                        358,
                                        76
                                    ],
                                    "type": "inline_equation",
                                    "content": "{ \\mathcal { M } } _ { \\mathrm { d e c } }",
                                    "score": 0.92
                                },
                                {
                                    "bbox": [
                                        359,
                                        64,
                                        409,
                                        78
                                    ],
                                    "type": "text",
                                    "content": "to predict",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        409,
                                        69,
                                        446,
                                        76
                                    ],
                                    "type": "inline_equation",
                                    "content": "x _ { s + 1 : s + o }",
                                    "score": 0.89
                                },
                                {
                                    "bbox": [
                                        446,
                                        64,
                                        543,
                                        78
                                    ],
                                    "type": "text",
                                    "content": ". The decoders auto-",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                76,
                                543,
                                89
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        76,
                                        543,
                                        89
                                    ],
                                    "type": "text",
                                    "content": "regressive property is maintained, and compression can be applied at any position within the input, not just",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                87,
                                541,
                                100
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        87,
                                        463,
                                        100
                                    ],
                                    "type": "text",
                                    "content": "at the beginning. Within our selective compression framework, the objective is to choose",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        463,
                                        91,
                                        473,
                                        98
                                    ],
                                    "type": "inline_equation",
                                    "content": "T ^ { \\prime }",
                                    "score": 0.91
                                },
                                {
                                    "bbox": [
                                        474,
                                        87,
                                        533,
                                        100
                                    ],
                                    "type": "text",
                                    "content": "chunks from",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        533,
                                        91,
                                        541,
                                        98
                                    ],
                                    "type": "inline_equation",
                                    "content": "L",
                                    "score": 0.89
                                }
                            ]
                        },
                        {
                            "bbox": [
                                68,
                                99,
                                541,
                                112
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        99,
                                        541,
                                        112
                                    ],
                                    "type": "text",
                                    "content": "total chunks to maximize a specified reward. Formally, this can be expressed as the following combinatorial",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                68,
                                112,
                                168,
                                124
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        112,
                                        168,
                                        124
                                    ],
                                    "type": "text",
                                    "content": "optimization problem:",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                },
                {
                    "bbox": [
                        242,
                        123,
                        365,
                        136
                    ],
                    "type": "interline_equation",
                    "angle": 0,
                    "lines": [
                        {
                            "bbox": [
                                242,
                                123,
                                365,
                                136
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        242,
                                        123,
                                        365,
                                        136
                                    ],
                                    "type": "interline_equation",
                                    "content": "\\text {G i v e n} [ L ] := \\{1, 2, \\dots , L \\},",
                                    "image_path": "a218944a9cb5b114bdc887f325c7ba8dc94f13d28ea4eb0e84abcb0ff13976ef.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 1
                },
                {
                    "bbox": [
                        263,
                        138,
                        319,
                        157
                    ],
                    "type": "interline_equation",
                    "angle": 0,
                    "lines": [
                        {
                            "bbox": [
                                263,
                                138,
                                319,
                                157
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        263,
                                        138,
                                        319,
                                        157
                                    ],
                                    "type": "interline_equation",
                                    "content": "\\max  _ {l \\subseteq [ L ]} r (x, l)",
                                    "image_path": "4eee1de41606287a7e1e0a7f64dbd4453b312eae6b20729b4ef930740983ee71.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 2
                },
                {
                    "bbox": [
                        268,
                        159,
                        326,
                        172
                    ],
                    "type": "interline_equation",
                    "angle": 0,
                    "lines": [
                        {
                            "bbox": [
                                268,
                                159,
                                326,
                                172
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        268,
                                        159,
                                        326,
                                        172
                                    ],
                                    "type": "interline_equation",
                                    "content": "\\mathrm {s . t .} \\quad | l | = T ^ {\\prime}",
                                    "image_path": "85005fb8585deb51577919302916ee39bd86bd27a14e16dfa63e0ccfa7d3025c.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 3
                },
                {
                    "bbox": [
                        66,
                        175,
                        544,
                        248
                    ],
                    "type": "text",
                    "angle": 0,
                    "index": 4,
                    "lines": [
                        {
                            "bbox": [
                                68,
                                174,
                                544,
                                189
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        174,
                                        544,
                                        189
                                    ],
                                    "type": "text",
                                    "content": "This problem is non-differentiable due to its discrete nature, and exact solutions are NP-hard. Consequently,",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                186,
                                543,
                                201
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        186,
                                        543,
                                        201
                                    ],
                                    "type": "text",
                                    "content": "prior work has proposed greedy approaches that incrementally construct solutions by modeling the task as a",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                68,
                                199,
                                542,
                                212
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        199,
                                        542,
                                        212
                                    ],
                                    "type": "text",
                                    "content": "sequential decision-making problem (Dai et al., 2017; Bello et al., 2017). These studies show that such greedy",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                209,
                                544,
                                225
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        209,
                                        544,
                                        225
                                    ],
                                    "type": "text",
                                    "content": "formulations enable the use of RL to achieve near-optimal solutions and generalize well across diverse settings.",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                221,
                                543,
                                236
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        221,
                                        543,
                                        236
                                    ],
                                    "type": "text",
                                    "content": "Motivated by these findings, we adopt a sequential formulation for selective compression and employ RL to",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                68,
                                234,
                                241,
                                247
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        234,
                                        241,
                                        247
                                    ],
                                    "type": "text",
                                    "content": "train an effective policy (see section 2).",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                },
                {
                    "bbox": [
                        67,
                        251,
                        543,
                        277
                    ],
                    "type": "text",
                    "angle": 0,
                    "index": 5,
                    "lines": [
                        {
                            "bbox": [
                                67,
                                251,
                                544,
                                267
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        251,
                                        186,
                                        267
                                    ],
                                    "type": "text",
                                    "content": "We learn a policy network",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        186,
                                        258,
                                        197,
                                        264
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\pi \\theta",
                                    "score": 0.9
                                },
                                {
                                    "bbox": [
                                        197,
                                        251,
                                        329,
                                        267
                                    ],
                                    "type": "text",
                                    "content": "that takes chunk embeddings",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        329,
                                        254,
                                        361,
                                        265
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\{ { \\bf c } _ { i } \\} _ { i = 1 } ^ { L }",
                                    "score": 0.94
                                },
                                {
                                    "bbox": [
                                        362,
                                        251,
                                        468,
                                        267
                                    ],
                                    "type": "text",
                                    "content": "and sequentially selects",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        469,
                                        255,
                                        479,
                                        262
                                    ],
                                    "type": "inline_equation",
                                    "content": "T ^ { \\prime }",
                                    "score": 0.91
                                },
                                {
                                    "bbox": [
                                        479,
                                        251,
                                        544,
                                        267
                                    ],
                                    "type": "text",
                                    "content": "chunk indices",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                70,
                                264,
                                343,
                                277
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        267,
                                        111,
                                        277
                                    ],
                                    "type": "inline_equation",
                                    "content": "l _ { 1 } , \\ldots , l _ { T ^ { \\prime } }",
                                    "score": 0.93
                                },
                                {
                                    "bbox": [
                                        112,
                                        264,
                                        146,
                                        277
                                    ],
                                    "type": "text",
                                    "content": ", where",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        146,
                                        266,
                                        178,
                                        277
                                    ],
                                    "type": "inline_equation",
                                    "content": "l _ { t } \\in [ L ]",
                                    "score": 0.94
                                },
                                {
                                    "bbox": [
                                        178,
                                        264,
                                        224,
                                        277
                                    ],
                                    "type": "text",
                                    "content": ". At stage",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        225,
                                        268,
                                        228,
                                        274
                                    ],
                                    "type": "inline_equation",
                                    "content": "t",
                                    "score": 0.87
                                },
                                {
                                    "bbox": [
                                        229,
                                        264,
                                        343,
                                        277
                                    ],
                                    "type": "text",
                                    "content": ", the policy samples from:",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                },
                {
                    "bbox": [
                        144,
                        281,
                        465,
                        311
                    ],
                    "type": "interline_equation",
                    "angle": 0,
                    "lines": [
                        {
                            "bbox": [
                                144,
                                281,
                                465,
                                311
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        144,
                                        281,
                                        465,
                                        311
                                    ],
                                    "type": "interline_equation",
                                    "content": "\\pi_ {\\theta} (l _ {t} = i | x, \\{l _ {j} \\} _ {j = 1} ^ {t - 1}) := \\pi_ {\\theta} (l _ {t} = i | \\{\\mathbf {c} _ {j} \\} _ {j = 1} ^ {L}, \\{l _ {j} \\} _ {j = 1} ^ {t - 1}) = \\frac {\\exp (\\mathbf {s} _ {i} - \\mathbf {n} _ {i})}{\\sum_ {j = 1} ^ {L} \\exp (\\mathbf {s} _ {j} - \\mathbf {n} _ {j})}.",
                                    "image_path": "29bf24ec60af2deca825efad17554d4652f0eb5f3b4024ac1f93544811ea3997.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 6
                },
                {
                    "bbox": [
                        66,
                        315,
                        544,
                        367
                    ],
                    "type": "text",
                    "angle": 0,
                    "index": 7,
                    "lines": [
                        {
                            "bbox": [
                                66,
                                312,
                                544,
                                334
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        66,
                                        312,
                                        100,
                                        334
                                    ],
                                    "type": "text",
                                    "content": "where",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        100,
                                        321,
                                        138,
                                        328
                                    ],
                                    "type": "inline_equation",
                                    "content": "{ \\mathrm { I I } } _ { j } ~ = ~ \\infty",
                                    "score": 0.9
                                },
                                {
                                    "bbox": [
                                        138,
                                        312,
                                        155,
                                        334
                                    ],
                                    "type": "text",
                                    "content": "iff",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        155,
                                        316,
                                        206,
                                        328
                                    ],
                                    "type": "inline_equation",
                                    "content": "j \\in \\{ l _ { i } \\} _ { i = 1 } ^ { t - 1 }",
                                    "score": 0.94
                                },
                                {
                                    "bbox": [
                                        206,
                                        312,
                                        294,
                                        334
                                    ],
                                    "type": "text",
                                    "content": "and 0 otherwise4;",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        294,
                                        318,
                                        409,
                                        332
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathbf { s } ~ = ~ g _ { \\theta } ( \\{ \\mathbf { c } _ { i } \\} _ { i \\in [ L ] , i \\not \\in \\{ l _ { j } \\} _ { \\underline { { { i } } } = 1 } ^ { t - 1 } } )",
                                    "score": 0.91
                                },
                                {
                                    "bbox": [
                                        409,
                                        312,
                                        544,
                                        334
                                    ],
                                    "type": "text",
                                    "content": "is the output of a two-layer",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                68,
                                329,
                                543,
                                343
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        329,
                                        339,
                                        343
                                    ],
                                    "type": "text",
                                    "content": "transformer network over chunk embeddings, producing logit",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        339,
                                        335,
                                        347,
                                        341
                                    ],
                                    "type": "inline_equation",
                                    "content": "{ \\bf s } _ { i }",
                                    "score": 0.85
                                },
                                {
                                    "bbox": [
                                        348,
                                        329,
                                        543,
                                        343
                                    ],
                                    "type": "text",
                                    "content": "for each chunk. In practice, we reuse chunk",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                340,
                                544,
                                356
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        340,
                                        123,
                                        356
                                    ],
                                    "type": "text",
                                    "content": "embeddings",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        123,
                                        343,
                                        155,
                                        354
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\{ { \\bf c } _ { i } \\} _ { i = 1 } ^ { L }",
                                    "score": 0.94
                                },
                                {
                                    "bbox": [
                                        156,
                                        340,
                                        372,
                                        356
                                    ],
                                    "type": "text",
                                    "content": "as transformer input and do not recompute logits",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        373,
                                        347,
                                        381,
                                        353
                                    ],
                                    "type": "inline_equation",
                                    "content": "{ \\bf s } _ { i }",
                                    "score": 0.82
                                },
                                {
                                    "bbox": [
                                        381,
                                        340,
                                        544,
                                        356
                                    ],
                                    "type": "text",
                                    "content": "after each selection, as state changes",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                68,
                                354,
                                312,
                                367
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        354,
                                        312,
                                        367
                                    ],
                                    "type": "text",
                                    "content": "have minimal impact and this improves training speed.",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                },
                {
                    "bbox": [
                        66,
                        371,
                        543,
                        409
                    ],
                    "type": "text",
                    "angle": 0,
                    "index": 8,
                    "lines": [
                        {
                            "bbox": [
                                69,
                                371,
                                543,
                                385
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        371,
                                        543,
                                        385
                                    ],
                                    "type": "text",
                                    "content": "We use GRPO (Shao et al., 2024) style baseline to use grouped reward as baseline to reduce variance and to",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                69,
                                384,
                                542,
                                396
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        384,
                                        449,
                                        396
                                    ],
                                    "type": "text",
                                    "content": "minimize contamination across different segment prediction task. Specifically, for each",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        449,
                                        388,
                                        454,
                                        393
                                    ],
                                    "type": "inline_equation",
                                    "content": "x",
                                    "score": 0.9
                                },
                                {
                                    "bbox": [
                                        455,
                                        384,
                                        542,
                                        396
                                    ],
                                    "type": "text",
                                    "content": "we randomly select",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                70,
                                393,
                                438,
                                411
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        399,
                                        78,
                                        406
                                    ],
                                    "type": "inline_equation",
                                    "content": "G",
                                    "score": 0.9
                                },
                                {
                                    "bbox": [
                                        78,
                                        393,
                                        159,
                                        411
                                    ],
                                    "type": "text",
                                    "content": "number of length",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        159,
                                        398,
                                        170,
                                        406
                                    ],
                                    "type": "inline_equation",
                                    "content": "T ^ { \\prime }",
                                    "score": 0.91
                                },
                                {
                                    "bbox": [
                                        170,
                                        393,
                                        247,
                                        411
                                    ],
                                    "type": "text",
                                    "content": "action sequences",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        247,
                                        396,
                                        284,
                                        408
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\{ l ^ { ( i ) } \\} _ { i = 1 } ^ { G }",
                                    "score": 0.93
                                },
                                {
                                    "bbox": [
                                        284,
                                        393,
                                        438,
                                        411
                                    ],
                                    "type": "text",
                                    "content": ". We have the following objective:",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                },
                {
                    "bbox": [
                        67,
                        427,
                        542,
                        468
                    ],
                    "type": "interline_equation",
                    "angle": 0,
                    "lines": [
                        {
                            "bbox": [
                                67,
                                427,
                                542,
                                468
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        427,
                                        542,
                                        468
                                    ],
                                    "type": "interline_equation",
                                    "content": "\\mathcal {J} _ {\\theta} = \\frac {1}{G} \\sum_ {i = 1} ^ {G} \\mathbb {E} _ {\\substack {x \\sim P (\\mathcal {X}), \\\\ \\{l ^ {(i)} \\}_{i = 1} ^ {G} \\sim \\pi_ {\\theta} ([ L ] | x)}} \\frac {1}{T ^ {\\prime}} \\sum_ {t = 1} ^ {T ^ {\\prime}} \\min  \\left[ \\frac {\\pi_ {\\theta} \\left(l _ {t} ^ {(i)} \\mid x , \\left\\{l _ {j} ^ {(i)} \\right\\} _ {j = 1} ^ {t - 1}\\right)}{\\pi_ {\\theta_ {\\mathrm {old}}} \\left(l _ {t} ^ {(i)} \\mid x , \\left\\{l _ {j} ^ {(i)} \\right\\} _ {j = 1} ^ {t - 1}\\right)} A _ {t} ^ {(i)}, \\operatorname {clip} \\left(\\frac {\\pi_ {\\theta} \\left(l _ {t} ^ {(i)} \\mid x , \\left\\{l _ {j} ^ {(i)} \\right\\} _ {j = 1} ^ {t - 1}\\right)}{\\pi_ {\\theta_ {\\mathrm {old}}} \\left(l _ {t} ^ {(i)} \\mid x , \\left\\{l _ {j} ^ {(i)} \\right\\} _ {\\text { } j = 1} ^ {t - 1}\\right)}, 1 - \\epsilon , 1 + \\epsilon\\right) A _ {t} ^ {(i)} \\right]",
                                    "image_path": "2cfbfb21b39cc8a3069784d18f44132bfee8db3a47f572ef2df95fabc0b4153b.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 9
                },
                {
                    "bbox": [
                        66,
                        473,
                        543,
                        510
                    ],
                    "type": "text",
                    "angle": 0,
                    "index": 10,
                    "lines": [
                        {
                            "bbox": [
                                67,
                                472,
                                543,
                                487
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        472,
                                        99,
                                        487
                                    ],
                                    "type": "text",
                                    "content": "where",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        99,
                                        479,
                                        103,
                                        483
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\epsilon",
                                    "score": 0.88
                                },
                                {
                                    "bbox": [
                                        104,
                                        472,
                                        473,
                                        487
                                    ],
                                    "type": "text",
                                    "content": "is the clipping hyperparameter in PPO (Schulman et al., 2017) for stable training,",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        473,
                                        475,
                                        478,
                                        483
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\theta",
                                    "score": 0.9
                                },
                                {
                                    "bbox": [
                                        479,
                                        472,
                                        543,
                                        487
                                    ],
                                    "type": "text",
                                    "content": "is the current",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                68,
                                485,
                                543,
                                498
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        485,
                                        118,
                                        498
                                    ],
                                    "type": "text",
                                    "content": "policy and",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        118,
                                        488,
                                        134,
                                        497
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\theta _ { \\mathrm { o l d } }",
                                    "score": 0.92
                                },
                                {
                                    "bbox": [
                                        134,
                                        485,
                                        305,
                                        498
                                    ],
                                    "type": "text",
                                    "content": "is the policy fro the previous iteration,",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        306,
                                        488,
                                        317,
                                        497
                                    ],
                                    "type": "inline_equation",
                                    "content": "A _ { t }",
                                    "score": 0.92
                                },
                                {
                                    "bbox": [
                                        317,
                                        485,
                                        543,
                                        498
                                    ],
                                    "type": "text",
                                    "content": "is the advantage function. We define our advantage",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                68,
                                495,
                                365,
                                512
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        495,
                                        285,
                                        512
                                    ],
                                    "type": "text",
                                    "content": "function using the negative log-perplexity on the",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        285,
                                        502,
                                        290,
                                        507
                                    ],
                                    "type": "inline_equation",
                                    "content": "o",
                                    "score": 0.88
                                },
                                {
                                    "bbox": [
                                        291,
                                        495,
                                        324,
                                        512
                                    ],
                                    "type": "text",
                                    "content": "tokens",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        324,
                                        502,
                                        361,
                                        510
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\mathbf { X } _ { s + 1 : s + o }",
                                    "score": 0.87
                                },
                                {
                                    "bbox": [
                                        361,
                                        495,
                                        365,
                                        512
                                    ],
                                    "type": "text",
                                    "content": ":",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                },
                {
                    "bbox": [
                        175,
                        514,
                        435,
                        534
                    ],
                    "type": "interline_equation",
                    "angle": 0,
                    "lines": [
                        {
                            "bbox": [
                                175,
                                514,
                                435,
                                534
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        175,
                                        514,
                                        435,
                                        534
                                    ],
                                    "type": "interline_equation",
                                    "content": "r _ {i} = r \\left(x, \\{l _ {j} ^ {(i)} \\} _ {j = 1} ^ {T ^ {\\prime}}\\right) = - \\mathcal {M} _ {\\mathrm {d e c}} \\left(x _ {s + 1: s + o} | E (x, \\{l _ {j} ^ {(i)} \\} _ {j = 1} ^ {T ^ {\\prime}})\\right).",
                                    "image_path": "10b42d0669bc2091a93f6803360798b511eec669a6eaaba520a2b81f481beaca.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 11
                },
                {
                    "bbox": [
                        67,
                        543,
                        318,
                        555
                    ],
                    "type": "text",
                    "angle": 0,
                    "index": 12,
                    "lines": [
                        {
                            "bbox": [
                                68,
                                542,
                                319,
                                557
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        542,
                                        319,
                                        557
                                    ],
                                    "type": "text",
                                    "content": "We compute the advantage function following GRPO as:",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                },
                {
                    "bbox": [
                        241,
                        559,
                        368,
                        588
                    ],
                    "type": "interline_equation",
                    "angle": 0,
                    "lines": [
                        {
                            "bbox": [
                                241,
                                559,
                                368,
                                588
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        241,
                                        559,
                                        368,
                                        588
                                    ],
                                    "type": "interline_equation",
                                    "content": "A _ {t} ^ {(i)} = \\frac {r _ {i} - \\operatorname {m e a n} \\left(\\{r _ {i} \\} _ {i = 1} ^ {G}\\right)}{\\operatorname {s t d} \\left(\\{r _ {i} \\} _ {i = 1} ^ {G}\\right)}.",
                                    "image_path": "c14c421f48ed3a6cffda1d707affbf4bde95f21c17e733610f95c4c0d81b6454.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 13
                },
                {
                    "bbox": [
                        67,
                        609,
                        356,
                        624
                    ],
                    "type": "title",
                    "angle": 0,
                    "index": 14,
                    "lines": [
                        {
                            "bbox": [
                                67,
                                605,
                                356,
                                627
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        605,
                                        356,
                                        627
                                    ],
                                    "type": "text",
                                    "content": "B Additional Details on Experimental Settings",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                },
                {
                    "bbox": [
                        67,
                        636,
                        253,
                        648
                    ],
                    "type": "title",
                    "angle": 0,
                    "index": 15,
                    "lines": [
                        {
                            "bbox": [
                                68,
                                635,
                                253,
                                651
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        635,
                                        253,
                                        651
                                    ],
                                    "type": "text",
                                    "content": "B.1 Additional Details on Baselines",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                },
                {
                    "bbox": [
                        66,
                        655,
                        542,
                        681
                    ],
                    "type": "text",
                    "angle": 0,
                    "index": 16,
                    "lines": [
                        {
                            "bbox": [
                                68,
                                654,
                                543,
                                669
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        654,
                                        543,
                                        669
                                    ],
                                    "type": "text",
                                    "content": "All baseline models are based on the LLaMA-2-7B model (Touvron et al., 2023), unless otherwise specified, to",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                666,
                                543,
                                681
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        666,
                                        543,
                                        681
                                    ],
                                    "type": "text",
                                    "content": "ensure a fair comparison since the previous methods are trained based on this model.5 We do provide results",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                }
            ],
            "discarded_blocks": [
                {
                    "bbox": [
                        77,
                        684,
                        485,
                        694
                    ],
                    "type": "page_footnote",
                    "angle": 0,
                    "index": 17,
                    "lines": [
                        {
                            "bbox": [
                                80,
                                682,
                                484,
                                696
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        80,
                                        682,
                                        484,
                                        696
                                    ],
                                    "type": "text",
                                    "content": "4We adopt the masking mechanism from Pointer Networks (Bello et al., 2017) to constrain the action space.",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                },
                {
                    "bbox": [
                        67,
                        693,
                        543,
                        723
                    ],
                    "type": "page_footnote",
                    "angle": 0,
                    "index": 18,
                    "lines": [
                        {
                            "bbox": [
                                78,
                                691,
                                544,
                                707
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        78,
                                        691,
                                        544,
                                        707
                                    ],
                                    "type": "text",
                                    "content": "5Unless specified, we use the pre-trained checkpoint. The reason of choosing this model is that existing baselines (Yen et al.,",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                69,
                                703,
                                543,
                                715
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        703,
                                        543,
                                        715
                                    ],
                                    "type": "text",
                                    "content": "2024; Shi et al., 2024) adapts LLaMA-2-7B. If we use other base model, we will have to retrain their model for fair comparison.",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                68,
                                712,
                                293,
                                723
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        712,
                                        293,
                                        723
                                    ],
                                    "type": "text",
                                    "content": "We show the effectiveness of our training recipe in table 14.",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                },
                {
                    "bbox": [
                        299,
                        742,
                        312,
                        752
                    ],
                    "type": "page_number",
                    "angle": 0,
                    "index": 20,
                    "lines": [
                        {
                            "bbox": [
                                299,
                                742,
                                313,
                                756
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        299,
                                        742,
                                        313,
                                        756
                                    ],
                                    "type": "text",
                                    "content": "17",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                }
            ],
            "page_size": [
                612,
                792
            ],
            "page_idx": 16
        },
        {
            "para_blocks": [
                {
                    "type": "image",
                    "bbox": [
                        94,
                        68,
                        519,
                        230
                    ],
                    "blocks": [
                        {
                            "bbox": [
                                94,
                                68,
                                519,
                                230
                            ],
                            "lines": [
                                {
                                    "bbox": [
                                        94,
                                        68,
                                        519,
                                        230
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                94,
                                                68,
                                                519,
                                                230
                                            ],
                                            "type": "image",
                                            "image_path": "9d754df165861b17ffc4ea115d2e5aceafd4bf662fdb1f5a961b065d480f638a.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 0,
                            "angle": 0,
                            "type": "image_body"
                        },
                        {
                            "bbox": [
                                67,
                                238,
                                541,
                                259
                            ],
                            "lines": [
                                {
                                    "bbox": [
                                        69,
                                        237,
                                        542,
                                        250
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                69,
                                                237,
                                                542,
                                                250
                                            ],
                                            "type": "text",
                                            "content": "Figure 5 A demonstration of selective token compression. For all chunks, by default, we compress them to a single",
                                            "score": 1.0
                                        }
                                    ]
                                },
                                {
                                    "bbox": [
                                        68,
                                        247,
                                        269,
                                        261
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                68,
                                                247,
                                                269,
                                                261
                                            ],
                                            "type": "text",
                                            "content": "token, while for crucial chunks, we expand them.",
                                            "score": 1.0
                                        }
                                    ]
                                }
                            ],
                            "index": 1,
                            "angle": 0,
                            "type": "image_caption"
                        }
                    ],
                    "index": 0
                },
                {
                    "bbox": [
                        67,
                        281,
                        541,
                        327
                    ],
                    "type": "text",
                    "angle": 0,
                    "index": 2,
                    "lines": [
                        {
                            "bbox": [
                                68,
                                281,
                                542,
                                293
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        281,
                                        542,
                                        293
                                    ],
                                    "type": "text",
                                    "content": "on other encoder-decoder combinations in our ablation experiments (see section 4.1). Each data point contains",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                70,
                                292,
                                543,
                                307
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        296,
                                        112,
                                        304
                                    ],
                                    "type": "inline_equation",
                                    "content": "T = 4 0 9 6",
                                    "score": 0.85
                                },
                                {
                                    "bbox": [
                                        112,
                                        292,
                                        217,
                                        307
                                    ],
                                    "type": "text",
                                    "content": "tokens, where the first",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        217,
                                        297,
                                        256,
                                        304
                                    ],
                                    "type": "inline_equation",
                                    "content": "s = 2 0 4 8",
                                    "score": 0.88
                                },
                                {
                                    "bbox": [
                                        257,
                                        292,
                                        543,
                                        307
                                    ],
                                    "type": "text",
                                    "content": "tokens are referred to as the context tokens, and the remaining",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                70,
                                304,
                                543,
                                319
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        307,
                                        108,
                                        316
                                    ],
                                    "type": "inline_equation",
                                    "content": "o = 2 0 4 8",
                                    "score": 0.8
                                },
                                {
                                    "bbox": [
                                        109,
                                        304,
                                        288,
                                        319
                                    ],
                                    "type": "text",
                                    "content": "tokens are the output tokens, such that",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        288,
                                        308,
                                        331,
                                        316
                                    ],
                                    "type": "inline_equation",
                                    "content": "s + o = T",
                                    "score": 0.92
                                },
                                {
                                    "bbox": [
                                        331,
                                        304,
                                        473,
                                        319
                                    ],
                                    "type": "text",
                                    "content": ". We evaluate the perplexity on",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        473,
                                        310,
                                        509,
                                        317
                                    ],
                                    "type": "inline_equation",
                                    "content": "x _ { s + 1 : s + o }",
                                    "score": 0.9
                                },
                                {
                                    "bbox": [
                                        510,
                                        304,
                                        543,
                                        319
                                    ],
                                    "type": "text",
                                    "content": "in this",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                68,
                                317,
                                105,
                                329
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        317,
                                        105,
                                        329
                                    ],
                                    "type": "text",
                                    "content": "section.",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                },
                {
                    "bbox": [
                        67,
                        335,
                        541,
                        359
                    ],
                    "type": "text",
                    "angle": 0,
                    "index": 3,
                    "lines": [
                        {
                            "bbox": [
                                66,
                                332,
                                541,
                                351
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        66,
                                        332,
                                        421,
                                        351
                                    ],
                                    "type": "text",
                                    "content": "LLaMA-No Context: The original pre-trained LLaMA model evaluated directly on",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        421,
                                        340,
                                        457,
                                        347
                                    ],
                                    "type": "inline_equation",
                                    "content": "x _ { s + 1 : s + o }",
                                    "score": 0.91
                                },
                                {
                                    "bbox": [
                                        458,
                                        332,
                                        504,
                                        351
                                    ],
                                    "type": "text",
                                    "content": "with only",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        504,
                                        340,
                                        541,
                                        347
                                    ],
                                    "type": "inline_equation",
                                    "content": "x _ { s + 1 : s + o }",
                                    "score": 0.88
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                346,
                                111,
                                361
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        346,
                                        111,
                                        361
                                    ],
                                    "type": "text",
                                    "content": "as input.",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                },
                {
                    "bbox": [
                        67,
                        365,
                        541,
                        413
                    ],
                    "type": "text",
                    "angle": 0,
                    "index": 4,
                    "lines": [
                        {
                            "bbox": [
                                68,
                                364,
                                544,
                                378
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        364,
                                        462,
                                        378
                                    ],
                                    "type": "text",
                                    "content": "LLaMA-Full Context: Similar to the LLaMA-No Context, we evaluate the perplexity on",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        462,
                                        370,
                                        498,
                                        377
                                    ],
                                    "type": "inline_equation",
                                    "content": "x _ { s + 1 : s + o }",
                                    "score": 0.91
                                },
                                {
                                    "bbox": [
                                        499,
                                        364,
                                        544,
                                        378
                                    ],
                                    "type": "text",
                                    "content": "; however,",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                69,
                                376,
                                543,
                                390
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        376,
                                        447,
                                        390
                                    ],
                                    "type": "text",
                                    "content": "we also input the whole sequence to the model, including the context tokens, i.e.,",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        447,
                                        382,
                                        466,
                                        388
                                    ],
                                    "type": "inline_equation",
                                    "content": "x _ { 1 : T }",
                                    "score": 0.85
                                },
                                {
                                    "bbox": [
                                        466,
                                        376,
                                        543,
                                        390
                                    ],
                                    "type": "text",
                                    "content": ". Therefore, the",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                388,
                                543,
                                402
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        388,
                                        543,
                                        402
                                    ],
                                    "type": "text",
                                    "content": "perplexity of this model is expected to be lower than LLaMA-No Context. The perplexity of this model",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                400,
                                424,
                                413
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        400,
                                        424,
                                        413
                                    ],
                                    "type": "text",
                                    "content": "serves as a reference, showing the upper bound of the performance of our model.",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                },
                {
                    "bbox": [
                        67,
                        418,
                        541,
                        466
                    ],
                    "type": "text",
                    "angle": 0,
                    "index": 5,
                    "lines": [
                        {
                            "bbox": [
                                67,
                                417,
                                544,
                                433
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        417,
                                        357,
                                        433
                                    ],
                                    "type": "text",
                                    "content": "LLaMAK: Similar to the LLaMA-Full Context, we pass last",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        358,
                                        421,
                                        367,
                                        428
                                    ],
                                    "type": "inline_equation",
                                    "content": "K",
                                    "score": 0.91
                                },
                                {
                                    "bbox": [
                                        367,
                                        417,
                                        401,
                                        433
                                    ],
                                    "type": "text",
                                    "content": "tokens",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        402,
                                        423,
                                        424,
                                        431
                                    ],
                                    "type": "inline_equation",
                                    "content": "x _ { s _ { K } : s }",
                                    "score": 0.9
                                },
                                {
                                    "bbox": [
                                        424,
                                        417,
                                        492,
                                        433
                                    ],
                                    "type": "text",
                                    "content": "in addition to",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        492,
                                        423,
                                        528,
                                        431
                                    ],
                                    "type": "inline_equation",
                                    "content": "x _ { s + 1 : s + o }",
                                    "score": 0.89
                                },
                                {
                                    "bbox": [
                                        528,
                                        417,
                                        544,
                                        433
                                    ],
                                    "type": "text",
                                    "content": "to",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                430,
                                543,
                                443
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        430,
                                        170,
                                        443
                                    ],
                                    "type": "text",
                                    "content": "compute perplexity in",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        171,
                                        434,
                                        208,
                                        443
                                    ],
                                    "type": "inline_equation",
                                    "content": "x _ { s + 1 : s + o }",
                                    "score": 0.83
                                },
                                {
                                    "bbox": [
                                        208,
                                        430,
                                        343,
                                        443
                                    ],
                                    "type": "text",
                                    "content": ". The performance of LLaMA",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        343,
                                        437,
                                        351,
                                        442
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\boldsymbol { \\kappa }",
                                    "score": 0.84
                                },
                                {
                                    "bbox": [
                                        351,
                                        430,
                                        543,
                                        443
                                    ],
                                    "type": "text",
                                    "content": "falls between LLaMA-No Context and",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                441,
                                544,
                                456
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        441,
                                        544,
                                        456
                                    ],
                                    "type": "text",
                                    "content": "LLaMA-Full Context, making it a strong baseline for comparison with REFRAG when the number of",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                455,
                                187,
                                466
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        455,
                                        187,
                                        466
                                    ],
                                    "type": "text",
                                    "content": "context tokens is matched.",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                },
                {
                    "bbox": [
                        67,
                        472,
                        541,
                        509
                    ],
                    "type": "text",
                    "angle": 0,
                    "index": 6,
                    "lines": [
                        {
                            "bbox": [
                                69,
                                471,
                                542,
                                485
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        471,
                                        542,
                                        485
                                    ],
                                    "type": "text",
                                    "content": "CEPE: A memory-efficient long-context model modified from the LLaMA model (Yen et al., 2024). The model",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                68,
                                483,
                                542,
                                497
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        483,
                                        233,
                                        497
                                    ],
                                    "type": "text",
                                    "content": "architecture is similar to T5. We feed",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        234,
                                        490,
                                        250,
                                        496
                                    ],
                                    "type": "inline_equation",
                                    "content": "x _ { 1 : s }",
                                    "score": 0.9
                                },
                                {
                                    "bbox": [
                                        250,
                                        483,
                                        542,
                                        497
                                    ],
                                    "type": "text",
                                    "content": "into their encoder model and evaluate the perplexity on the output",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                495,
                                372,
                                510
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        495,
                                        100,
                                        510
                                    ],
                                    "type": "text",
                                    "content": "tokens",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        101,
                                        502,
                                        137,
                                        508
                                    ],
                                    "type": "inline_equation",
                                    "content": "x _ { s + 1 : s + o }",
                                    "score": 0.88
                                },
                                {
                                    "bbox": [
                                        138,
                                        495,
                                        372,
                                        510
                                    ],
                                    "type": "text",
                                    "content": ". CEPED refers to its instruction fine-tuned variant.",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                },
                {
                    "bbox": [
                        67,
                        514,
                        540,
                        538
                    ],
                    "type": "text",
                    "angle": 0,
                    "index": 7,
                    "lines": [
                        {
                            "bbox": [
                                68,
                                514,
                                542,
                                527
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        514,
                                        542,
                                        527
                                    ],
                                    "type": "text",
                                    "content": "LLaMA-32K: A fine-tuned version of the original LLaMA-2 7B model that extends the context length from",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                68,
                                526,
                                173,
                                539
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        526,
                                        173,
                                        539
                                    ],
                                    "type": "text",
                                    "content": "the original 4K to 32K.",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                },
                {
                    "bbox": [
                        67,
                        544,
                        541,
                        604
                    ],
                    "type": "text",
                    "angle": 0,
                    "index": 8,
                    "lines": [
                        {
                            "bbox": [
                                69,
                                544,
                                542,
                                556
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        544,
                                        542,
                                        556
                                    ],
                                    "type": "text",
                                    "content": "REPLUG: A retrieval-augmented language modeling framework that uses different retrieved contexts to perform",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                68,
                                555,
                                543,
                                569
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        555,
                                        543,
                                        569
                                    ],
                                    "type": "text",
                                    "content": "ensemble generation. We use REPLUG to refer to applying this framework on the LLaMA pre-trained model,",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                68,
                                567,
                                542,
                                581
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        567,
                                        542,
                                        581
                                    ],
                                    "type": "text",
                                    "content": "REPLUGChat to refer to applying this framework on the LLaMA chat model (i.e., instruction fine-tuned),",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                69,
                                580,
                                542,
                                593
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        580,
                                        542,
                                        593
                                    ],
                                    "type": "text",
                                    "content": "and REPLUGFT to refer to applying it on the LLaMA model fine-tuned on the downstream tasks (see",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                592,
                                117,
                                605
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        592,
                                        117,
                                        605
                                    ],
                                    "type": "text",
                                    "content": "section 5).",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                },
                {
                    "bbox": [
                        67,
                        609,
                        541,
                        658
                    ],
                    "type": "text",
                    "angle": 0,
                    "index": 9,
                    "lines": [
                        {
                            "bbox": [
                                69,
                                609,
                                543,
                                622
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        609,
                                        543,
                                        622
                                    ],
                                    "type": "text",
                                    "content": "REFRAG: Our approach is illustrated in figure 1. We use RoBERTa-large (Liu et al., 2019) as the encoder,",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                68,
                                621,
                                543,
                                635
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        621,
                                        102,
                                        635
                                    ],
                                    "type": "text",
                                    "content": "feeding",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        103,
                                        627,
                                        119,
                                        633
                                    ],
                                    "type": "inline_equation",
                                    "content": "x _ { 1 : s }",
                                    "score": 0.86
                                },
                                {
                                    "bbox": [
                                        119,
                                        621,
                                        370,
                                        635
                                    ],
                                    "type": "text",
                                    "content": "tokens and evaluating the perplexity on the output tokens",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        370,
                                        627,
                                        406,
                                        634
                                    ],
                                    "type": "inline_equation",
                                    "content": "x _ { s + 1 : s + o }",
                                    "score": 0.82
                                },
                                {
                                    "bbox": [
                                        406,
                                        621,
                                        493,
                                        635
                                    ],
                                    "type": "text",
                                    "content": ". We use REFRAG",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        493,
                                        628,
                                        498,
                                        633
                                    ],
                                    "type": "inline_equation",
                                    "content": "k",
                                    "score": 0.77
                                },
                                {
                                    "bbox": [
                                        498,
                                        621,
                                        543,
                                        635
                                    ],
                                    "type": "text",
                                    "content": "to denote",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                68,
                                633,
                                542,
                                647
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        633,
                                        225,
                                        647
                                    ],
                                    "type": "text",
                                    "content": "our model with compression rate of",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        226,
                                        636,
                                        231,
                                        643
                                    ],
                                    "type": "inline_equation",
                                    "content": "k",
                                    "score": 0.89
                                },
                                {
                                    "bbox": [
                                        232,
                                        633,
                                        542,
                                        647
                                    ],
                                    "type": "text",
                                    "content": ". We use REFRAGRL to refer to the model with selective compression",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                645,
                                160,
                                659
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        645,
                                        160,
                                        659
                                    ],
                                    "type": "text",
                                    "content": "using our RL policy.",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                },
                {
                    "bbox": [
                        67,
                        673,
                        469,
                        686
                    ],
                    "type": "title",
                    "angle": 0,
                    "index": 10,
                    "lines": [
                        {
                            "bbox": [
                                68,
                                670,
                                470,
                                689
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        670,
                                        470,
                                        689
                                    ],
                                    "type": "text",
                                    "content": "B.2 Additional Details on Hyperparameters and Experimental Settings for CPT",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                },
                {
                    "bbox": [
                        67,
                        693,
                        541,
                        716
                    ],
                    "type": "text",
                    "angle": 0,
                    "index": 11,
                    "lines": [
                        {
                            "bbox": [
                                69,
                                692,
                                543,
                                704
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        692,
                                        407,
                                        704
                                    ],
                                    "type": "text",
                                    "content": "Hyperparameters. For reconstruction stage, we use a peak learning rate of",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        408,
                                        693,
                                        436,
                                        703
                                    ],
                                    "type": "inline_equation",
                                    "content": "2 e - 4",
                                    "score": 0.8
                                },
                                {
                                    "bbox": [
                                        436,
                                        692,
                                        543,
                                        704
                                    ],
                                    "type": "text",
                                    "content": "since we only train the",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                69,
                                704,
                                542,
                                716
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        704,
                                        419,
                                        716
                                    ],
                                    "type": "text",
                                    "content": "encoder model. For the next paragraph prediction we use a peak learning rate of",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        420,
                                        704,
                                        447,
                                        715
                                    ],
                                    "type": "inline_equation",
                                    "content": "5 e - 5",
                                    "score": 0.75
                                },
                                {
                                    "bbox": [
                                        448,
                                        704,
                                        542,
                                        716
                                    ],
                                    "type": "text",
                                    "content": "since we train all the",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                }
            ],
            "discarded_blocks": [
                {
                    "bbox": [
                        299,
                        742,
                        310,
                        751
                    ],
                    "type": "page_number",
                    "angle": 0,
                    "index": 12,
                    "lines": [
                        {
                            "bbox": [
                                299,
                                742,
                                312,
                                755
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        299,
                                        742,
                                        312,
                                        755
                                    ],
                                    "type": "text",
                                    "content": "18",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                }
            ],
            "page_size": [
                612,
                792
            ],
            "page_idx": 17
        },
        {
            "para_blocks": [
                {
                    "bbox": [
                        67,
                        64,
                        543,
                        138
                    ],
                    "type": "text",
                    "angle": 0,
                    "index": 0,
                    "lines": [
                        {
                            "bbox": [
                                67,
                                63,
                                543,
                                78
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        63,
                                        543,
                                        78
                                    ],
                                    "type": "text",
                                    "content": "parameters in the model, including the decoder parameters. For all the instruction-tuning tasks, we use the",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                76,
                                542,
                                90
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        76,
                                        159,
                                        90
                                    ],
                                    "type": "text",
                                    "content": "peak learning rate of",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        160,
                                        79,
                                        184,
                                        87
                                    ],
                                    "type": "inline_equation",
                                    "content": "2 e - 5",
                                    "score": 0.91
                                },
                                {
                                    "bbox": [
                                        184,
                                        76,
                                        542,
                                        90
                                    ],
                                    "type": "text",
                                    "content": ". We use a 4% linear warm-up stage for learning rate, AdamW optimizer (Loshchilov",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                68,
                                88,
                                542,
                                101
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        88,
                                        542,
                                        101
                                    ],
                                    "type": "text",
                                    "content": "and Hutter, 2019), cosine learning rate scheduler and a batch size of 256 for all the experiments. For the",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                99,
                                543,
                                113
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        99,
                                        543,
                                        113
                                    ],
                                    "type": "text",
                                    "content": "projection layer, we use a 2-layer multi-layer perception (MLP) with an hidden size that is equivalent to the",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                110,
                                543,
                                126
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        110,
                                        543,
                                        126
                                    ],
                                    "type": "text",
                                    "content": "output size (i.e., 4096 for LLaMA-2-7B). For both tasks we train our model for 4 epochs on the dataset using",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                122,
                                276,
                                138
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        122,
                                        276,
                                        138
                                    ],
                                    "type": "text",
                                    "content": "the curriculum learning schedule (see figure 6).",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                },
                {
                    "bbox": [
                        67,
                        148,
                        542,
                        174
                    ],
                    "type": "text",
                    "angle": 0,
                    "index": 1,
                    "lines": [
                        {
                            "bbox": [
                                70,
                                148,
                                542,
                                162
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        148,
                                        542,
                                        162
                                    ],
                                    "type": "text",
                                    "content": "Computational Resources. We train all our models in Bfloat16 precision. We adopt Fully Sharded Data",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                69,
                                162,
                                529,
                                174
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        162,
                                        529,
                                        174
                                    ],
                                    "type": "text",
                                    "content": "Parallel (FSDP) for all the experiments and train our model on 8 nodes with 8 H100 cards on each node.",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                },
                {
                    "bbox": [
                        67,
                        186,
                        542,
                        211
                    ],
                    "type": "text",
                    "angle": 0,
                    "index": 2,
                    "lines": [
                        {
                            "bbox": [
                                69,
                                186,
                                542,
                                199
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        186,
                                        170,
                                        199
                                    ],
                                    "type": "text",
                                    "content": "Evaluation metrics in",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        170,
                                        190,
                                        193,
                                        197
                                    ],
                                    "type": "inline_equation",
                                    "content": "R A G",
                                    "score": 0.71
                                },
                                {
                                    "bbox": [
                                        193,
                                        186,
                                        542,
                                        199
                                    ],
                                    "type": "text",
                                    "content": ". Table 7 provides a summarization of the evaluation metrics we use for each",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                68,
                                198,
                                199,
                                211
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        198,
                                        199,
                                        211
                                    ],
                                    "type": "text",
                                    "content": "dataset in RAG experiments.",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                },
                {
                    "bbox": [
                        67,
                        224,
                        543,
                        272
                    ],
                    "type": "text",
                    "angle": 0,
                    "index": 3,
                    "lines": [
                        {
                            "bbox": [
                                69,
                                224,
                                543,
                                237
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        224,
                                        543,
                                        237
                                    ],
                                    "type": "text",
                                    "content": "Experimental setting for fine-tuning model to take a combination of token and chunk embedding as input.",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                69,
                                236,
                                543,
                                249
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        236,
                                        543,
                                        249
                                    ],
                                    "type": "text",
                                    "content": "We continue the model training from the continual pre-training checkpoint. To fine-tune the model, we set",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                70,
                                247,
                                544,
                                262
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        251,
                                        101,
                                        260
                                    ],
                                    "type": "inline_equation",
                                    "content": "p = 0 . 1",
                                    "score": 0.87
                                },
                                {
                                    "bbox": [
                                        102,
                                        247,
                                        361,
                                        262
                                    ],
                                    "type": "text",
                                    "content": "(i.e., compression 90% of the chunks) and randomly select",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        362,
                                        251,
                                        374,
                                        260
                                    ],
                                    "type": "inline_equation",
                                    "content": "p L",
                                    "score": 0.9
                                },
                                {
                                    "bbox": [
                                        374,
                                        247,
                                        544,
                                        262
                                    ],
                                    "type": "text",
                                    "content": "chunks to keep their original token in",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                69,
                                260,
                                429,
                                272
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        260,
                                        429,
                                        272
                                    ],
                                    "type": "text",
                                    "content": "the decoder. The input arrangement is the same as what we describe in section 2.",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "table",
                    "bbox": [
                        200,
                        280,
                        411,
                        547
                    ],
                    "blocks": [
                        {
                            "bbox": [
                                200,
                                280,
                                411,
                                547
                            ],
                            "lines": [
                                {
                                    "bbox": [
                                        200,
                                        280,
                                        411,
                                        547
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                200,
                                                280,
                                                411,
                                                547
                                            ],
                                            "type": "table",
                                            "html": "<table><tr><td>Dataset</td><td>Metric</td></tr><tr><td>OpenAssistant Conversations</td><td>F1</td></tr><tr><td>CommonsenseQA</td><td>Accuracy</td></tr><tr><td>MathQA</td><td>Accuracy</td></tr><tr><td>Web Questions</td><td>Exact Match</td></tr><tr><td>WikiQA</td><td>F1</td></tr><tr><td>Yahoo! Answers QA</td><td>F1</td></tr><tr><td>FreebaseQA</td><td>Exact Match</td></tr><tr><td>MS MARCO</td><td>F1</td></tr><tr><td>PubMedQA</td><td>Exact Match</td></tr><tr><td>QuaRel</td><td>Accuracy</td></tr><tr><td>GSM8K</td><td>Exact Match</td></tr><tr><td>StrategyQA</td><td>Exact Match</td></tr><tr><td>MMLU</td><td>Accuracy</td></tr><tr><td>BoolQ</td><td>Exact Match</td></tr><tr><td>SIQA</td><td>Accuracy</td></tr><tr><td>PIQA</td><td>Accuracy</td></tr><tr><td>HellaSwag</td><td>Accuracy</td></tr><tr><td>Winogrande</td><td>Accuracy</td></tr><tr><td>TriviaQA</td><td>Exact Match</td></tr><tr><td>FEVER</td><td>Exact Match</td></tr><tr><td>NQ</td><td>Exact Match</td></tr></table>",
                                            "image_path": "db98bf1fcc4cb4a71e532cfabbcaecd6047563dd37bc1dca30f6c517cc2aeb48.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 4,
                            "angle": 0,
                            "type": "table_body"
                        },
                        {
                            "bbox": [
                                67,
                                555,
                                349,
                                566
                            ],
                            "lines": [
                                {
                                    "bbox": [
                                        69,
                                        554,
                                        349,
                                        567
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                69,
                                                554,
                                                349,
                                                567
                                            ],
                                            "type": "text",
                                            "content": "Table 7 Metrics used for each dataset in RAG experiments in table 3",
                                            "score": 1.0
                                        }
                                    ]
                                }
                            ],
                            "index": 5,
                            "angle": 0,
                            "type": "table_caption"
                        }
                    ],
                    "index": 4
                },
                {
                    "bbox": [
                        67,
                        586,
                        263,
                        600
                    ],
                    "type": "title",
                    "angle": 0,
                    "index": 6,
                    "lines": [
                        {
                            "bbox": [
                                68,
                                585,
                                264,
                                603
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        585,
                                        264,
                                        603
                                    ],
                                    "type": "text",
                                    "content": "B.3 Curriculum learning data mixture",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                },
                {
                    "bbox": [
                        67,
                        606,
                        543,
                        667
                    ],
                    "type": "text",
                    "angle": 0,
                    "index": 7,
                    "lines": [
                        {
                            "bbox": [
                                68,
                                605,
                                542,
                                619
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        605,
                                        542,
                                        619
                                    ],
                                    "type": "text",
                                    "content": "Table 8 presents the number of data points used at each training stage of our model. We employ a geometric",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                617,
                                543,
                                631
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        617,
                                        543,
                                        631
                                    ],
                                    "type": "text",
                                    "content": "sequence for each type of data point, based on the intuition that training should begin with a greater",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                629,
                                543,
                                643
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        629,
                                        543,
                                        643
                                    ],
                                    "type": "text",
                                    "content": "proportion of easier examples and gradually introduce more challenging ones as training progresses. The",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                68,
                                641,
                                543,
                                654
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        641,
                                        543,
                                        654
                                    ],
                                    "type": "text",
                                    "content": "right-most column indicates the total number of data points for each type. We allocate more data points to",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                69,
                                654,
                                461,
                                667
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        654,
                                        461,
                                        667
                                    ],
                                    "type": "text",
                                    "content": "longer-context examples to encourage the model to focus on learning more difficult tasks.",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                },
                {
                    "bbox": [
                        67,
                        681,
                        484,
                        694
                    ],
                    "type": "title",
                    "angle": 0,
                    "index": 8,
                    "lines": [
                        {
                            "bbox": [
                                69,
                                679,
                                484,
                                695
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        679,
                                        484,
                                        695
                                    ],
                                    "type": "text",
                                    "content": "B.4 Detailed Calculation of Acceleration in Latency and Throughput of Our Model",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                },
                {
                    "bbox": [
                        67,
                        700,
                        543,
                        724
                    ],
                    "type": "text",
                    "angle": 0,
                    "index": 9,
                    "lines": [
                        {
                            "bbox": [
                                67,
                                699,
                                544,
                                712
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        699,
                                        544,
                                        712
                                    ],
                                    "type": "text",
                                    "content": "In this section, we provide a detailed analysis of the TTFT and generation latency for the LLaMA-2 model.",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                68,
                                711,
                                543,
                                724
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        711,
                                        231,
                                        724
                                    ],
                                    "type": "text",
                                    "content": "We denote the following parameters:",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        231,
                                        716,
                                        236,
                                        721
                                    ],
                                    "type": "inline_equation",
                                    "content": "s",
                                    "score": 0.83
                                },
                                {
                                    "bbox": [
                                        236,
                                        711,
                                        335,
                                        724
                                    ],
                                    "type": "text",
                                    "content": "as the context length,",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        336,
                                        716,
                                        341,
                                        721
                                    ],
                                    "type": "inline_equation",
                                    "content": "o",
                                    "score": 0.8
                                },
                                {
                                    "bbox": [
                                        341,
                                        711,
                                        438,
                                        724
                                    ],
                                    "type": "text",
                                    "content": "as the output length,",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        438,
                                        714,
                                        443,
                                        721
                                    ],
                                    "type": "inline_equation",
                                    "content": "b",
                                    "score": 0.85
                                },
                                {
                                    "bbox": [
                                        443,
                                        711,
                                        523,
                                        724
                                    ],
                                    "type": "text",
                                    "content": "as the batch size,",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        523,
                                        714,
                                        529,
                                        721
                                    ],
                                    "type": "inline_equation",
                                    "content": "d",
                                    "score": 0.89
                                },
                                {
                                    "bbox": [
                                        529,
                                        711,
                                        543,
                                        724
                                    ],
                                    "type": "text",
                                    "content": "as",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                }
            ],
            "discarded_blocks": [
                {
                    "bbox": [
                        300,
                        742,
                        311,
                        752
                    ],
                    "type": "page_number",
                    "angle": 0,
                    "index": 10,
                    "lines": [
                        {
                            "bbox": [
                                299,
                                742,
                                313,
                                755
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        299,
                                        742,
                                        313,
                                        755
                                    ],
                                    "type": "text",
                                    "content": "19",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                }
            ],
            "page_size": [
                612,
                792
            ],
            "page_idx": 18
        },
        {
            "para_blocks": [
                {
                    "type": "image",
                    "bbox": [
                        167,
                        66,
                        440,
                        216
                    ],
                    "blocks": [
                        {
                            "bbox": [
                                167,
                                66,
                                440,
                                216
                            ],
                            "lines": [
                                {
                                    "bbox": [
                                        167,
                                        66,
                                        440,
                                        216
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                167,
                                                66,
                                                440,
                                                216
                                            ],
                                            "type": "image",
                                            "image_path": "f2b5ca26598e74830a89c374a131459ec7e36267c1b23d0929aab674e9797590.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 0,
                            "angle": 0,
                            "type": "image_body"
                        },
                        {
                            "bbox": [
                                67,
                                229,
                                353,
                                241
                            ],
                            "lines": [
                                {
                                    "bbox": [
                                        68,
                                        227,
                                        353,
                                        243
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                68,
                                                227,
                                                353,
                                                243
                                            ],
                                            "type": "text",
                                            "content": "Figure 6 The data mixture in curriculum learning during the training.",
                                            "score": 1.0
                                        }
                                    ]
                                }
                            ],
                            "index": 1,
                            "angle": 0,
                            "type": "image_caption"
                        }
                    ],
                    "index": 0
                },
                {
                    "type": "table",
                    "bbox": [
                        72,
                        251,
                        538,
                        367
                    ],
                    "blocks": [
                        {
                            "bbox": [
                                72,
                                251,
                                538,
                                367
                            ],
                            "lines": [
                                {
                                    "bbox": [
                                        72,
                                        251,
                                        538,
                                        367
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                72,
                                                251,
                                                538,
                                                367
                                            ],
                                            "type": "table",
                                            "html": "<table><tr><td>Factor</td><td>Stage 1</td><td>Stage 2</td><td>Stage 3</td><td>Stage 4</td><td>Stage 5</td><td>Stage 6</td><td>Stage 7</td><td>Stage 8</td><td>Stage 9</td><td>Summation</td></tr><tr><td>1  8</td><td>1333</td><td>445</td><td>148</td><td>49</td><td>16</td><td>6</td><td>2</td><td>1</td><td>0</td><td>2000</td></tr><tr><td>2  8</td><td>333</td><td>298</td><td>267</td><td>238</td><td>213</td><td>191</td><td>171</td><td>153</td><td>137</td><td>2000</td></tr><tr><td>4  8</td><td>83</td><td>102</td><td>126</td><td>156</td><td>193</td><td>238</td><td>293</td><td>362</td><td>447</td><td>2000</td></tr><tr><td>8  8</td><td>20</td><td>35</td><td>61</td><td>106</td><td>185</td><td>324</td><td>565</td><td>985</td><td>1719</td><td>4000</td></tr><tr><td>16  8</td><td>5</td><td>11</td><td>23</td><td>48</td><td>103</td><td>220</td><td>468</td><td>997</td><td>2125</td><td>4000</td></tr><tr><td>32  8</td><td>1</td><td>3</td><td>7</td><td>19</td><td>50</td><td>133</td><td>353</td><td>939</td><td>2496</td><td>4000</td></tr><tr><td>64  8</td><td>1</td><td>3</td><td>9</td><td>25</td><td>73</td><td>212</td><td>618</td><td>1802</td><td>5259</td><td>8000</td></tr><tr><td>128  8</td><td>1</td><td>3</td><td>9</td><td>25</td><td>73</td><td>212</td><td>618</td><td>1802</td><td>5259</td><td>8000</td></tr><tr><td>256  8</td><td>1</td><td>3</td><td>9</td><td>25</td><td>73</td><td>212</td><td>618</td><td>1802</td><td>5259</td><td>8000</td></tr></table>",
                                            "image_path": "d6d27e1909feb2ad596e7c07a083a68ab832cf0221a7edb355fe1eec288885cd.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 2,
                            "angle": 0,
                            "type": "table_body"
                        },
                        {
                            "bbox": [
                                67,
                                375,
                                541,
                                430
                            ],
                            "lines": [
                                {
                                    "bbox": [
                                        67,
                                        374,
                                        542,
                                        389
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                67,
                                                374,
                                                542,
                                                389
                                            ],
                                            "type": "text",
                                            "content": "Table 8 The geometry curriculum learning scheduling. The whole training is split into 9 stages. In each stage, we",
                                            "score": 1.0
                                        }
                                    ]
                                },
                                {
                                    "bbox": [
                                        67,
                                        385,
                                        543,
                                        399
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                67,
                                                385,
                                                543,
                                                399
                                            ],
                                            "type": "text",
                                            "content": "have a combination of different data (e.g., 1X8 means reconstructing 8 tokens, 2X8 means reconstructing 16 tokens).",
                                            "score": 1.0
                                        }
                                    ]
                                },
                                {
                                    "bbox": [
                                        68,
                                        397,
                                        542,
                                        410
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                68,
                                                397,
                                                542,
                                                410
                                            ],
                                            "type": "text",
                                            "content": "For each type of data, the number of samples in each stage is determined by a geometric sequence which sums up to",
                                            "score": 1.0
                                        }
                                    ]
                                },
                                {
                                    "bbox": [
                                        68,
                                        407,
                                        542,
                                        421
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                68,
                                                407,
                                                542,
                                                421
                                            ],
                                            "type": "text",
                                            "content": "the total number of samples in the last column. As training proceeds, the data mixture has more and more longer",
                                            "score": 1.0
                                        }
                                    ]
                                },
                                {
                                    "bbox": [
                                        68,
                                        421,
                                        113,
                                        431
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                68,
                                                421,
                                                113,
                                                431
                                            ],
                                            "type": "text",
                                            "content": "sequences.",
                                            "score": 1.0
                                        }
                                    ]
                                }
                            ],
                            "index": 3,
                            "angle": 0,
                            "type": "table_caption"
                        }
                    ],
                    "index": 2
                },
                {
                    "bbox": [
                        67,
                        451,
                        541,
                        499
                    ],
                    "type": "text",
                    "angle": 0,
                    "index": 4,
                    "lines": [
                        {
                            "bbox": [
                                69,
                                452,
                                542,
                                464
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        452,
                                        250,
                                        464
                                    ],
                                    "type": "text",
                                    "content": "the dimensionality of the hidden states,",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        250,
                                        454,
                                        253,
                                        462
                                    ],
                                    "type": "inline_equation",
                                    "content": "l",
                                    "score": 0.55
                                },
                                {
                                    "bbox": [
                                        254,
                                        452,
                                        455,
                                        464
                                    ],
                                    "type": "text",
                                    "content": "as the number of layers in the decoder, and",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        455,
                                        457,
                                        462,
                                        462
                                    ],
                                    "type": "inline_equation",
                                    "content": "n",
                                    "score": 0.89
                                },
                                {
                                    "bbox": [
                                        462,
                                        452,
                                        542,
                                        464
                                    ],
                                    "type": "text",
                                    "content": "as the number of",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                69,
                                464,
                                542,
                                476
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        464,
                                        282,
                                        476
                                    ],
                                    "type": "text",
                                    "content": "model parameters. The flop rate of the GPU is",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        282,
                                        466,
                                        288,
                                        475
                                    ],
                                    "type": "inline_equation",
                                    "content": "f",
                                    "score": 0.88
                                },
                                {
                                    "bbox": [
                                        288,
                                        464,
                                        507,
                                        476
                                    ],
                                    "type": "text",
                                    "content": ", and the high bandwidth memory of the GPU is",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        507,
                                        469,
                                        516,
                                        474
                                    ],
                                    "type": "inline_equation",
                                    "content": "m",
                                    "score": 0.89
                                },
                                {
                                    "bbox": [
                                        517,
                                        464,
                                        542,
                                        476
                                    ],
                                    "type": "text",
                                    "content": ". The",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                68,
                                474,
                                542,
                                489
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        474,
                                        542,
                                        489
                                    ],
                                    "type": "text",
                                    "content": "model is loaded with bfloat16 precision. We focus our analysis on LLaMA-2-7B model. The results should be",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                68,
                                487,
                                203,
                                500
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        487,
                                        203,
                                        500
                                    ],
                                    "type": "text",
                                    "content": "generalizable to other models.",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                },
                {
                    "bbox": [
                        67,
                        513,
                        541,
                        574
                    ],
                    "type": "text",
                    "angle": 0,
                    "index": 5,
                    "lines": [
                        {
                            "bbox": [
                                70,
                                514,
                                542,
                                526
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        514,
                                        542,
                                        526
                                    ],
                                    "type": "text",
                                    "content": "TTFT: Computationally Bounded Analysis Existing work (Liu et al., 2025) has shown that the TTFT",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                525,
                                542,
                                538
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        525,
                                        542,
                                        538
                                    ],
                                    "type": "text",
                                    "content": "latency is primarily limited by computation. The primary computations in each layer of LLaMA-2 involve",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                68,
                                537,
                                542,
                                550
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        537,
                                        542,
                                        550
                                    ],
                                    "type": "text",
                                    "content": "attention calculations and feedforward layers. We follow the analysis in (Liu et al., 2025) to calculate the",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                548,
                                542,
                                563
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        548,
                                        542,
                                        563
                                    ],
                                    "type": "text",
                                    "content": "TTFT. Note that each operation involves both a multiplication and an addition, hence we multiply the flop",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                562,
                                121,
                                574
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        562,
                                        121,
                                        574
                                    ],
                                    "type": "text",
                                    "content": "count by 2.",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                },
                {
                    "bbox": [
                        83,
                        580,
                        188,
                        590
                    ],
                    "type": "title",
                    "angle": 0,
                    "index": 6,
                    "lines": [
                        {
                            "bbox": [
                                84,
                                578,
                                188,
                                592
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        84,
                                        578,
                                        188,
                                        592
                                    ],
                                    "type": "text",
                                    "content": " Attention Calculation:",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                },
                {
                    "bbox": [
                        102,
                        597,
                        543,
                        675
                    ],
                    "type": "list",
                    "angle": 0,
                    "index": 11,
                    "blocks": [
                        {
                            "bbox": [
                                102,
                                597,
                                465,
                                610
                            ],
                            "type": "text",
                            "angle": 0,
                            "index": 7,
                            "lines": [
                                {
                                    "bbox": [
                                        104,
                                        595,
                                        466,
                                        612
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                104,
                                                595,
                                                296,
                                                612
                                            ],
                                            "type": "text",
                                            "content": " QKV Projection: Transforms input from",
                                            "score": 1.0
                                        },
                                        {
                                            "bbox": [
                                                296,
                                                599,
                                                325,
                                                609
                                            ],
                                            "type": "inline_equation",
                                            "content": "[ b , s , d ]",
                                            "score": 0.94
                                        },
                                        {
                                            "bbox": [
                                                325,
                                                595,
                                                340,
                                                612
                                            ],
                                            "type": "text",
                                            "content": "to",
                                            "score": 1.0
                                        },
                                        {
                                            "bbox": [
                                                340,
                                                599,
                                                366,
                                                609
                                            ],
                                            "type": "inline_equation",
                                            "content": "[ d , 3 d ]",
                                            "score": 0.93
                                        },
                                        {
                                            "bbox": [
                                                366,
                                                595,
                                                413,
                                                612
                                            ],
                                            "type": "text",
                                            "content": ", requiring",
                                            "score": 1.0
                                        },
                                        {
                                            "bbox": [
                                                414,
                                                598,
                                                438,
                                                607
                                            ],
                                            "type": "inline_equation",
                                            "content": "6 b s d ^ { 2 }",
                                            "score": 0.9
                                        },
                                        {
                                            "bbox": [
                                                438,
                                                595,
                                                466,
                                                612
                                            ],
                                            "type": "text",
                                            "content": "flops.",
                                            "score": 1.0
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "bbox": [
                                102,
                                614,
                                543,
                                628
                            ],
                            "type": "text",
                            "angle": 0,
                            "index": 8,
                            "lines": [
                                {
                                    "bbox": [
                                        104,
                                        613,
                                        545,
                                        629
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                104,
                                                613,
                                                241,
                                                629
                                            ],
                                            "type": "text",
                                            "content": " Attention Score Calculation:",
                                            "score": 1.0
                                        },
                                        {
                                            "bbox": [
                                                242,
                                                616,
                                                266,
                                                627
                                            ],
                                            "type": "inline_equation",
                                            "content": "Q K ^ { T }",
                                            "score": 0.9
                                        },
                                        {
                                            "bbox": [
                                                266,
                                                613,
                                                335,
                                                629
                                            ],
                                            "type": "text",
                                            "content": "operation from",
                                            "score": 1.0
                                        },
                                        {
                                            "bbox": [
                                                335,
                                                617,
                                                446,
                                                628
                                            ],
                                            "type": "inline_equation",
                                            "content": "[ b , h , s , d / h ] \\times [ b , h , d / h , s ]",
                                            "score": 0.93
                                        },
                                        {
                                            "bbox": [
                                                447,
                                                613,
                                                493,
                                                629
                                            ],
                                            "type": "text",
                                            "content": ", requiring",
                                            "score": 1.0
                                        },
                                        {
                                            "bbox": [
                                                493,
                                                616,
                                                517,
                                                625
                                            ],
                                            "type": "inline_equation",
                                            "content": "2 b d s ^ { 2 }",
                                            "score": 0.9
                                        },
                                        {
                                            "bbox": [
                                                517,
                                                613,
                                                545,
                                                629
                                            ],
                                            "type": "text",
                                            "content": "flops.",
                                            "score": 1.0
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "bbox": [
                                102,
                                632,
                                542,
                                657
                            ],
                            "type": "text",
                            "angle": 0,
                            "index": 9,
                            "lines": [
                                {
                                    "bbox": [
                                        104,
                                        630,
                                        539,
                                        647
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                104,
                                                630,
                                                439,
                                                647
                                            ],
                                            "type": "text",
                                            "content": " Attention Output Calculation: Weighted average of the value hidden state,",
                                            "score": 1.0
                                        },
                                        {
                                            "bbox": [
                                                439,
                                                635,
                                                539,
                                                645
                                            ],
                                            "type": "inline_equation",
                                            "content": "[ b , h , s , s ] \\times [ b , h , s , d / h ]",
                                            "score": 0.92
                                        }
                                    ]
                                },
                                {
                                    "bbox": [
                                        115,
                                        644,
                                        211,
                                        659
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                115,
                                                644,
                                                158,
                                                659
                                            ],
                                            "type": "text",
                                            "content": "requiring",
                                            "score": 1.0
                                        },
                                        {
                                            "bbox": [
                                                159,
                                                645,
                                                183,
                                                655
                                            ],
                                            "type": "inline_equation",
                                            "content": "2 b d s ^ { 2 }",
                                            "score": 0.64
                                        },
                                        {
                                            "bbox": [
                                                184,
                                                644,
                                                211,
                                                659
                                            ],
                                            "type": "text",
                                            "content": "flops.",
                                            "score": 1.0
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "bbox": [
                                102,
                                662,
                                361,
                                675
                            ],
                            "type": "text",
                            "angle": 0,
                            "index": 10,
                            "lines": [
                                {
                                    "bbox": [
                                        105,
                                        661,
                                        362,
                                        677
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                105,
                                                661,
                                                201,
                                                677
                                            ],
                                            "type": "text",
                                            "content": " Output Projection:",
                                            "score": 1.0
                                        },
                                        {
                                            "bbox": [
                                                201,
                                                665,
                                                263,
                                                675
                                            ],
                                            "type": "inline_equation",
                                            "content": "[ b , s , d ] \\times [ d , d ]",
                                            "score": 0.93
                                        },
                                        {
                                            "bbox": [
                                                263,
                                                661,
                                                310,
                                                677
                                            ],
                                            "type": "text",
                                            "content": ", requiring",
                                            "score": 1.0
                                        },
                                        {
                                            "bbox": [
                                                311,
                                                664,
                                                335,
                                                673
                                            ],
                                            "type": "inline_equation",
                                            "content": "2 b s d ^ { 2 }",
                                            "score": 0.9
                                        },
                                        {
                                            "bbox": [
                                                335,
                                                661,
                                                362,
                                                677
                                            ],
                                            "type": "text",
                                            "content": "flops.",
                                            "score": 1.0
                                        }
                                    ]
                                }
                            ]
                        }
                    ],
                    "sub_type": "text"
                },
                {
                    "bbox": [
                        91,
                        681,
                        293,
                        692
                    ],
                    "type": "text",
                    "angle": 0,
                    "index": 12,
                    "lines": [
                        {
                            "bbox": [
                                93,
                                680,
                                294,
                                693
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        93,
                                        680,
                                        230,
                                        693
                                    ],
                                    "type": "text",
                                    "content": "The total flops for attention is",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        230,
                                        682,
                                        290,
                                        692
                                    ],
                                    "type": "inline_equation",
                                    "content": "8 b s d ^ { 2 } + 4 b d s ^ { 2 }",
                                    "score": 0.92
                                },
                                {
                                    "bbox": [
                                        290,
                                        680,
                                        294,
                                        693
                                    ],
                                    "type": "text",
                                    "content": ".",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                },
                {
                    "bbox": [
                        83,
                        699,
                        541,
                        723
                    ],
                    "type": "text",
                    "angle": 0,
                    "index": 13,
                    "lines": [
                        {
                            "bbox": [
                                83,
                                698,
                                542,
                                712
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        83,
                                        698,
                                        405,
                                        712
                                    ],
                                    "type": "text",
                                    "content": " Feedforward Layer: In LLaMA-2-7B, the MLP layer first projects to",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        406,
                                        701,
                                        440,
                                        709
                                    ],
                                    "type": "inline_equation",
                                    "content": "2 . 6 8 7 5 d",
                                    "score": 0.59
                                },
                                {
                                    "bbox": [
                                        440,
                                        698,
                                        542,
                                        712
                                    ],
                                    "type": "text",
                                    "content": "with a gated function",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                93,
                                710,
                                542,
                                723
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        93,
                                        710,
                                        172,
                                        723
                                    ],
                                    "type": "text",
                                    "content": "and then back to",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        172,
                                        712,
                                        178,
                                        720
                                    ],
                                    "type": "inline_equation",
                                    "content": "d",
                                    "score": 0.7
                                },
                                {
                                    "bbox": [
                                        179,
                                        710,
                                        294,
                                        723
                                    ],
                                    "type": "text",
                                    "content": ". Each projection requires",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        295,
                                        712,
                                        337,
                                        720
                                    ],
                                    "type": "inline_equation",
                                    "content": "5 . 3 7 5 b s d ^ { 2 }",
                                    "score": 0.74
                                },
                                {
                                    "bbox": [
                                        337,
                                        710,
                                        542,
                                        723
                                    ],
                                    "type": "text",
                                    "content": "flops. With three such operations, the total is",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                }
            ],
            "discarded_blocks": [
                {
                    "bbox": [
                        299,
                        742,
                        311,
                        752
                    ],
                    "type": "page_number",
                    "angle": 0,
                    "index": 14,
                    "lines": [
                        {
                            "bbox": [
                                298,
                                741,
                                313,
                                754
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        298,
                                        741,
                                        313,
                                        754
                                    ],
                                    "type": "text",
                                    "content": "20",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                }
            ],
            "page_size": [
                612,
                792
            ],
            "page_idx": 19
        },
        {
            "para_blocks": [
                {
                    "bbox": [
                        93,
                        64,
                        144,
                        75
                    ],
                    "type": "text",
                    "angle": 0,
                    "index": 0,
                    "lines": [
                        {
                            "bbox": [
                                94,
                                63,
                                145,
                                76
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        94,
                                        64,
                                        141,
                                        76
                                    ],
                                    "type": "inline_equation",
                                    "content": "1 6 . 1 2 5 b s d ^ { 2 }",
                                    "score": 0.6
                                },
                                {
                                    "bbox": [
                                        141,
                                        63,
                                        145,
                                        76
                                    ],
                                    "type": "text",
                                    "content": ".",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                },
                {
                    "bbox": [
                        83,
                        82,
                        543,
                        95
                    ],
                    "type": "text",
                    "angle": 0,
                    "index": 1,
                    "lines": [
                        {
                            "bbox": [
                                83,
                                80,
                                544,
                                96
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        83,
                                        80,
                                        454,
                                        96
                                    ],
                                    "type": "text",
                                    "content": " Total Computation per Layer: Summing the above, each layer requires approximately",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        454,
                                        83,
                                        517,
                                        93
                                    ],
                                    "type": "inline_equation",
                                    "content": "2 4 b s d ^ { 2 } + 4 b d s ^ { 2 }",
                                    "score": 0.93
                                },
                                {
                                    "bbox": [
                                        517,
                                        80,
                                        544,
                                        96
                                    ],
                                    "type": "text",
                                    "content": "flops.",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                },
                {
                    "bbox": [
                        67,
                        99,
                        543,
                        141
                    ],
                    "type": "text",
                    "angle": 0,
                    "index": 2,
                    "lines": [
                        {
                            "bbox": [
                                69,
                                99,
                                543,
                                112
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        99,
                                        163,
                                        112
                                    ],
                                    "type": "text",
                                    "content": "For a sequence length",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        164,
                                        103,
                                        168,
                                        110
                                    ],
                                    "type": "inline_equation",
                                    "content": "s",
                                    "score": 0.73
                                },
                                {
                                    "bbox": [
                                        169,
                                        99,
                                        246,
                                        112
                                    ],
                                    "type": "text",
                                    "content": ", number of layers",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        246,
                                        102,
                                        249,
                                        110
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\it l",
                                    "score": 0.82
                                },
                                {
                                    "bbox": [
                                        250,
                                        99,
                                        317,
                                        112
                                    ],
                                    "type": "text",
                                    "content": ", and batch size",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        317,
                                        102,
                                        321,
                                        110
                                    ],
                                    "type": "inline_equation",
                                    "content": "b",
                                    "score": 0.87
                                },
                                {
                                    "bbox": [
                                        322,
                                        99,
                                        476,
                                        112
                                    ],
                                    "type": "text",
                                    "content": ", the total computation for pre-fill is",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        476,
                                        102,
                                        540,
                                        112
                                    ],
                                    "type": "inline_equation",
                                    "content": "( 2 4 d ^ { 2 } + 4 d s ) l b s",
                                    "score": 0.93
                                },
                                {
                                    "bbox": [
                                        541,
                                        99,
                                        543,
                                        112
                                    ],
                                    "type": "text",
                                    "content": ".",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                69,
                                111,
                                543,
                                125
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        111,
                                        162,
                                        125
                                    ],
                                    "type": "text",
                                    "content": "Given the flop rate",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        162,
                                        113,
                                        168,
                                        124
                                    ],
                                    "type": "inline_equation",
                                    "content": "f",
                                    "score": 0.84
                                },
                                {
                                    "bbox": [
                                        169,
                                        111,
                                        543,
                                        125
                                    ],
                                    "type": "text",
                                    "content": ", the latency for pre-fill is dominated by computation, yielding a final latency of",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                70,
                                123,
                                123,
                                140
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        123,
                                        123,
                                        140
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\frac { ( 2 4 d ^ { 2 } + 4 d s ) l b s } { f }",
                                    "score": 0.93
                                }
                            ]
                        }
                    ]
                },
                {
                    "bbox": [
                        67,
                        152,
                        542,
                        188
                    ],
                    "type": "text",
                    "angle": 0,
                    "index": 3,
                    "lines": [
                        {
                            "bbox": [
                                70,
                                151,
                                542,
                                165
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        151,
                                        542,
                                        165
                                    ],
                                    "type": "text",
                                    "content": "Generation analysis: Memory bounded Analysis For generation latency, existing work have shown that the",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                68,
                                163,
                                542,
                                177
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        163,
                                        542,
                                        177
                                    ],
                                    "type": "text",
                                    "content": "generation process is memory bounded (Shi et al., 2025) which requires transferring KV cache and model",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                176,
                                449,
                                189
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        176,
                                        449,
                                        189
                                    ],
                                    "type": "text",
                                    "content": "parameter to high-bandwidth memory, we analyse the data transfer latency as follows:",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                },
                {
                    "bbox": [
                        83,
                        194,
                        169,
                        205
                    ],
                    "type": "title",
                    "angle": 0,
                    "index": 4,
                    "lines": [
                        {
                            "bbox": [
                                84,
                                192,
                                170,
                                209
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        84,
                                        192,
                                        170,
                                        209
                                    ],
                                    "type": "text",
                                    "content": " Memory Latency:",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                },
                {
                    "bbox": [
                        102,
                        211,
                        541,
                        254
                    ],
                    "type": "list",
                    "angle": 0,
                    "index": 7,
                    "blocks": [
                        {
                            "bbox": [
                                102,
                                211,
                                541,
                                236
                            ],
                            "type": "text",
                            "angle": 0,
                            "index": 5,
                            "lines": [
                                {
                                    "bbox": [
                                        104,
                                        209,
                                        542,
                                        225
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                104,
                                                209,
                                                239,
                                                225
                                            ],
                                            "type": "text",
                                            "content": " KV Cache Data: Requires",
                                            "score": 1.0
                                        },
                                        {
                                            "bbox": [
                                                239,
                                                213,
                                                288,
                                                224
                                            ],
                                            "type": "inline_equation",
                                            "content": "4 d l b ( s + o )",
                                            "score": 0.9
                                        },
                                        {
                                            "bbox": [
                                                289,
                                                209,
                                                542,
                                                225
                                            ],
                                            "type": "text",
                                            "content": "bytes (bfloat16 uses 2 bytes per number, and there are",
                                            "score": 1.0
                                        }
                                    ]
                                },
                                {
                                    "bbox": [
                                        115,
                                        224,
                                        236,
                                        237
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                115,
                                                224,
                                                236,
                                                237
                                            ],
                                            "type": "text",
                                            "content": "separate key/value copies).",
                                            "score": 1.0
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "bbox": [
                                103,
                                242,
                                280,
                                254
                            ],
                            "type": "text",
                            "angle": 0,
                            "index": 6,
                            "lines": [
                                {
                                    "bbox": [
                                        105,
                                        240,
                                        282,
                                        255
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                105,
                                                240,
                                                239,
                                                255
                                            ],
                                            "type": "text",
                                            "content": " Model Parameters: Require",
                                            "score": 1.0
                                        },
                                        {
                                            "bbox": [
                                                239,
                                                245,
                                                251,
                                                251
                                            ],
                                            "type": "inline_equation",
                                            "content": "2 n",
                                            "score": 0.57
                                        },
                                        {
                                            "bbox": [
                                                252,
                                                240,
                                                282,
                                                255
                                            ],
                                            "type": "text",
                                            "content": "bytes.",
                                            "score": 1.0
                                        }
                                    ]
                                }
                            ]
                        }
                    ],
                    "sub_type": "text"
                },
                {
                    "bbox": [
                        92,
                        258,
                        397,
                        276
                    ],
                    "type": "text",
                    "angle": 0,
                    "index": 8,
                    "lines": [
                        {
                            "bbox": [
                                91,
                                257,
                                394,
                                275
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        91,
                                        257,
                                        342,
                                        275
                                    ],
                                    "type": "text",
                                    "content": "The data transfer latency to high-bandwidth memory is",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        342,
                                        260,
                                        394,
                                        274
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\frac { 2 n + 4 d l b ( s + o ) } { m }",
                                    "score": 0.93
                                }
                            ]
                        }
                    ]
                },
                {
                    "bbox": [
                        67,
                        286,
                        541,
                        309
                    ],
                    "type": "text",
                    "angle": 0,
                    "index": 9,
                    "lines": [
                        {
                            "bbox": [
                                69,
                                284,
                                542,
                                301
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        284,
                                        542,
                                        301
                                    ],
                                    "type": "text",
                                    "content": "Throughput Calculation The throughput, defined as the number of tokens generated per unit time, is given",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                69,
                                297,
                                86,
                                312
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        297,
                                        86,
                                        312
                                    ],
                                    "type": "text",
                                    "content": "by:",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                },
                {
                    "bbox": [
                        241,
                        308,
                        368,
                        332
                    ],
                    "type": "interline_equation",
                    "angle": 0,
                    "lines": [
                        {
                            "bbox": [
                                241,
                                308,
                                368,
                                332
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        241,
                                        308,
                                        368,
                                        332
                                    ],
                                    "type": "interline_equation",
                                    "content": "\\text {T h r o u g h p u t} = \\frac {b o}{\\mathrm {T T F T} + \\mathrm {D L}}",
                                    "image_path": "e9fdf42a844ee6bda22e467799cc78f20e96218fb96b7254ca2bdd75503c4a7b.jpg"
                                }
                            ]
                        }
                    ],
                    "index": 10
                },
                {
                    "bbox": [
                        67,
                        336,
                        199,
                        348
                    ],
                    "type": "text",
                    "angle": 0,
                    "index": 11,
                    "lines": [
                        {
                            "bbox": [
                                69,
                                335,
                                200,
                                350
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        335,
                                        200,
                                        350
                                    ],
                                    "type": "text",
                                    "content": "where DL is the data latency.",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "table",
                    "bbox": [
                        170,
                        357,
                        440,
                        432
                    ],
                    "blocks": [
                        {
                            "bbox": [
                                170,
                                357,
                                440,
                                432
                            ],
                            "lines": [
                                {
                                    "bbox": [
                                        170,
                                        357,
                                        440,
                                        432
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                170,
                                                357,
                                                440,
                                                432
                                            ],
                                            "type": "table",
                                            "html": "<table><tr><td></td><td>Before</td><td>After</td></tr><tr><td>KV cache memory</td><td>4ddb(s + o)</td><td>4ddb( s/k + o)</td></tr><tr><td>TTFT</td><td>(24d2+4ds)lbsf</td><td>(24d2+4ds/k)lbsk/f</td></tr><tr><td>TTIT</td><td>2n+4ddb(s+o)</td><td>2n+4ddb( s/k + o)</td></tr><tr><td rowspan=\"2\">Throughput</td><td>mbo</td><td>mbo</td></tr><tr><td>TTFTbefore+TTITbefore</td><td>TTFTafter+TTITafter</td></tr></table>",
                                            "image_path": "458d563544dcfd7191cc6dbe924b4e1a922c4bd72ee52ac68da978148f502ca9.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 12,
                            "angle": 0,
                            "type": "table_body"
                        },
                        {
                            "bbox": [
                                67,
                                440,
                                541,
                                463
                            ],
                            "lines": [
                                {
                                    "bbox": [
                                        69,
                                        440,
                                        542,
                                        453
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                69,
                                                440,
                                                542,
                                                453
                                            ],
                                            "type": "text",
                                            "content": "Table 9 Comparison of KV cache memory usage, TTFT, generation latency and throughput between the original",
                                            "score": 1.0
                                        }
                                    ]
                                },
                                {
                                    "bbox": [
                                        69,
                                        451,
                                        194,
                                        463
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                69,
                                                451,
                                                194,
                                                463
                                            ],
                                            "type": "text",
                                            "content": "LLaMA model and our model.",
                                            "score": 1.0
                                        }
                                    ]
                                }
                            ],
                            "index": 13,
                            "angle": 0,
                            "type": "table_caption"
                        }
                    ],
                    "index": 12
                },
                {
                    "bbox": [
                        67,
                        485,
                        544,
                        512
                    ],
                    "type": "title",
                    "angle": 0,
                    "index": 14,
                    "lines": [
                        {
                            "bbox": [
                                66,
                                482,
                                545,
                                500
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        66,
                                        482,
                                        545,
                                        500
                                    ],
                                    "type": "text",
                                    "content": "B.5 Additional details on empirical measurement of latency and memory improvement in fig-",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                95,
                                498,
                                231,
                                513
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        95,
                                        498,
                                        231,
                                        513
                                    ],
                                    "type": "text",
                                    "content": "ure 2, figure 9 and figure 8",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                },
                {
                    "bbox": [
                        66,
                        518,
                        543,
                        543
                    ],
                    "type": "text",
                    "angle": 0,
                    "index": 15,
                    "lines": [
                        {
                            "bbox": [
                                69,
                                518,
                                543,
                                530
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        518,
                                        543,
                                        530
                                    ],
                                    "type": "text",
                                    "content": "We measure the latency and memory usage in a controlled environment which aims to reduce other environ-",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                529,
                                341,
                                543
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        529,
                                        341,
                                        543
                                    ],
                                    "type": "text",
                                    "content": "mental factors that could make certain method advantageous.",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                },
                {
                    "bbox": [
                        66,
                        548,
                        543,
                        596
                    ],
                    "type": "text",
                    "angle": 0,
                    "index": 16,
                    "lines": [
                        {
                            "bbox": [
                                68,
                                548,
                                543,
                                561
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        548,
                                        543,
                                        561
                                    ],
                                    "type": "text",
                                    "content": "To this end, our implementation uses the same modelling file which means different baselines share the same",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                559,
                                543,
                                573
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        559,
                                        543,
                                        573
                                    ],
                                    "type": "text",
                                    "content": "hyper-parameter and acceleration (e.g., flash-attention). Therefore, we restrict the factors that affect the",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                571,
                                543,
                                586
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        571,
                                        543,
                                        586
                                    ],
                                    "type": "text",
                                    "content": "resource usage only among the model designs. We use the batch size of 1 and use a single A100 card to",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                68,
                                585,
                                217,
                                597
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        585,
                                        217,
                                        597
                                    ],
                                    "type": "text",
                                    "content": "measure the system performance.",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                },
                {
                    "bbox": [
                        67,
                        614,
                        287,
                        629
                    ],
                    "type": "title",
                    "angle": 0,
                    "index": 17,
                    "lines": [
                        {
                            "bbox": [
                                67,
                                612,
                                287,
                                632
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        612,
                                        287,
                                        632
                                    ],
                                    "type": "text",
                                    "content": "C Additional Experimental Results",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                },
                {
                    "bbox": [
                        66,
                        639,
                        542,
                        712
                    ],
                    "type": "text",
                    "angle": 0,
                    "index": 18,
                    "lines": [
                        {
                            "bbox": [
                                70,
                                640,
                                542,
                                653
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        70,
                                        640,
                                        542,
                                        653
                                    ],
                                    "type": "text",
                                    "content": "Sparse attention across different retrieved passages. We retrieve 200 passages using the query how bruce",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                69,
                                652,
                                543,
                                665
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        652,
                                        543,
                                        665
                                    ],
                                    "type": "text",
                                    "content": "lee died from our retrieval corpus. We choose 5 passages that are different from each other (table 10) to",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                68,
                                664,
                                542,
                                677
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        664,
                                        542,
                                        677
                                    ],
                                    "type": "text",
                                    "content": "simulate the de-duplication process in real RAG applications. We concatenate these 5 passages and feed it",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                68,
                                676,
                                542,
                                689
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        676,
                                        542,
                                        689
                                    ],
                                    "type": "text",
                                    "content": "to LLaMA-2-7B-Chat model to see the attention values between different tokens. Figure 7 shows that the",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                68,
                                687,
                                542,
                                701
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        687,
                                        542,
                                        701
                                    ],
                                    "type": "text",
                                    "content": "attention values for tokens within each passages are significantly larger than attention values for tokens in",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                68,
                                699,
                                532,
                                713
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        699,
                                        532,
                                        713
                                    ],
                                    "type": "text",
                                    "content": "different passages which suggests redundancy in the current attention computation for RAG applications.",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                }
            ],
            "discarded_blocks": [
                {
                    "bbox": [
                        299,
                        742,
                        310,
                        752
                    ],
                    "type": "page_number",
                    "angle": 0,
                    "index": 19,
                    "lines": [
                        {
                            "bbox": [
                                298,
                                742,
                                312,
                                755
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        298,
                                        742,
                                        312,
                                        755
                                    ],
                                    "type": "text",
                                    "content": "21",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                }
            ],
            "page_size": [
                612,
                792
            ],
            "page_idx": 20
        },
        {
            "para_blocks": [
                {
                    "type": "image",
                    "bbox": [
                        187,
                        65,
                        422,
                        526
                    ],
                    "blocks": [
                        {
                            "bbox": [
                                187,
                                65,
                                422,
                                526
                            ],
                            "lines": [
                                {
                                    "bbox": [
                                        187,
                                        65,
                                        422,
                                        526
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                187,
                                                65,
                                                422,
                                                526
                                            ],
                                            "type": "image",
                                            "image_path": "a412f6ecefb6abd94d16c8b4d0432842743407c9d9359c0fd4be8bd3b3f03744.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 0,
                            "angle": 0,
                            "type": "image_body"
                        },
                        {
                            "bbox": [
                                67,
                                536,
                                544,
                                571
                            ],
                            "lines": [
                                {
                                    "bbox": [
                                        69,
                                        536,
                                        543,
                                        548
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                69,
                                                536,
                                                543,
                                                548
                                            ],
                                            "type": "text",
                                            "content": "Figure 7 Attention value visualization for different retrieved passages for different layers for LLaMA-2-7B-Chat model.",
                                            "score": 1.0
                                        }
                                    ]
                                },
                                {
                                    "bbox": [
                                        69,
                                        547,
                                        542,
                                        559
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                69,
                                                547,
                                                542,
                                                559
                                            ],
                                            "type": "text",
                                            "content": "The diagonal values are the averaged attention value for tokens within each passage while the off-diagonal values are",
                                            "score": 1.0
                                        }
                                    ]
                                },
                                {
                                    "bbox": [
                                        69,
                                        558,
                                        536,
                                        571
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                69,
                                                558,
                                                536,
                                                571
                                            ],
                                            "type": "text",
                                            "content": "the averaged attention value between tokens from different passages. The detail of retrieved passages is in table 10.",
                                            "score": 1.0
                                        }
                                    ]
                                }
                            ],
                            "index": 1,
                            "angle": 0,
                            "type": "image_caption"
                        }
                    ],
                    "index": 0
                },
                {
                    "bbox": [
                        67,
                        590,
                        543,
                        616
                    ],
                    "type": "text",
                    "angle": 0,
                    "index": 2,
                    "lines": [
                        {
                            "bbox": [
                                69,
                                590,
                                543,
                                604
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        590,
                                        543,
                                        604
                                    ],
                                    "type": "text",
                                    "content": "Additional results in latency measurement. Figure 9 and figure 8 shows the latency comparison of different",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                601,
                                427,
                                616
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        601,
                                        155,
                                        616
                                    ],
                                    "type": "text",
                                    "content": "models when using",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        156,
                                        605,
                                        179,
                                        613
                                    ],
                                    "type": "inline_equation",
                                    "content": "k = 8",
                                    "score": 0.9
                                },
                                {
                                    "bbox": [
                                        180,
                                        601,
                                        201,
                                        616
                                    ],
                                    "type": "text",
                                    "content": "and",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        202,
                                        605,
                                        231,
                                        613
                                    ],
                                    "type": "inline_equation",
                                    "content": "k = 3 2",
                                    "score": 0.9
                                },
                                {
                                    "bbox": [
                                        231,
                                        601,
                                        427,
                                        616
                                    ],
                                    "type": "text",
                                    "content": "compression rate for REFRAGrespectively.",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                },
                {
                    "bbox": [
                        67,
                        628,
                        543,
                        654
                    ],
                    "type": "text",
                    "angle": 0,
                    "index": 3,
                    "lines": [
                        {
                            "bbox": [
                                69,
                                628,
                                542,
                                641
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        628,
                                        542,
                                        641
                                    ],
                                    "type": "text",
                                    "content": "Ablation study result for curriculum learning. Table 11 shows the necessity of curriculum learning to the",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                68,
                                641,
                                203,
                                653
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        641,
                                        203,
                                        653
                                    ],
                                    "type": "text",
                                    "content": "success of reconstruction task.",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                },
                {
                    "bbox": [
                        67,
                        666,
                        543,
                        691
                    ],
                    "type": "text",
                    "angle": 0,
                    "index": 4,
                    "lines": [
                        {
                            "bbox": [
                                69,
                                666,
                                543,
                                680
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        666,
                                        543,
                                        680
                                    ],
                                    "type": "text",
                                    "content": "Ablation study result for reconstruction task. Table 12 shows the performance comparison in CPT with and",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                68,
                                678,
                                267,
                                690
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        678,
                                        267,
                                        690
                                    ],
                                    "type": "text",
                                    "content": "without continuing from reconstruction task.",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                }
            ],
            "discarded_blocks": [
                {
                    "bbox": [
                        299,
                        742,
                        312,
                        752
                    ],
                    "type": "page_number",
                    "angle": 0,
                    "index": 5,
                    "lines": [
                        {
                            "bbox": [
                                298,
                                742,
                                313,
                                755
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        298,
                                        742,
                                        313,
                                        755
                                    ],
                                    "type": "text",
                                    "content": "22",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                }
            ],
            "page_size": [
                612,
                792
            ],
            "page_idx": 21
        },
        {
            "para_blocks": [
                {
                    "type": "image",
                    "bbox": [
                        118,
                        64,
                        237,
                        163
                    ],
                    "blocks": [
                        {
                            "bbox": [
                                118,
                                64,
                                237,
                                163
                            ],
                            "lines": [
                                {
                                    "bbox": [
                                        118,
                                        64,
                                        237,
                                        163
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                118,
                                                64,
                                                237,
                                                163
                                            ],
                                            "type": "image",
                                            "image_path": "a3352e52968d2bbf677778cb8dc17e1b4fc64e60dbdd6e11ef72566d79af8f3d.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 0,
                            "angle": 0,
                            "type": "image_body"
                        }
                    ],
                    "index": 0
                },
                {
                    "type": "image",
                    "bbox": [
                        242,
                        64,
                        361,
                        163
                    ],
                    "blocks": [
                        {
                            "bbox": [
                                242,
                                64,
                                361,
                                163
                            ],
                            "lines": [
                                {
                                    "bbox": [
                                        242,
                                        64,
                                        361,
                                        163
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                242,
                                                64,
                                                361,
                                                163
                                            ],
                                            "type": "image",
                                            "image_path": "a7d0f19a04cf7d49bcdf265f673df6d0bd914d54f4d35348e4077bf93cc19a2b.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 1,
                            "angle": 0,
                            "type": "image_body"
                        }
                    ],
                    "index": 1
                },
                {
                    "type": "image",
                    "bbox": [
                        369,
                        64,
                        492,
                        163
                    ],
                    "blocks": [
                        {
                            "bbox": [
                                369,
                                64,
                                492,
                                163
                            ],
                            "lines": [
                                {
                                    "bbox": [
                                        369,
                                        64,
                                        492,
                                        163
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                369,
                                                64,
                                                492,
                                                163
                                            ],
                                            "type": "image",
                                            "image_path": "674a08ec0c71d97b4700d814d2746d0e49504d5652e9ee1ee200ecca772d1a98.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 2,
                            "angle": 0,
                            "type": "image_body"
                        }
                    ],
                    "index": 2
                },
                {
                    "type": "image",
                    "bbox": [
                        160,
                        172,
                        441,
                        186
                    ],
                    "blocks": [
                        {
                            "bbox": [
                                160,
                                172,
                                441,
                                186
                            ],
                            "lines": [
                                {
                                    "bbox": [
                                        160,
                                        172,
                                        441,
                                        186
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                160,
                                                172,
                                                441,
                                                186
                                            ],
                                            "type": "image",
                                            "image_path": "0f53e8d396fa2966dcbb557a435b06caf9245a7b52fc368ac81dcd50f7a6e2df.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 3,
                            "angle": 0,
                            "type": "image_body"
                        },
                        {
                            "bbox": [
                                67,
                                198,
                                403,
                                210
                            ],
                            "lines": [
                                {
                                    "bbox": [
                                        68,
                                        198,
                                        400,
                                        211
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                68,
                                                198,
                                                373,
                                                211
                                            ],
                                            "type": "text",
                                            "content": "Figure 8 Empirical verification of inference acceleration of REFRAG with",
                                            "score": 1.0
                                        },
                                        {
                                            "bbox": [
                                                373,
                                                201,
                                                400,
                                                209
                                            ],
                                            "type": "inline_equation",
                                            "content": "k = 3 2",
                                            "score": 0.89
                                        }
                                    ]
                                }
                            ],
                            "index": 4,
                            "angle": 0,
                            "type": "image_caption"
                        }
                    ],
                    "index": 3
                },
                {
                    "type": "image",
                    "bbox": [
                        118,
                        223,
                        236,
                        322
                    ],
                    "blocks": [
                        {
                            "bbox": [
                                118,
                                223,
                                236,
                                322
                            ],
                            "lines": [
                                {
                                    "bbox": [
                                        118,
                                        223,
                                        236,
                                        322
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                118,
                                                223,
                                                236,
                                                322
                                            ],
                                            "type": "image",
                                            "image_path": "658d5889b2bf29759bf218c1149a3285d1103861b7c75835a80b421d9fed901c.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 5,
                            "angle": 0,
                            "type": "image_body"
                        }
                    ],
                    "index": 5
                },
                {
                    "type": "image",
                    "bbox": [
                        242,
                        223,
                        361,
                        322
                    ],
                    "blocks": [
                        {
                            "bbox": [
                                242,
                                223,
                                361,
                                322
                            ],
                            "lines": [
                                {
                                    "bbox": [
                                        242,
                                        223,
                                        361,
                                        322
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                242,
                                                223,
                                                361,
                                                322
                                            ],
                                            "type": "image",
                                            "image_path": "8d0a367f6a1ae075366f9f2fd83ca69f9480c65889c87110b39e1cc19cf4b5b0.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 6,
                            "angle": 0,
                            "type": "image_body"
                        }
                    ],
                    "index": 6
                },
                {
                    "type": "image",
                    "bbox": [
                        370,
                        223,
                        492,
                        322
                    ],
                    "blocks": [
                        {
                            "bbox": [
                                370,
                                223,
                                492,
                                322
                            ],
                            "lines": [
                                {
                                    "bbox": [
                                        370,
                                        223,
                                        492,
                                        322
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                370,
                                                223,
                                                492,
                                                322
                                            ],
                                            "type": "image",
                                            "image_path": "bc55d4ed3815cb3bbc70b861138c2a0cef0c6915a0ecb68ed3555215b21e3af1.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 7,
                            "angle": 0,
                            "type": "image_body"
                        }
                    ],
                    "index": 7
                },
                {
                    "type": "image",
                    "bbox": [
                        160,
                        331,
                        441,
                        345
                    ],
                    "blocks": [
                        {
                            "bbox": [
                                160,
                                331,
                                441,
                                345
                            ],
                            "lines": [
                                {
                                    "bbox": [
                                        160,
                                        331,
                                        441,
                                        345
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                160,
                                                331,
                                                441,
                                                345
                                            ],
                                            "type": "image",
                                            "image_path": "1cda28df02caa26b56246a661ee50881ef66a1f2f6fb0bfbecbc40f159cf25ce.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 8,
                            "angle": 0,
                            "type": "image_body"
                        },
                        {
                            "bbox": [
                                67,
                                358,
                                398,
                                369
                            ],
                            "lines": [
                                {
                                    "bbox": [
                                        68,
                                        357,
                                        396,
                                        370
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                68,
                                                357,
                                                373,
                                                370
                                            ],
                                            "type": "text",
                                            "content": "Figure 9 Empirical verification of inference acceleration of REFRAG with",
                                            "score": 1.0
                                        },
                                        {
                                            "bbox": [
                                                373,
                                                361,
                                                396,
                                                368
                                            ],
                                            "type": "inline_equation",
                                            "content": "k = 8",
                                            "score": 0.91
                                        }
                                    ]
                                }
                            ],
                            "index": 9,
                            "angle": 0,
                            "type": "image_caption"
                        }
                    ],
                    "index": 8
                },
                {
                    "bbox": [
                        67,
                        391,
                        541,
                        415
                    ],
                    "type": "text",
                    "angle": 0,
                    "index": 10,
                    "lines": [
                        {
                            "bbox": [
                                69,
                                390,
                                542,
                                403
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        390,
                                        542,
                                        403
                                    ],
                                    "type": "text",
                                    "content": "Ablation study result for the advantage of RL. Table 13 shows the advantage of using our selective compression",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                402,
                                329,
                                416
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        402,
                                        329,
                                        416
                                    ],
                                    "type": "text",
                                    "content": "policy via RL compared to using a lower compression rate.",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                },
                {
                    "bbox": [
                        67,
                        429,
                        541,
                        452
                    ],
                    "type": "text",
                    "angle": 0,
                    "index": 11,
                    "lines": [
                        {
                            "bbox": [
                                69,
                                426,
                                542,
                                443
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        426,
                                        542,
                                        443
                                    ],
                                    "type": "text",
                                    "content": "Ablation study result of different compression rates. Figure 10 shows the loss trajectory for different com-",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                440,
                                192,
                                453
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        440,
                                        192,
                                        453
                                    ],
                                    "type": "text",
                                    "content": "pression rate of REFRAG.",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                },
                {
                    "bbox": [
                        67,
                        466,
                        541,
                        502
                    ],
                    "type": "text",
                    "angle": 0,
                    "index": 12,
                    "lines": [
                        {
                            "bbox": [
                                68,
                                465,
                                542,
                                479
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        465,
                                        542,
                                        479
                                    ],
                                    "type": "text",
                                    "content": "Ablation study result of different combination of encoder and decoder models. Figure 11 shows the performance",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                476,
                                542,
                                491
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        476,
                                        542,
                                        491
                                    ],
                                    "type": "text",
                                    "content": "of CPT with different combination of encoder and decoder models. Table 14 shows the performance on",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                68,
                                490,
                                257,
                                502
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        490,
                                        257,
                                        502
                                    ],
                                    "type": "text",
                                    "content": "LLaMA-3.1-8B and LLaMA-3.2-3B model.",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                },
                {
                    "bbox": [
                        67,
                        516,
                        541,
                        541
                    ],
                    "type": "text",
                    "angle": 0,
                    "index": 13,
                    "lines": [
                        {
                            "bbox": [
                                69,
                                516,
                                542,
                                528
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        516,
                                        542,
                                        528
                                    ],
                                    "type": "text",
                                    "content": "Additional results in RAG. Table 16 shows the performance of different baselines under the same number of",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                68,
                                528,
                                542,
                                541
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        528,
                                        542,
                                        541
                                    ],
                                    "type": "text",
                                    "content": "context. The performance of our model is similar to other methods, in other words no model significantly",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "image",
                    "bbox": [
                        190,
                        561,
                        419,
                        696
                    ],
                    "blocks": [
                        {
                            "bbox": [
                                190,
                                561,
                                419,
                                696
                            ],
                            "lines": [
                                {
                                    "bbox": [
                                        190,
                                        561,
                                        419,
                                        696
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                190,
                                                561,
                                                419,
                                                696
                                            ],
                                            "type": "image",
                                            "image_path": "f2c1903d3fd0ed27b734c8bf95233ad823d5591afc8391225912f3eda182440e.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 14,
                            "angle": 0,
                            "type": "image_body"
                        },
                        {
                            "bbox": [
                                67,
                                707,
                                375,
                                718
                            ],
                            "lines": [
                                {
                                    "bbox": [
                                        68,
                                        705,
                                        378,
                                        720
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                68,
                                                705,
                                                378,
                                                720
                                            ],
                                            "type": "text",
                                            "content": "Figure 10 Training trajectory for our model with different compression rate.",
                                            "score": 1.0
                                        }
                                    ]
                                }
                            ],
                            "index": 15,
                            "angle": 0,
                            "type": "image_caption"
                        }
                    ],
                    "index": 14
                }
            ],
            "discarded_blocks": [
                {
                    "bbox": [
                        299,
                        742,
                        310,
                        751
                    ],
                    "type": "page_number",
                    "angle": 0,
                    "index": 16,
                    "lines": [
                        {
                            "bbox": [
                                298,
                                741,
                                312,
                                754
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        298,
                                        741,
                                        312,
                                        754
                                    ],
                                    "type": "text",
                                    "content": "23",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                }
            ],
            "page_size": [
                612,
                792
            ],
            "page_idx": 22
        },
        {
            "para_blocks": [
                {
                    "type": "image",
                    "bbox": [
                        95,
                        64,
                        299,
                        185
                    ],
                    "blocks": [
                        {
                            "bbox": [
                                95,
                                64,
                                299,
                                185
                            ],
                            "lines": [
                                {
                                    "bbox": [
                                        95,
                                        64,
                                        299,
                                        185
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                95,
                                                64,
                                                299,
                                                185
                                            ],
                                            "type": "image",
                                            "image_path": "34371880ece919a10da08d55b2888ddff98c3dc86c159ce0894fc2bcc020cacb.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 0,
                            "angle": 0,
                            "type": "image_body"
                        }
                    ],
                    "index": 0
                },
                {
                    "type": "image",
                    "bbox": [
                        310,
                        64,
                        515,
                        185
                    ],
                    "blocks": [
                        {
                            "bbox": [
                                310,
                                64,
                                515,
                                185
                            ],
                            "lines": [
                                {
                                    "bbox": [
                                        310,
                                        64,
                                        515,
                                        185
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                310,
                                                64,
                                                515,
                                                185
                                            ],
                                            "type": "image",
                                            "image_path": "1bb2f78b5de5348d4b3c5f1871c07be4e6a50bfeab0910ca7e2cb0e389eaed55.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 1,
                            "angle": 0,
                            "type": "image_body"
                        }
                    ],
                    "index": 1
                },
                {
                    "type": "image",
                    "bbox": [
                        202,
                        234,
                        408,
                        355
                    ],
                    "blocks": [
                        {
                            "bbox": [
                                67,
                                198,
                                541,
                                220
                            ],
                            "lines": [
                                {
                                    "bbox": [
                                        69,
                                        198,
                                        542,
                                        210
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                69,
                                                198,
                                                542,
                                                210
                                            ],
                                            "type": "text",
                                            "content": "Figure 11 Training trajectory for different encoder and decoder combinations. On the left, we have two different decoder",
                                            "score": 1.0
                                        }
                                    ]
                                },
                                {
                                    "bbox": [
                                        69,
                                        209,
                                        490,
                                        220
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                69,
                                                209,
                                                490,
                                                220
                                            ],
                                            "type": "text",
                                            "content": "the Roberta-Base encoder. On the right we have two different encoder for LLaMA-2-7B decoder model.",
                                            "score": 1.0
                                        }
                                    ]
                                }
                            ],
                            "index": 2,
                            "angle": 0,
                            "type": "image_caption"
                        },
                        {
                            "bbox": [
                                202,
                                234,
                                408,
                                355
                            ],
                            "lines": [
                                {
                                    "bbox": [
                                        202,
                                        234,
                                        408,
                                        355
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                202,
                                                234,
                                                408,
                                                355
                                            ],
                                            "type": "image",
                                            "image_path": "4351376ba5119795c140d5dc055f006af8bc78005cf3c12d6d7f0bfac7030b2b.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 3,
                            "angle": 0,
                            "type": "image_body"
                        },
                        {
                            "bbox": [
                                67,
                                366,
                                418,
                                379
                            ],
                            "lines": [
                                {
                                    "bbox": [
                                        69,
                                        367,
                                        419,
                                        379
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                69,
                                                367,
                                                419,
                                                379
                                            ],
                                            "type": "text",
                                            "content": "Figure 12 Training trajectory for different encoder paired with LLaMA-2-13B decoder.",
                                            "score": 1.0
                                        }
                                    ]
                                }
                            ],
                            "index": 4,
                            "angle": 0,
                            "type": "image_caption"
                        }
                    ],
                    "index": 3
                },
                {
                    "bbox": [
                        67,
                        399,
                        541,
                        422
                    ],
                    "type": "text",
                    "angle": 0,
                    "index": 5,
                    "lines": [
                        {
                            "bbox": [
                                67,
                                398,
                                543,
                                412
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        398,
                                        543,
                                        412
                                    ],
                                    "type": "text",
                                    "content": "outperforms others. Table 15 shows the performance of REFRAG under different number of context for",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                410,
                                175,
                                425
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        410,
                                        175,
                                        425
                                    ],
                                    "type": "text",
                                    "content": "strong retriever setting.",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                },
                {
                    "bbox": [
                        67,
                        437,
                        541,
                        485
                    ],
                    "type": "text",
                    "angle": 0,
                    "index": 6,
                    "lines": [
                        {
                            "bbox": [
                                69,
                                437,
                                542,
                                449
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        437,
                                        542,
                                        449
                                    ],
                                    "type": "text",
                                    "content": "Demonstration of generated summary for Arxiv and Pubmed articles. Table 20 and table 19 shows the ground",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                68,
                                448,
                                543,
                                463
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        448,
                                        543,
                                        463
                                    ],
                                    "type": "text",
                                    "content": "true abstract for different articles and the generated summary from REFRAG. These results complement the",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                460,
                                543,
                                475
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        460,
                                        543,
                                        475
                                    ],
                                    "type": "text",
                                    "content": "perplexity results we have shown in CPT and accuracy/F1 performance we have shown in RAG and other",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                473,
                                127,
                                485
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        473,
                                        127,
                                        485
                                    ],
                                    "type": "text",
                                    "content": "applications.",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                },
                {
                    "bbox": [
                        67,
                        500,
                        376,
                        514
                    ],
                    "type": "title",
                    "angle": 0,
                    "index": 7,
                    "lines": [
                        {
                            "bbox": [
                                69,
                                498,
                                378,
                                514
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        498,
                                        378,
                                        514
                                    ],
                                    "type": "text",
                                    "content": "C.1 Additional Contextual Application - Summarization Task",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                },
                {
                    "bbox": [
                        67,
                        519,
                        541,
                        602
                    ],
                    "type": "text",
                    "angle": 0,
                    "index": 8,
                    "lines": [
                        {
                            "bbox": [
                                68,
                                518,
                                542,
                                533
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        518,
                                        542,
                                        533
                                    ],
                                    "type": "text",
                                    "content": "We fine-tune our model on the long document summarization dataset (Cohan et al., 2018). This dataset",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                69,
                                531,
                                541,
                                543
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        531,
                                        541,
                                        543
                                    ],
                                    "type": "text",
                                    "content": "contains long scientific articles from Arxiv and Pubmed, and the task is to generate the abstract given the",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                69,
                                543,
                                542,
                                556
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        543,
                                        542,
                                        556
                                    ],
                                    "type": "text",
                                    "content": "entire article. This application is challenging due to the long-context nature of the task. We fine-tune the",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                69,
                                555,
                                542,
                                568
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        555,
                                        542,
                                        568
                                    ],
                                    "type": "text",
                                    "content": "REFRAG and LLaMA models on these two datasets and report the performance on the validation set. The",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                567,
                                542,
                                580
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        567,
                                        542,
                                        580
                                    ],
                                    "type": "text",
                                    "content": "summarization task provides an ideal condition to inspect whether it is beneficial to bring more information",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                578,
                                542,
                                593
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        578,
                                        542,
                                        593
                                    ],
                                    "type": "text",
                                    "content": "with compressed representation or less information without compression, since correct summarization requires",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                69,
                                592,
                                282,
                                604
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        592,
                                        282,
                                        604
                                    ],
                                    "type": "text",
                                    "content": "complete information from the whole document.",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                },
                {
                    "bbox": [
                        67,
                        609,
                        541,
                        693
                    ],
                    "type": "text",
                    "angle": 0,
                    "index": 9,
                    "lines": [
                        {
                            "bbox": [
                                68,
                                609,
                                542,
                                622
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        609,
                                        542,
                                        622
                                    ],
                                    "type": "text",
                                    "content": "Result analysis. Table 21 shows the performance of different baselines under the same number of tokens in the",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                618,
                                544,
                                637
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        618,
                                        544,
                                        637
                                    ],
                                    "type": "text",
                                    "content": "decoder. REPLUGFT means that we adopt the REPLUG framework using LLaMAFT, and REPLUGChat",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                632,
                                543,
                                647
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        632,
                                        543,
                                        647
                                    ],
                                    "type": "text",
                                    "content": "means that we adopt the LLaMA-2-7B-Chat model for REPLUG. We did not report some of our methods for",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                68,
                                645,
                                542,
                                657
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        645,
                                        542,
                                        657
                                    ],
                                    "type": "text",
                                    "content": "certain decoder token counts since there were not enough input tokens for those compression rates. Our model",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                67,
                                655,
                                544,
                                671
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        67,
                                        655,
                                        544,
                                        671
                                    ],
                                    "type": "text",
                                    "content": "achieves the best performance under the same number of decoder tokens (i.e., same latency). Additionally,",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                69,
                                670,
                                542,
                                681
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        670,
                                        272,
                                        681
                                    ],
                                    "type": "text",
                                    "content": "REFRAG16 performs better than REFRAG",
                                    "score": 1.0
                                },
                                {
                                    "bbox": [
                                        272,
                                        676,
                                        277,
                                        681
                                    ],
                                    "type": "inline_equation",
                                    "content": "\\aleph",
                                    "score": 0.59
                                },
                                {
                                    "bbox": [
                                        277,
                                        670,
                                        542,
                                        681
                                    ],
                                    "type": "text",
                                    "content": "at a decoder token count of 128, since the former model is",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                68,
                                681,
                                461,
                                694
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        68,
                                        681,
                                        461,
                                        694
                                    ],
                                    "type": "text",
                                    "content": "able to incorporate more information from the document with a higher compression rate.",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                }
            ],
            "discarded_blocks": [
                {
                    "bbox": [
                        299,
                        742,
                        311,
                        752
                    ],
                    "type": "page_number",
                    "angle": 0,
                    "index": 10,
                    "lines": [
                        {
                            "bbox": [
                                298,
                                741,
                                313,
                                756
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        298,
                                        741,
                                        313,
                                        756
                                    ],
                                    "type": "text",
                                    "content": "24",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                }
            ],
            "page_size": [
                612,
                792
            ],
            "page_idx": 23
        },
        {
            "para_blocks": [
                {
                    "type": "table",
                    "bbox": [
                        105,
                        97,
                        504,
                        708
                    ],
                    "blocks": [
                        {
                            "bbox": [
                                68,
                                76,
                                347,
                                87
                            ],
                            "lines": [
                                {
                                    "bbox": [
                                        69,
                                        75,
                                        349,
                                        88
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                69,
                                                75,
                                                349,
                                                88
                                            ],
                                            "type": "text",
                                            "content": "Table 10 The 5 retrieved passages for the query how bruce lee died.",
                                            "score": 1.0
                                        }
                                    ]
                                }
                            ],
                            "index": 0,
                            "angle": 0,
                            "type": "table_caption"
                        },
                        {
                            "bbox": [
                                105,
                                97,
                                504,
                                708
                            ],
                            "lines": [
                                {
                                    "bbox": [
                                        105,
                                        97,
                                        504,
                                        708
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                105,
                                                97,
                                                504,
                                                708
                                            ],
                                            "type": "table",
                                            "html": "<table><tr><td></td><td>Content</td></tr><tr><td>P0</td><td>&quot;Water is necessary to survive, but as we all know, sometimes too much of a good thing (even water) can be harmful. In 2022, a group of kidney specialists from Madrid, Spain, revisited the death of Kung Fu legend Bruce Lee and concluded that water intoxication was the most likely cause of his untimely death. Bruce Lee, the martial arts legend and iconic figure in the history of cinema, died on July 20, 1973, at the young age of 32. The official cause of death at the time was reported as a probable drug reaction and classified as &quot;death by misadventure.&quot; Hours before his death, Lee complained of a headache while visiting a fellow actress Betty Ting Pei at her apartment. She gave him one of her own prescription painkillers (one that contained aspirin and meprobamate), and he laid down to take a nap. He never woke up and was unable to be resuscitated even after being transferred to a Hong Kong hospital. In the years since Lee&#x27;s death, many theories have been put forward as to the true cause of his passing. These theories include murder by gangsters or a jilted lover, a family curse, epilepsy, heatstroke, and possibly</td></tr><tr><td>P1</td><td>Bruce Lee May Have Died From Drinking Too Much Water, Claims Study The &#x27;Enter The Dragon&#x27; actor, who helped bring martial arts into popular culture, died in July 1973 at the age of 32. American martial arts legend and actor Bruce Lee might have died from drinking too much water, scientists have claimed in a new study. The &#x27;Enter The Dragon&#x27; actor, who helped bring martial arts into popular culture, died in July 1973 at the age of 32 from cerebral oedema, a swelling of the brain. At the time, doctors believed the brain swelling was due to a painkiller. The oedema, according to a group of researchers, was brought on by hyponatraemia. In their study, which was published in the Clinical Kidney Journal, the researchers proposed that Bruce Lee died because his kidneys were unable to eliminate extra water. The findings are very different from old theories about how died, such as those regarding gangster assassination, jealous lover poisoning, curses, and heatstroke. According to scientists, the actor may have died from hyponatraemia, which develops when the body&#x27;s sodium levels get diluted as a result of consuming too much water. The cells in the body, particularly those in the brain,</td></tr><tr><td>P2</td><td>circumstances, you&#x27;re bound to get some truly insane conspiracy theories, and there are plenty about Bruce Lee. The crazy Bruce Lee murder theories Producer Raymond Chow made a big mistake after Bruce Lee&#x27;s death. Hoping to protect Lee&#x27;s image, Chow&#x27;s production company claimed the actor died at home with his wife, Linda. But once the press found out the truth, the tabloids got going. In fact, a lot of people pointed the finger at Betty Ting Pei, claiming she was responsible for Lee&#x27;s death and that perhaps she&#x27;d even poisoned him. Unfortunately, that wasn&#x27;t the only rumor involving murder. One of the most popular theories says other martial artists were angry at Lee for teaching their secrets to Westerners, so they decided to bump him off. Some say ninjas were responsible, and others claim Lee was killed with the &quot;Dim Mak,&quot; a mythical martial arts move that supposedly kills a victim with one fateful blow. Others believe he was killed after refusing to pay protection money to the Triads, while others claim the Mafia did the deed because Lee wouldn&#x27;t let them control his career. The more mystical conspiracy theorists even say there&#x27;s a family curse that took the life</td></tr><tr><td>P3</td><td>Bruce Lee complained of a headache, was given an Equagesic  a painkiller that contains both aspirin and the tranquilizer meprobamate  and went down for a nap. He never woke up. His death was said to be an allergic reaction to the tranquilizer resulting in a cerebral edema (he had suffered a previous edema months before), though others claim his death was due to a negative reaction to cannabis, which Lee consumed regularly to reduce stress. Because he was so young, news of his death invited wild media speculation, from murder to a family curse. 5. Brandon Lee Sadly, Bruce Lee&#x27;s son Brandon also died young, at age 28, and also under strange circumstances. While filming the horror film The Crow, Lee was accidentally killed by a prop gun that, due to a malfunction in a previous scene, was accidentally loaded with a dummy bullet and a live primer. When the gun was fired, the bullet was ejected with virtually the same force as if loaded with a live round. Lee was hit in the abdomen and died in surgery later that day, on March 31, 1993. Like his father, Brandon&#x27;s abrupt death fed rumors. Conspiracy theorists believe Illuminati</td></tr><tr><td>P4</td><td>Bruce Lee moved to a house in Hong Kong&#x27;s Kowloon Tong district, it was said that the building suffered from bad feng shui. According to Lee biographer Bruce Thomas, the house&#x27;s two previous owners had financial issues, and the building &quot;faced the wrong way,&quot; and had disturbed natural winds. To fix this problem, a feng shui adviser ordered a mirror to be put on the roof. This was supposed to deflect the bad energy, but the mirror was knocked off during a typhoon. Ominously, Lee died just two days after the charm was blown away. While some of Lee&#x27;s neighbors apparently linked the two events at the time, the problem with this theory is that feng shui is nothing but a superstition. There&#x27;s no scientific evidence for any of its tenets, including qi. At most, feng shui could be regarded as a kind of art. Lee&#x27;s death after the loss of his mirror is a simple coincidence. Moreover, Lee died in Betty Ting&#x27;s apartment, not in his own house. 2. Murder The abruptness of Bruce Lee&#x27;s death, combined with his extraordinary fitness, made some fans wonder whether something more sinister was at work. People who believe that Lee was murdered</td></tr></table>",
                                            "image_path": "7eb4cfa1b0b73040a6b6d392345511f53e877121da55ada55c73ab8e54acdb64.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 1,
                            "angle": 0,
                            "type": "table_body"
                        }
                    ],
                    "index": 1
                }
            ],
            "discarded_blocks": [
                {
                    "bbox": [
                        299,
                        742,
                        310,
                        751
                    ],
                    "type": "page_number",
                    "angle": 0,
                    "index": 2,
                    "lines": [
                        {
                            "bbox": [
                                298,
                                741,
                                312,
                                754
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        298,
                                        741,
                                        312,
                                        754
                                    ],
                                    "type": "text",
                                    "content": "25",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                }
            ],
            "page_size": [
                612,
                792
            ],
            "page_idx": 24
        },
        {
            "para_blocks": [
                {
                    "type": "table",
                    "bbox": [
                        170,
                        105,
                        440,
                        165
                    ],
                    "blocks": [
                        {
                            "bbox": [
                                67,
                                75,
                                543,
                                97
                            ],
                            "lines": [
                                {
                                    "bbox": [
                                        69,
                                        73,
                                        541,
                                        87
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                69,
                                                73,
                                                541,
                                                87
                                            ],
                                            "type": "text",
                                            "content": "Table 11 Performance comparison on reconstruction task with and w/o curriculum learning. Log-Perplexity is reported",
                                            "score": 1.0
                                        }
                                    ]
                                },
                                {
                                    "bbox": [
                                        68,
                                        86,
                                        225,
                                        97
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                68,
                                                86,
                                                225,
                                                97
                                            ],
                                            "type": "text",
                                            "content": "as average of Arxiv and Book domain.",
                                            "score": 1.0
                                        }
                                    ]
                                }
                            ],
                            "index": 0,
                            "angle": 0,
                            "type": "table_caption"
                        },
                        {
                            "bbox": [
                                170,
                                105,
                                440,
                                165
                            ],
                            "lines": [
                                {
                                    "bbox": [
                                        170,
                                        105,
                                        440,
                                        165
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                170,
                                                105,
                                                440,
                                                165
                                            ],
                                            "type": "table",
                                            "html": "<table><tr><td></td><td>P16</td><td>P32</td><td>P128</td><td>P2048 </td></tr><tr><td>LLAMA-FULL CONTEXT</td><td>1.397</td><td>0.734</td><td>0.203</td><td>0.021</td></tr><tr><td>LLAMA-No CONTEXT</td><td>3.483</td><td>2.981</td><td>2.249</td><td>1.590</td></tr><tr><td>REFRAG w/o curriculum</td><td>3.719</td><td>3.098</td><td>2.272</td><td>1.599</td></tr><tr><td>REFRAG with curriculum</td><td>0.669</td><td>0.451</td><td>0.230</td><td>0.135</td></tr></table>",
                                            "image_path": "f5bd7dfef62c5849ec808e2be758a7a63d8fc244a32d29f188e3e309f30153b8.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 1,
                            "angle": 0,
                            "type": "table_body"
                        }
                    ],
                    "index": 1
                },
                {
                    "type": "table",
                    "bbox": [
                        164,
                        224,
                        447,
                        285
                    ],
                    "blocks": [
                        {
                            "bbox": [
                                67,
                                194,
                                543,
                                217
                            ],
                            "lines": [
                                {
                                    "bbox": [
                                        69,
                                        194,
                                        543,
                                        206
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                69,
                                                194,
                                                543,
                                                206
                                            ],
                                            "type": "text",
                                            "content": "Table 12 Performance comparison on continual pre-training task with and w/o continued from reconstruction task.",
                                            "score": 1.0
                                        }
                                    ]
                                },
                                {
                                    "bbox": [
                                        68,
                                        205,
                                        335,
                                        217
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                68,
                                                205,
                                                335,
                                                217
                                            ],
                                            "type": "text",
                                            "content": "Log-Perplexity is reported as average of Arxiv and Book domain.",
                                            "score": 1.0
                                        }
                                    ]
                                }
                            ],
                            "index": 2,
                            "angle": 0,
                            "type": "table_caption"
                        },
                        {
                            "bbox": [
                                164,
                                224,
                                447,
                                285
                            ],
                            "lines": [
                                {
                                    "bbox": [
                                        164,
                                        224,
                                        447,
                                        285
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                164,
                                                224,
                                                447,
                                                285
                                            ],
                                            "type": "table",
                                            "html": "<table><tr><td></td><td>P16</td><td>P32</td><td>P128</td><td>P2048 </td></tr><tr><td>LLAMA-FULL CONTEXT</td><td>1.448</td><td>1.458</td><td>1.464</td><td>1.449</td></tr><tr><td>LLAMA-No CONTEXT</td><td>3.483</td><td>2.981</td><td>2.249</td><td>1.590</td></tr><tr><td>REFRAG w/o reconstruction</td><td>3.272</td><td>2.789</td><td>2.119</td><td>1.544</td></tr><tr><td>REFRAG with reconstruction</td><td>2.017</td><td>1.837</td><td>1.632</td><td>1.453</td></tr></table>",
                                            "image_path": "c3c17259ba2d059e31721f8d4bfa37b2b05a589b840db0c5963d018e41f79914.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 3,
                            "angle": 0,
                            "type": "table_body"
                        }
                    ],
                    "index": 3
                },
                {
                    "type": "table",
                    "bbox": [
                        71,
                        345,
                        542,
                        419
                    ],
                    "blocks": [
                        {
                            "bbox": [
                                67,
                                314,
                                542,
                                337
                            ],
                            "lines": [
                                {
                                    "bbox": [
                                        69,
                                        313,
                                        542,
                                        327
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                69,
                                                313,
                                                542,
                                                327
                                            ],
                                            "type": "text",
                                            "content": "Table 13 The performance of REFRAG under the same compression rate with full compression (i.e., REFRAG8) and",
                                            "score": 1.0
                                        }
                                    ]
                                },
                                {
                                    "bbox": [
                                        68,
                                        324,
                                        253,
                                        338
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                68,
                                                324,
                                                253,
                                                338
                                            ],
                                            "type": "text",
                                            "content": "selective compression (i.e., REFRAG16+RL).",
                                            "score": 1.0
                                        }
                                    ]
                                }
                            ],
                            "index": 4,
                            "angle": 0,
                            "type": "table_caption"
                        },
                        {
                            "bbox": [
                                71,
                                345,
                                542,
                                419
                            ],
                            "lines": [
                                {
                                    "bbox": [
                                        71,
                                        345,
                                        542,
                                        419
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                71,
                                                345,
                                                542,
                                                419
                                            ],
                                            "type": "table",
                                            "html": "<table><tr><td></td><td></td><td colspan=\"3\">Arxiv</td><td colspan=\"3\">Book</td><td colspan=\"3\">PG19</td><td colspan=\"3\">ProofPile</td></tr><tr><td></td><td>Compression Rate</td><td>P512</td><td>P1024</td><td>P2048</td><td>P512</td><td>P1024</td><td>P2048</td><td>P512</td><td>P1024</td><td>P2048</td><td>P512</td><td>P1024</td><td>P2048 </td></tr><tr><td colspan=\"14\">Context Length=2048</td></tr><tr><td>REFRAG8</td><td>8</td><td>1.124</td><td>1.091</td><td>1.062</td><td>1.905</td><td>1.868</td><td>1.844</td><td>1.996</td><td>1.956</td><td>1.927</td><td>0.997</td><td>0.952</td><td>0.916</td></tr><tr><td>REFRAG16+RL</td><td>8.258</td><td>1.118</td><td>1.090</td><td>1.062</td><td>1.878</td><td>1.856</td><td>1.840</td><td>1.978</td><td>1.952</td><td>1.930</td><td>0.992</td><td>0.951</td><td>0.916</td></tr><tr><td colspan=\"14\">Context Length=4096</td></tr><tr><td>REFRAG8</td><td>8</td><td>1.098</td><td>1.065</td><td>1.042</td><td>1.895</td><td>1.860</td><td>1.837</td><td>1.989</td><td>1.950</td><td>1.922</td><td>0.965</td><td>0.923</td><td>0.894</td></tr><tr><td>REFRAG16+RL</td><td>8.0157</td><td>1.065</td><td>1.048</td><td>1.033</td><td>1.851</td><td>1.837</td><td>1.828</td><td>1.952</td><td>1.934</td><td>1.918</td><td>0.932</td><td>0.905</td><td>0.883</td></tr></table>",
                                            "image_path": "96d2b55833137ed8295a36cce2e48338a9d9bea15b66be86f65422aa51501226.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 5,
                            "angle": 0,
                            "type": "table_body"
                        }
                    ],
                    "index": 5
                },
                {
                    "type": "table",
                    "bbox": [
                        141,
                        479,
                        472,
                        559
                    ],
                    "blocks": [
                        {
                            "bbox": [
                                67,
                                449,
                                542,
                                471
                            ],
                            "lines": [
                                {
                                    "bbox": [
                                        67,
                                        446,
                                        542,
                                        462
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                67,
                                                446,
                                                542,
                                                462
                                            ],
                                            "type": "text",
                                            "content": "Table 14 Log-Perplexity of continual pre-training for different encoder-decoder combinations. Lower log-perplexity",
                                            "score": 1.0
                                        }
                                    ]
                                },
                                {
                                    "bbox": [
                                        69,
                                        460,
                                        189,
                                        471
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                69,
                                                460,
                                                189,
                                                471
                                            ],
                                            "type": "text",
                                            "content": "indicates better performance.",
                                            "score": 1.0
                                        }
                                    ]
                                }
                            ],
                            "index": 6,
                            "angle": 0,
                            "type": "table_caption"
                        },
                        {
                            "bbox": [
                                141,
                                479,
                                472,
                                559
                            ],
                            "lines": [
                                {
                                    "bbox": [
                                        141,
                                        479,
                                        472,
                                        559
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                141,
                                                479,
                                                472,
                                                559
                                            ],
                                            "type": "table",
                                            "html": "<table><tr><td rowspan=\"2\">Encoder-Decoder</td><td rowspan=\"2\">Context Length</td><td colspan=\"3\">LLaMA-3.1-8B</td><td colspan=\"3\">LLaMA-3.2-3B</td></tr><tr><td>P512</td><td>P1024</td><td>P2048</td><td>P512</td><td>P1024</td><td>P2048 </td></tr><tr><td>Full Context</td><td>2048</td><td>1.000</td><td>0.989</td><td>0.972</td><td>1.092</td><td>1.080</td><td>1.062</td></tr><tr><td>No Context</td><td>0</td><td>1.445</td><td>1.286</td><td>1.162</td><td>1.559</td><td>1.392</td><td>1.262</td></tr><tr><td>Roberta-Base</td><td>2048</td><td>1.109</td><td>1.067</td><td>1.026</td><td>1.175</td><td>1.133</td><td>1.093</td></tr><tr><td>Roberta-Large</td><td>2048</td><td>1.107</td><td>1.065</td><td>1.025</td><td>1.170</td><td>1.130</td><td>1.091</td></tr><tr><td>Roberta-Base</td><td>4096</td><td>1.067</td><td>1.032</td><td>0.999</td><td>1.142</td><td>1.105</td><td>1.070</td></tr><tr><td>Roberta-Large</td><td>4096</td><td>1.065</td><td>1.031</td><td>0.998</td><td>1.130</td><td>1.096</td><td>1.064</td></tr></table>",
                                            "image_path": "90029671ef183397d52856d615019bac4605ab5316022629f34e94503f31d615.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 7,
                            "angle": 0,
                            "type": "table_body"
                        }
                    ],
                    "index": 7
                },
                {
                    "type": "table",
                    "bbox": [
                        71,
                        620,
                        539,
                        711
                    ],
                    "blocks": [
                        {
                            "bbox": [
                                67,
                                589,
                                542,
                                612
                            ],
                            "lines": [
                                {
                                    "bbox": [
                                        69,
                                        589,
                                        541,
                                        601
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                69,
                                                589,
                                                541,
                                                601
                                            ],
                                            "type": "text",
                                            "content": "Table 15 Performance of our model under compression rate of 16 with different number of retrieved passages in RAG",
                                            "score": 1.0
                                        }
                                    ]
                                },
                                {
                                    "bbox": [
                                        68,
                                        599,
                                        214,
                                        613
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                68,
                                                599,
                                                214,
                                                613
                                            ],
                                            "type": "text",
                                            "content": "under the strong retriever scenario.",
                                            "score": 1.0
                                        }
                                    ]
                                }
                            ],
                            "index": 8,
                            "angle": 0,
                            "type": "table_caption"
                        },
                        {
                            "bbox": [
                                71,
                                620,
                                539,
                                711
                            ],
                            "lines": [
                                {
                                    "bbox": [
                                        71,
                                        620,
                                        539,
                                        711
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                71,
                                                620,
                                                539,
                                                711
                                            ],
                                            "type": "table",
                                            "html": "<table><tr><td># Passages</td><td>MMLU</td><td>NQ</td><td>FEVER</td><td>WebQA</td><td>FreebaseQA</td><td>CommonsenseQA</td><td>ECQA</td><td>StrategyQA</td><td>HellaSwag</td><td>SIQA</td><td>PIQA </td></tr><tr><td>0</td><td>48.07</td><td>18.73</td><td>65.80</td><td>34.67</td><td>60.20</td><td>89.18</td><td>87.42</td><td>68.89</td><td>43.72</td><td>67.25</td><td>70.18</td></tr><tr><td>1</td><td>50.49</td><td>21.39</td><td>69.46</td><td>37.33</td><td>68.06</td><td>86.60</td><td>89.40</td><td>80.00</td><td>43.26</td><td>68.17</td><td>70.08</td></tr><tr><td>3</td><td>50.49</td><td>22.01</td><td>66.02</td><td>38.67</td><td>71.01</td><td>89.18</td><td>95.36</td><td>71.11</td><td>45.50</td><td>68.73</td><td>71.44</td></tr><tr><td>5</td><td>50.62</td><td>23.00</td><td>66.07</td><td>41.33</td><td>72.48</td><td>91.75</td><td>96.03</td><td>75.56</td><td>45.48</td><td>68.17</td><td>71.38</td></tr><tr><td>8</td><td>50.29</td><td>22.96</td><td>66.59</td><td>38.67</td><td>73.46</td><td>92.27</td><td>94.70</td><td>75.56</td><td>45.23</td><td>68.94</td><td>71.38</td></tr><tr><td>20</td><td>51.01</td><td>24.30</td><td>67.77</td><td>40.00</td><td>75.18</td><td>91.75</td><td>98.01</td><td>75.56</td><td>45.09</td><td>68.53</td><td>71.00</td></tr><tr><td>50</td><td>51.08</td><td>24.76</td><td>69.39</td><td>40.00</td><td>75.92</td><td>91.75</td><td>97.35</td><td>75.56</td><td>44.78</td><td>67.81</td><td>69.97</td></tr><tr><td>80</td><td>50.42</td><td>24.15</td><td>68.83</td><td>37.33</td><td>74.20</td><td>92.27</td><td>97.35</td><td>71.11</td><td>44.61</td><td>68.22</td><td>69.37</td></tr><tr><td>100</td><td>50.23</td><td>23.99</td><td>69.80</td><td>36.00</td><td>74.45</td><td>92.27</td><td>97.35</td><td>71.11</td><td>44.57</td><td>68.07</td><td>69.75</td></tr></table>",
                                            "image_path": "608aa1eb5c1b764558db311b8131819bfda9ee0811587f1de9e0c8da10c76010.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 9,
                            "angle": 0,
                            "type": "table_body"
                        }
                    ],
                    "index": 9
                }
            ],
            "discarded_blocks": [
                {
                    "bbox": [
                        299,
                        742,
                        311,
                        752
                    ],
                    "type": "page_number",
                    "angle": 0,
                    "index": 10,
                    "lines": [
                        {
                            "bbox": [
                                298,
                                741,
                                313,
                                754
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        298,
                                        741,
                                        313,
                                        754
                                    ],
                                    "type": "text",
                                    "content": "26",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                }
            ],
            "page_size": [
                612,
                792
            ],
            "page_idx": 25
        },
        {
            "para_blocks": [
                {
                    "type": "table",
                    "bbox": [
                        72,
                        103,
                        538,
                        269
                    ],
                    "blocks": [
                        {
                            "bbox": [
                                67,
                                73,
                                542,
                                95
                            ],
                            "lines": [
                                {
                                    "bbox": [
                                        69,
                                        72,
                                        542,
                                        85
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                69,
                                                72,
                                                542,
                                                85
                                            ],
                                            "type": "text",
                                            "content": "Table 16 Comparison of model performance of different models with different number of retrieved chunks for RAG. The",
                                            "score": 1.0
                                        }
                                    ]
                                },
                                {
                                    "bbox": [
                                        69,
                                        84,
                                        272,
                                        95
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                69,
                                                84,
                                                272,
                                                95
                                            ],
                                            "type": "text",
                                            "content": "number of contexts in all the evaluation here is 5.",
                                            "score": 1.0
                                        }
                                    ]
                                }
                            ],
                            "index": 0,
                            "angle": 0,
                            "type": "table_caption"
                        },
                        {
                            "bbox": [
                                72,
                                103,
                                538,
                                269
                            ],
                            "lines": [
                                {
                                    "bbox": [
                                        72,
                                        103,
                                        538,
                                        269
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                72,
                                                103,
                                                538,
                                                269
                                            ],
                                            "type": "table",
                                            "html": "<table><tr><td>Generation</td><td>NQ</td><td>FEVER</td><td>TQA</td><td>WebQA</td><td>FreebaseQA</td><td>GSM8K</td><td>StrategyQA</td><td>BoolQ </td></tr><tr><td>\\( LLAMA_{FT} \\)</td><td>21.88</td><td>61.85</td><td>7.96</td><td>34.67</td><td>72.97</td><td>8.72</td><td>71.11</td><td>29.54</td></tr><tr><td>CEPE</td><td>0.05</td><td>60.68</td><td>0.01</td><td>0.00</td><td>0.25</td><td>0.00</td><td>0.00</td><td>56.70</td></tr><tr><td>REPLUG</td><td>14.96</td><td>71.56</td><td>11.01</td><td>25.33</td><td>53.32</td><td>4.70</td><td>66.67</td><td>3.15</td></tr><tr><td>LLAMA-32K</td><td>2.26</td><td>0.23</td><td>2.17</td><td>14.67</td><td>9.83</td><td>0.67</td><td>4.44</td><td>0.06</td></tr><tr><td>\\( REFRAG_8 \\)</td><td>20.86</td><td>63.44</td><td>12.37</td><td>38.67</td><td>65.60</td><td>11.41</td><td>73.33</td><td>3.06</td></tr><tr><td>\\( REFRAG_{16} \\)</td><td>20.60</td><td>60.45</td><td>11.86</td><td>40.00</td><td>66.09</td><td>11.41</td><td>73.33</td><td>5.57</td></tr><tr><td>\\( REFRAG_{32} \\)</td><td>21.39</td><td>61.97</td><td>12.03</td><td>40.00</td><td>67.32</td><td>12.75</td><td>68.89</td><td>1.80</td></tr><tr><td>Multi-Choice</td><td>MMLU</td><td>CommonsenseQA</td><td>MathQA</td><td>ECQA</td><td>HellaSwag</td><td>SIQA</td><td>PIQA</td><td>Winogrande </td></tr><tr><td>\\( LLAMA_{FT} \\)</td><td>49.97</td><td>84.02</td><td>97.48</td><td>86.09</td><td>42.78</td><td>67.09</td><td>68.39</td><td>54.78</td></tr><tr><td>CEPE</td><td>26.06</td><td>20.62</td><td>24.16</td><td>19.87</td><td>24.99</td><td>33.57</td><td>49.13</td><td>46.96</td></tr><tr><td>REPLUG</td><td>47.35</td><td>77.84</td><td>99.50</td><td>79.47</td><td>49.26</td><td>64.99</td><td>71.98</td><td>56.04</td></tr><tr><td>LLAMA-32K</td><td>24.17</td><td>18.04</td><td>22.32</td><td>15.89</td><td>24.09</td><td>16.84</td><td>28.02</td><td>48.78</td></tr><tr><td>\\( REFRAG_8 \\)</td><td>49.90</td><td>91.24</td><td>99.66</td><td>97.35</td><td>45.03</td><td>68.27</td><td>70.95</td><td>57.22</td></tr><tr><td>\\( REFRAG_{16} \\)</td><td>49.84</td><td>90.21</td><td>99.66</td><td>96.69</td><td>39.52</td><td>68.63</td><td>70.95</td><td>56.35</td></tr><tr><td>\\( REFRAG_{32} \\)</td><td>49.84</td><td>91.24</td><td>99.50</td><td>97.35</td><td>42.71</td><td>68.32</td><td>68.72</td><td>56.12</td></tr></table>",
                                            "image_path": "1d477dbc4cf3885d92e5697b52014ab4e9826b52756ef2bd11672f671becfab8.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 1,
                            "angle": 0,
                            "type": "table_body"
                        }
                    ],
                    "index": 1
                },
                {
                    "type": "table",
                    "bbox": [
                        71,
                        327,
                        538,
                        554
                    ],
                    "blocks": [
                        {
                            "bbox": [
                                67,
                                297,
                                542,
                                319
                            ],
                            "lines": [
                                {
                                    "bbox": [
                                        69,
                                        297,
                                        541,
                                        308
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                69,
                                                297,
                                                541,
                                                308
                                            ],
                                            "type": "text",
                                            "content": "Table 17 Comparison of model performance of different models with different number of retrieved passages for RAG",
                                            "score": 1.0
                                        }
                                    ]
                                },
                                {
                                    "bbox": [
                                        69,
                                        308,
                                        208,
                                        319
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                69,
                                                308,
                                                208,
                                                319
                                            ],
                                            "type": "text",
                                            "content": "under the weak retriever scenario.",
                                            "score": 1.0
                                        }
                                    ]
                                }
                            ],
                            "index": 2,
                            "angle": 0,
                            "type": "table_caption"
                        },
                        {
                            "bbox": [
                                71,
                                327,
                                538,
                                554
                            ],
                            "lines": [
                                {
                                    "bbox": [
                                        71,
                                        327,
                                        538,
                                        554
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                71,
                                                327,
                                                538,
                                                554
                                            ],
                                            "type": "table",
                                            "html": "<table><tr><td>Generation</td><td>NQ</td><td>FEVER</td><td>TQA</td><td>WebQA</td><td>FreebaseQA</td><td>GSM8K</td><td>StrategyQA</td><td>BoolQ </td><td>(1/ # tokens)</td></tr><tr><td colspan=\"10\">Short context with the same latency</td></tr><tr><td>\\( LLAMA_{FT} + 1 \\) passage</td><td>20.20</td><td>57.70</td><td>8.32</td><td>32.00</td><td>67.08</td><td>6.71</td><td>62.22</td><td>31.25</td><td>1</td></tr><tr><td>\\( REFRAG_{8} + 8 \\) passages</td><td>21.22</td><td>63.21</td><td>11.77</td><td>42.67</td><td>67.57</td><td>8.72</td><td>68.89</td><td>3.24</td><td>1</td></tr><tr><td>\\( REFRAG_{16} + 8 \\) passages</td><td>20.73</td><td>60.86</td><td>11.60</td><td>40.00</td><td>66.83</td><td>11.41</td><td>77.78</td><td>6.36</td><td>2</td></tr><tr><td>\\( REFRAG_{32} + 8 \\) passages</td><td>21.08</td><td>62.65</td><td>11.69</td><td>42.67</td><td>66.58</td><td>11.41</td><td>68.89</td><td>2.35</td><td>4</td></tr><tr><td colspan=\"10\">Long context</td></tr><tr><td>\\( LLAMA_{FT} + 10 \\) passages</td><td>22.27</td><td>60.40</td><td>8.32</td><td>38.67</td><td>71.50</td><td>9.40</td><td>71.11</td><td>29.94</td><td>1</td></tr><tr><td>CEPED +80 passages</td><td>0.02</td><td>65.18</td><td>0.02</td><td>0.00</td><td>0.00</td><td>0.00</td><td>0.00</td><td>59.33</td><td></td></tr><tr><td>REPLUG +80 passages</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td><td>64.44</td><td>-</td><td></td></tr><tr><td>\\( LLAMA-32K +80 \\) passages</td><td>1.03</td><td>0.12</td><td>0.37</td><td>5.33</td><td>9.34</td><td>0.00</td><td>0.00</td><td>0.03</td><td></td></tr><tr><td>\\( REFRAG_{8} +80 \\) passages</td><td>22.92</td><td>67.87</td><td>12.22</td><td>46.67</td><td>71.99</td><td>10.07</td><td>68.89</td><td>7.19</td><td>1</td></tr><tr><td>\\( REFRAG_{16} +80 \\) passages</td><td>22.63</td><td>65.07</td><td>12.12</td><td>38.67</td><td>71.74</td><td>8.72</td><td>68.89</td><td>12.05</td><td>2</td></tr><tr><td>\\( REFRAG_{32} +80 \\) passages</td><td>21.86</td><td>67.24</td><td>11.54</td><td>41.33</td><td>70.76</td><td>8.72</td><td>66.67</td><td>6.30</td><td>4</td></tr><tr><td>Multi-Choice</td><td>MMLU</td><td>CommonsenseQA</td><td>MathQA</td><td>ECQA</td><td>HellaSwag</td><td>SIQA</td><td>PIQA</td><td>Winogrande </td><td></td></tr><tr><td colspan=\"10\">Short context with the same latency</td></tr><tr><td>\\( LLAMA_{FT} + 1 \\) context</td><td>48.86</td><td>82.99</td><td>99.50</td><td>84.77</td><td>42.08</td><td>67.91</td><td>67.46</td><td>55.49</td><td>1</td></tr><tr><td>\\( REFRAG_{8} + 8 \\) passages</td><td>50.10</td><td>91.24</td><td>99.66</td><td>96.03</td><td>45.15</td><td>68.17</td><td>70.40</td><td>57.46</td><td>1</td></tr><tr><td>\\( REFRAG_{16} + 8 \\) passages</td><td>49.77</td><td>90.21</td><td>99.66</td><td>96.69</td><td>39.32</td><td>68.73</td><td>70.46</td><td>56.43</td><td>2</td></tr><tr><td>\\( REFRAG_{32} + 8 \\) passages</td><td>50.10</td><td>91.75</td><td>99.50</td><td>96.03</td><td>42.36</td><td>68.83</td><td>68.28</td><td>55.80</td><td>4</td></tr><tr><td colspan=\"10\">Long context</td></tr><tr><td>\\( LLAMA_{FT} + 10 \\) passages</td><td>45.20</td><td>83.51</td><td>63.42</td><td>85.43</td><td>41.43</td><td>67.60</td><td>67.36</td><td>54.30</td><td>1</td></tr><tr><td>CEPED +80 passages</td><td>26.52</td><td>24.74</td><td>23.83</td><td>22.52</td><td>24.97</td><td>32.86</td><td>48.80</td><td>44.20</td><td></td></tr><tr><td>REPLUG +80 passages</td><td>-</td><td>-</td><td>-</td><td>76.16</td><td>-</td><td>65.46</td><td>-</td><td>55.33</td><td></td></tr><tr><td>\\( LLAMA-32K +80 \\) passages</td><td>22.01</td><td>18.04</td><td>19.97</td><td>16.56</td><td>23.69</td><td>23.80</td><td>33.19</td><td>48.62</td><td></td></tr><tr><td>\\( REFRAG_{8} +80 \\) passages</td><td>50.03</td><td>90.72</td><td>99.66</td><td>97.35</td><td>44.44</td><td>67.66</td><td>69.48</td><td>56.91</td><td>1</td></tr><tr><td>\\( REFRAG_{16} +80 \\) passages</td><td>49.77</td><td>90.21</td><td>99.66</td><td>95.36</td><td>38.29</td><td>68.12</td><td>70.57</td><td>56.91</td><td>2</td></tr><tr><td>\\( REFRAG_{32} +80 \\) passages</td><td>50.03</td><td>91.24</td><td>99.50</td><td>98.01</td><td>43.02</td><td>68.58</td><td>68.55</td><td>57.22</td><td>4</td></tr></table>",
                                            "image_path": "39f2c365eee70ccc3899f98e8b264702e5456b97a58e0448c64c77c939012537.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 3,
                            "angle": 0,
                            "type": "table_body"
                        },
                        {
                            "bbox": [
                                73,
                                554,
                                249,
                                562
                            ],
                            "lines": [
                                {
                                    "bbox": [
                                        74,
                                        553,
                                        250,
                                        562
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                74,
                                                553,
                                                250,
                                                562
                                            ],
                                            "type": "text",
                                            "content": "- means the corresponding model has out-of-memory error.",
                                            "score": 1.0
                                        }
                                    ]
                                }
                            ],
                            "index": 4,
                            "angle": 0,
                            "type": "table_footnote"
                        }
                    ],
                    "index": 3
                },
                {
                    "type": "table",
                    "bbox": [
                        71,
                        620,
                        538,
                        711
                    ],
                    "blocks": [
                        {
                            "bbox": [
                                67,
                                590,
                                542,
                                612
                            ],
                            "lines": [
                                {
                                    "bbox": [
                                        69,
                                        589,
                                        542,
                                        602
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                69,
                                                589,
                                                542,
                                                602
                                            ],
                                            "type": "text",
                                            "content": "Table 18 Performance of our model under compression rate of 16 with different number of retrieved passages in RAG",
                                            "score": 1.0
                                        }
                                    ]
                                },
                                {
                                    "bbox": [
                                        69,
                                        601,
                                        209,
                                        613
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                69,
                                                601,
                                                209,
                                                613
                                            ],
                                            "type": "text",
                                            "content": "under the weak retriever scenario.",
                                            "score": 1.0
                                        }
                                    ]
                                }
                            ],
                            "index": 5,
                            "angle": 0,
                            "type": "table_caption"
                        },
                        {
                            "bbox": [
                                71,
                                620,
                                538,
                                711
                            ],
                            "lines": [
                                {
                                    "bbox": [
                                        71,
                                        620,
                                        538,
                                        711
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                71,
                                                620,
                                                538,
                                                711
                                            ],
                                            "type": "table",
                                            "html": "<table><tr><td># Passages</td><td>MMLU</td><td>NQ</td><td>FEVER</td><td>WebQA</td><td>FreebaseQA</td><td>CommonsenseQA</td><td>ECQA</td><td>StrategyQA</td><td>HellaSwag</td><td>SIQA</td><td>PIQA</td></tr><tr><td>0</td><td>48.14</td><td>19.09</td><td>61.40</td><td>30.67</td><td>59.71</td><td>85.05</td><td>86.75</td><td>55.56</td><td>36.57</td><td>64.59</td><td>68.82</td></tr><tr><td>1</td><td>49.97</td><td>20.08</td><td>64.15</td><td>38.67</td><td>64.62</td><td>87.63</td><td>92.72</td><td>71.11</td><td>39.08</td><td>68.58</td><td>70.57</td></tr><tr><td>3</td><td>49.64</td><td>20.63</td><td>60.80</td><td>40.00</td><td>68.55</td><td>89.69</td><td>95.36</td><td>75.56</td><td>39.41</td><td>69.40</td><td>71.11</td></tr><tr><td>5</td><td>49.84</td><td>20.60</td><td>60.45</td><td>40.00</td><td>66.09</td><td>90.21</td><td>96.69</td><td>73.33</td><td>39.52</td><td>68.63</td><td>70.95</td></tr><tr><td>8</td><td>49.77</td><td>20.73</td><td>60.86</td><td>40.00</td><td>66.83</td><td>90.21</td><td>96.69</td><td>77.78</td><td>39.32</td><td>68.73</td><td>70.46</td></tr><tr><td>20</td><td>50.03</td><td>21.29</td><td>62.32</td><td>36.00</td><td>68.06</td><td>89.69</td><td>95.36</td><td>75.56</td><td>38.58</td><td>69.29</td><td>70.62</td></tr><tr><td>50</td><td>49.84</td><td>22.12</td><td>63.54</td><td>37.33</td><td>71.99</td><td>89.69</td><td>96.69</td><td>75.56</td><td>38.11</td><td>68.53</td><td>70.84</td></tr><tr><td>80</td><td>49.77</td><td>22.63</td><td>65.07</td><td>38.67</td><td>71.74</td><td>90.21</td><td>95.36</td><td>68.89</td><td>38.29</td><td>68.12</td><td>70.57</td></tr><tr><td>100</td><td>50.62</td><td>22.80</td><td>65.17</td><td>37.33</td><td>73.46</td><td>89.69</td><td>96.03</td><td>68.89</td><td>38.51</td><td>68.37</td><td>70.18</td></tr></table>",
                                            "image_path": "b3dbf0483ac41f0ff7d0250b67a4fb4d889a8ea908ff086f4cbc10f2b51290d8.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 6,
                            "angle": 0,
                            "type": "table_body"
                        }
                    ],
                    "index": 6
                }
            ],
            "discarded_blocks": [
                {
                    "bbox": [
                        299,
                        742,
                        311,
                        752
                    ],
                    "type": "page_number",
                    "angle": 0,
                    "index": 7,
                    "lines": [
                        {
                            "bbox": [
                                298,
                                742,
                                313,
                                756
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        298,
                                        742,
                                        313,
                                        756
                                    ],
                                    "type": "text",
                                    "content": "27",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                }
            ],
            "page_size": [
                612,
                792
            ],
            "page_idx": 26
        },
        {
            "para_blocks": [
                {
                    "bbox": [
                        75,
                        201,
                        150,
                        209
                    ],
                    "type": "title",
                    "angle": 0,
                    "index": 0,
                    "lines": [
                        {
                            "bbox": [
                                76,
                                200,
                                151,
                                211
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        76,
                                        200,
                                        151,
                                        211
                                    ],
                                    "type": "text",
                                    "content": "Ground True Abstract",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                },
                {
                    "bbox": [
                        75,
                        211,
                        302,
                        361
                    ],
                    "type": "text",
                    "angle": 0,
                    "index": 1,
                    "lines": [
                        {
                            "bbox": [
                                76,
                                210,
                                303,
                                220
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        76,
                                        210,
                                        303,
                                        220
                                    ],
                                    "type": "text",
                                    "content": "background : timely access to cardiovascular health services is",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                76,
                                220,
                                303,
                                230
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        76,
                                        220,
                                        303,
                                        230
                                    ],
                                    "type": "text",
                                    "content": "necessary to prevent heart damages . the present study examined",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                76,
                                229,
                                303,
                                239
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        76,
                                        229,
                                        303,
                                        239
                                    ],
                                    "type": "text",
                                    "content": "inequality in geographical distribution of cardiovascular health",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                77,
                                239,
                                302,
                                248
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        77,
                                        239,
                                        302,
                                        248
                                    ],
                                    "type": "text",
                                    "content": "services in iran . methods : present study is a cross - sectional study",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                76,
                                248,
                                303,
                                258
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        76,
                                        248,
                                        303,
                                        258
                                    ],
                                    "type": "text",
                                    "content": "conducted using demographic data from all iranian provinces ( 31",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                75,
                                258,
                                304,
                                269
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        75,
                                        258,
                                        304,
                                        269
                                    ],
                                    "type": "text",
                                    "content": "provinces ) from 2012 census by the statistics center of iran ( sci ) .",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                76,
                                266,
                                303,
                                277
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        76,
                                        266,
                                        303,
                                        277
                                    ],
                                    "type": "text",
                                    "content": "the gini coefficients of ccu beds and cardiologists were used to assess",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                76,
                                277,
                                303,
                                287
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        76,
                                        277,
                                        303,
                                        287
                                    ],
                                    "type": "text",
                                    "content": "equality in access to cardiovascular health services in iran . ms",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                76,
                                286,
                                302,
                                296
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        76,
                                        286,
                                        302,
                                        296
                                    ],
                                    "type": "text",
                                    "content": "excel software was used to calculate gini coefficients . results : the",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                75,
                                296,
                                304,
                                307
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        75,
                                        296,
                                        304,
                                        307
                                    ],
                                    "type": "text",
                                    "content": "proportions of ccu bed and cardiologist per 100,000 population were",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                76,
                                306,
                                302,
                                315
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        76,
                                        306,
                                        302,
                                        315
                                    ],
                                    "type": "text",
                                    "content": "4.88 and 1.27 , respectively ; also the gini coefficients were 0.129",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                76,
                                315,
                                302,
                                324
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        76,
                                        315,
                                        302,
                                        324
                                    ],
                                    "type": "text",
                                    "content": "and 0.045 , respectively . conclusion : descriptive statistics showed",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                76,
                                324,
                                302,
                                334
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        76,
                                        324,
                                        302,
                                        334
                                    ],
                                    "type": "text",
                                    "content": "a skewness in distribution of pubic cardiovascular health services",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                76,
                                333,
                                302,
                                344
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        76,
                                        333,
                                        302,
                                        344
                                    ],
                                    "type": "text",
                                    "content": "in iran , though gini coefficient revealed no significant inequality",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                77,
                                343,
                                302,
                                353
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        77,
                                        343,
                                        302,
                                        353
                                    ],
                                    "type": "text",
                                    "content": ". however , equal distribution of ccu beds and cardiovascular",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                76,
                                352,
                                300,
                                363
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        76,
                                        352,
                                        300,
                                        363
                                    ],
                                    "type": "text",
                                    "content": "specialists does not mean they are sufficiently available in iran .",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                },
                {
                    "bbox": [
                        75,
                        372,
                        302,
                        475
                    ],
                    "type": "text",
                    "angle": 0,
                    "index": 2,
                    "lines": [
                        {
                            "bbox": [
                                75,
                                371,
                                304,
                                382
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        75,
                                        371,
                                        304,
                                        382
                                    ],
                                    "type": "text",
                                    "content": "lumbar spinal stenosis is a commonly treated with epidural in-",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                76,
                                381,
                                303,
                                391
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        76,
                                        381,
                                        303,
                                        391
                                    ],
                                    "type": "text",
                                    "content": "jections of local anesthetics and corticosteroids , however , these",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                76,
                                391,
                                303,
                                400
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        76,
                                        391,
                                        303,
                                        400
                                    ],
                                    "type": "text",
                                    "content": "therapies may relieve leg pain for weeks to months but do not",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                76,
                                399,
                                303,
                                411
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        76,
                                        399,
                                        303,
                                        411
                                    ],
                                    "type": "text",
                                    "content": "influence functional status . furthermore , the majority of pa-",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                76,
                                410,
                                303,
                                419
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        76,
                                        410,
                                        303,
                                        419
                                    ],
                                    "type": "text",
                                    "content": "tients report no substantial symptom change over the repeated",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                76,
                                419,
                                303,
                                429
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        76,
                                        419,
                                        303,
                                        429
                                    ],
                                    "type": "text",
                                    "content": "treatment . utilizing balloon catheters , we successfully treated",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                76,
                                428,
                                303,
                                438
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        76,
                                        428,
                                        303,
                                        438
                                    ],
                                    "type": "text",
                                    "content": "with three patients who complained persistent symptoms despite",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                76,
                                438,
                                303,
                                449
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        76,
                                        438,
                                        303,
                                        449
                                    ],
                                    "type": "text",
                                    "content": "repeated conventional steroid injections . our results suggest that",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                77,
                                448,
                                302,
                                456
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        77,
                                        448,
                                        302,
                                        456
                                    ],
                                    "type": "text",
                                    "content": "transforaminal decompression using a balloon catheter may have",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                76,
                                456,
                                304,
                                467
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        76,
                                        456,
                                        304,
                                        467
                                    ],
                                    "type": "text",
                                    "content": "potential in the nonsurgical treatment of spinal stenosis by modi-",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                76,
                                466,
                                212,
                                477
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        76,
                                        466,
                                        212,
                                        477
                                    ],
                                    "type": "text",
                                    "content": "fying the underlying pathophysiology .",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                },
                {
                    "bbox": [
                        75,
                        476,
                        302,
                        561
                    ],
                    "type": "text",
                    "angle": 0,
                    "index": 3,
                    "lines": [
                        {
                            "bbox": [
                                77,
                                476,
                                302,
                                486
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        77,
                                        476,
                                        302,
                                        486
                                    ],
                                    "type": "text",
                                    "content": "we describe a 26-year - old woman who presented with a nodular",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                77,
                                486,
                                302,
                                495
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        77,
                                        486,
                                        302,
                                        495
                                    ],
                                    "type": "text",
                                    "content": "rash on the elbows following an insect bite . two days later , she",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                77,
                                495,
                                302,
                                505
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        77,
                                        495,
                                        302,
                                        505
                                    ],
                                    "type": "text",
                                    "content": "developed erythema nodosum . both these lesions were treated",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                76,
                                504,
                                303,
                                514
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        76,
                                        504,
                                        303,
                                        514
                                    ],
                                    "type": "text",
                                    "content": "symptomatically . one week later , she had purpura , abdominal",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                75,
                                514,
                                303,
                                524
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        75,
                                        514,
                                        303,
                                        524
                                    ],
                                    "type": "text",
                                    "content": "pain , hematuria , and arthralgias , following which steroids were",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                76,
                                522,
                                304,
                                533
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        76,
                                        522,
                                        304,
                                        533
                                    ],
                                    "type": "text",
                                    "content": "administered . her investigations revealed only microscopic hema-",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                77,
                                533,
                                303,
                                542
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        77,
                                        533,
                                        303,
                                        542
                                    ],
                                    "type": "text",
                                    "content": "turia that disappeared with therapy . this pattern of sequential",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                76,
                                542,
                                303,
                                553
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        76,
                                        542,
                                        303,
                                        553
                                    ],
                                    "type": "text",
                                    "content": "appearance of rash and a nodular morphology are both unique",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                76,
                                552,
                                194,
                                561
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        76,
                                        552,
                                        194,
                                        561
                                    ],
                                    "type": "text",
                                    "content": "features not previously reported .",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                },
                {
                    "bbox": [
                        310,
                        201,
                        378,
                        209
                    ],
                    "type": "title",
                    "angle": 0,
                    "index": 4,
                    "lines": [
                        {
                            "bbox": [
                                311,
                                201,
                                380,
                                210
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        311,
                                        201,
                                        380,
                                        210
                                    ],
                                    "type": "text",
                                    "content": "Generated Abstract",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                },
                {
                    "bbox": [
                        310,
                        211,
                        537,
                        371
                    ],
                    "type": "text",
                    "angle": 0,
                    "index": 5,
                    "lines": [
                        {
                            "bbox": [
                                310,
                                210,
                                537,
                                220
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        310,
                                        210,
                                        537,
                                        220
                                    ],
                                    "type": "text",
                                    "content": "background : this study aimed to investigate the inequality of",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                311,
                                220,
                                537,
                                229
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        311,
                                        220,
                                        537,
                                        229
                                    ],
                                    "type": "text",
                                    "content": "distribution of cardiac care units ( ccu ) and cardiologists in iran",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                311,
                                230,
                                537,
                                239
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        311,
                                        230,
                                        537,
                                        239
                                    ],
                                    "type": "text",
                                    "content": ". methods : this study used demographic data from national",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                310,
                                239,
                                537,
                                248
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        310,
                                        239,
                                        537,
                                        248
                                    ],
                                    "type": "text",
                                    "content": "statistics collected by the central statistics of iran ( sci ) in 2012 .",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                310,
                                249,
                                537,
                                258
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        310,
                                        249,
                                        537,
                                        258
                                    ],
                                    "type": "text",
                                    "content": "the number of ccu beds and cardiologists per 100,000 individuals",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                310,
                                258,
                                537,
                                267
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        310,
                                        258,
                                        537,
                                        267
                                    ],
                                    "type": "text",
                                    "content": "and the number of cardiologists per 10 ccu beds were explored .",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                310,
                                267,
                                538,
                                277
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        310,
                                        267,
                                        538,
                                        277
                                    ],
                                    "type": "text",
                                    "content": "the gini coefficient was applied to measure inequality . results :",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                310,
                                277,
                                537,
                                287
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        310,
                                        277,
                                        537,
                                        287
                                    ],
                                    "type": "text",
                                    "content": "the mean number of ccu beds per 100,000 individuals in iran was",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                310,
                                286,
                                537,
                                296
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        310,
                                        286,
                                        537,
                                        296
                                    ],
                                    "type": "text",
                                    "content": "4.88 , which is out of a total of 31 provinces below the national",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                310,
                                296,
                                537,
                                305
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        310,
                                        296,
                                        537,
                                        305
                                    ],
                                    "type": "text",
                                    "content": "mean . the mean number of cardiologists per 100,000 individuals",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                310,
                                304,
                                537,
                                316
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        310,
                                        304,
                                        537,
                                        316
                                    ],
                                    "type": "text",
                                    "content": "was 1.27 and the mean number of cardiologists per 10 ccu beds was",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                310,
                                315,
                                537,
                                324
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        310,
                                        315,
                                        537,
                                        324
                                    ],
                                    "type": "text",
                                    "content": "2.6 . the gini coefficient of cardiologists in 2012 was 0.045 and the",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                309,
                                323,
                                537,
                                334
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        309,
                                        323,
                                        537,
                                        334
                                    ],
                                    "type": "text",
                                    "content": "gini coefficient of ccu beds was 0.129 . conclusion : our descriptive",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                309,
                                333,
                                537,
                                343
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        309,
                                        333,
                                        537,
                                        343
                                    ],
                                    "type": "text",
                                    "content": "statistics showed that there is a skewness in the distribution of",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                310,
                                343,
                                537,
                                352
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        310,
                                        343,
                                        537,
                                        352
                                    ],
                                    "type": "text",
                                    "content": "pubic cardiovascular health services in iran . moreover , the equal",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                311,
                                353,
                                537,
                                361
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        311,
                                        353,
                                        537,
                                        361
                                    ],
                                    "type": "text",
                                    "content": "distribution of cardiovascular health facilities such as ccu beds is",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                310,
                                363,
                                425,
                                372
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        310,
                                        363,
                                        425,
                                        372
                                    ],
                                    "type": "text",
                                    "content": "not necessarily provided in iran .",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                },
                {
                    "bbox": [
                        310,
                        372,
                        537,
                        475
                    ],
                    "type": "text",
                    "angle": 0,
                    "index": 6,
                    "lines": [
                        {
                            "bbox": [
                                310,
                                372,
                                539,
                                381
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        310,
                                        372,
                                        539,
                                        381
                                    ],
                                    "type": "text",
                                    "content": "epidural injection is a common treatment for spinal stenosis .",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                310,
                                380,
                                537,
                                391
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        310,
                                        380,
                                        537,
                                        391
                                    ],
                                    "type": "text",
                                    "content": "however , there is little information on the optimal management of",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                310,
                                391,
                                537,
                                400
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        310,
                                        391,
                                        537,
                                        400
                                    ],
                                    "type": "text",
                                    "content": "spinal stenosis . we describe the use of epidural balloon catheters to",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                310,
                                399,
                                537,
                                410
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        310,
                                        399,
                                        537,
                                        410
                                    ],
                                    "type": "text",
                                    "content": "decompress the intervertebral foramen in three patients with spinal",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                310,
                                410,
                                537,
                                419
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        310,
                                        410,
                                        537,
                                        419
                                    ],
                                    "type": "text",
                                    "content": "stenosis . patients were followed - up for 24 weeks . one patient",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                310,
                                419,
                                537,
                                429
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        310,
                                        419,
                                        537,
                                        429
                                    ],
                                    "type": "text",
                                    "content": "reported moderate pain relief , three patients reported symptom",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                310,
                                428,
                                537,
                                438
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        310,
                                        428,
                                        537,
                                        438
                                    ],
                                    "type": "text",
                                    "content": "improvement and one patient reported no change in symptoms",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                310,
                                437,
                                537,
                                449
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        310,
                                        437,
                                        537,
                                        449
                                    ],
                                    "type": "text",
                                    "content": ". this report suggests that transforaminal balloon decompression",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                310,
                                447,
                                537,
                                457
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        310,
                                        447,
                                        537,
                                        457
                                    ],
                                    "type": "text",
                                    "content": "using a balloon may have potential in the nonsurgical treatment",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                310,
                                456,
                                537,
                                467
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        310,
                                        456,
                                        537,
                                        467
                                    ],
                                    "type": "text",
                                    "content": "of spinal stenosis by modifying the underlying pathophysiology of",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                310,
                                467,
                                403,
                                476
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        310,
                                        467,
                                        403,
                                        476
                                    ],
                                    "type": "text",
                                    "content": "segmental spinal stenosis .",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                },
                {
                    "bbox": [
                        310,
                        475,
                        537,
                        552
                    ],
                    "type": "text",
                    "angle": 0,
                    "index": 7,
                    "lines": [
                        {
                            "bbox": [
                                310,
                                475,
                                537,
                                486
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        310,
                                        475,
                                        537,
                                        486
                                    ],
                                    "type": "text",
                                    "content": "we report a case of herpes simplex purpura ( hsp ) that presented",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                310,
                                485,
                                537,
                                495
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        310,
                                        485,
                                        537,
                                        495
                                    ],
                                    "type": "text",
                                    "content": "with a sequential pattern of rashes following an insect bite . the",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                310,
                                495,
                                537,
                                504
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        310,
                                        495,
                                        537,
                                        504
                                    ],
                                    "type": "text",
                                    "content": "patient was a 26-year - old woman who presented to our outpatient",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                310,
                                504,
                                537,
                                514
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        310,
                                        504,
                                        537,
                                        514
                                    ],
                                    "type": "text",
                                    "content": "department ( opd ) with a nodular rash on her elbows and erythema",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                310,
                                514,
                                537,
                                523
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        310,
                                        514,
                                        537,
                                        523
                                    ],
                                    "type": "text",
                                    "content": "nodosum on her lower limbs following an insect bite . she had",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                310,
                                523,
                                537,
                                533
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        310,
                                        523,
                                        537,
                                        533
                                    ],
                                    "type": "text",
                                    "content": "purpura on her lower limbs 2 weeks later . she had similar lesions",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                310,
                                533,
                                539,
                                542
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        310,
                                        533,
                                        539,
                                        542
                                    ],
                                    "type": "text",
                                    "content": "on both upper and lower limbs 1 week after a second insect bite .",
                                    "score": 1.0
                                }
                            ]
                        },
                        {
                            "bbox": [
                                310,
                                541,
                                531,
                                553
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        310,
                                        541,
                                        531,
                                        553
                                    ],
                                    "type": "text",
                                    "content": "this pattern of rashes has not been previously reported in hsp .",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                },
                {
                    "bbox": [
                        68,
                        571,
                        460,
                        582
                    ],
                    "angle": 0,
                    "index": 8,
                    "lines": [
                        {
                            "bbox": [
                                69,
                                571,
                                461,
                                582
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        69,
                                        571,
                                        461,
                                        582
                                    ],
                                    "type": "text",
                                    "content": "Table 19 Comparison of ground true abstract and abstract generated by REFRAG for PubMed.",
                                    "score": 1.0
                                }
                            ]
                        }
                    ],
                    "type": "text"
                }
            ],
            "discarded_blocks": [
                {
                    "bbox": [
                        299,
                        742,
                        310,
                        751
                    ],
                    "type": "page_number",
                    "angle": 0,
                    "index": 9,
                    "lines": [
                        {
                            "bbox": [
                                298,
                                741,
                                312,
                                754
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        298,
                                        741,
                                        312,
                                        754
                                    ],
                                    "type": "text",
                                    "content": "28",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                }
            ],
            "page_size": [
                612,
                792
            ],
            "page_idx": 27
        },
        {
            "para_blocks": [
                {
                    "type": "table",
                    "bbox": [
                        71,
                        152,
                        542,
                        610
                    ],
                    "blocks": [
                        {
                            "bbox": [
                                71,
                                152,
                                542,
                                610
                            ],
                            "lines": [
                                {
                                    "bbox": [
                                        71,
                                        152,
                                        542,
                                        610
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                71,
                                                152,
                                                542,
                                                610
                                            ],
                                            "type": "table",
                                            "html": "<table><tr><td>Ground True Abstract</td><td>Generated Abstract</td></tr><tr><td>memory - based learning , keeping full memory of learning material, appears a viable approach to learning nlp tasks , and is often superior in generalisation accuracy to eager learning approaches that abstract from learning material . here we investigate three partial memory - based learning approaches which remove from memory specific task instance types estimated to be exceptional . the three approaches each implement one heuristic function for estimating exceptionality of instance types : ( i ) typicality , ( ii ) class prediction strength , and ( iii ) friendly - neighbourhood size . experiments are performed with the memory - based learning algorithm ib1-ig trained on english word pronunciation . we find that removing instance types with low prediction strength ( ii ) is the only tested method which does not seriously harm generalisation accuracy . we conclude that keeping full memory of types rather than tokens , and excluding minority ambiguities appear to be the only performance - preserving optimisations of memory - based learning .</td><td>memory - based learning is a prominent and successful approach to machine learning . however , its use in nlp tasks has been limited by its over - generalisation properties . this paper investigates two optimisations that can be applied to memory - based learning in order to improve its generalisation performance : ( 1 ) replacing instance types ( memory tokens ) by instance types with frequency information , and ( 2 ) removing redundant information ( i.e . , instance types with low predictive power ) . we perform experiments on a large data set of english word pronunciations . we show that both optimisations yield improvements in generalisation performance . our results also indicate that atypicality , non - typicality , and friendly - neighbourhood size are estimates of the importance of instance types for their classification , rather than their removability .</td></tr><tr><td>machine learning methods are applied to finding the green s function of the anderson impurity model , a basic model system of quantum many - body condensed - matter physics . different methods of parametrizing the green s function are investigated ; a representation in terms of legendre polynomials is found to be superior due to its limited number of coefficients and its applicability to state of the art methods of solution . the dependence of the errors on the size of the training set is determined . the results indicate that a machine learning approach to dynamical mean - field theory may be feasible .</td><td>ewe demonstrate how machine learning techniques can be used to solve the quantum many - body problem . we apply the method to the anderson impurity model , where we use the exact diagonalization method to train the machine learning algorithms . we show that machine learning is an efficient and accurate method to compute the self - energy of the model and to predict the spectral function of the model . we also show that machine learning algorithms can be used to efficiently compute the self - consistent green s function starting from any hybridization function .</td></tr><tr><td>particle swarm optimization is used in several combinatorial optimization problems . in this work , particle swarms are used to solve quadratic programming problems with quadratic constraints . the approach of particle swarms is an example for interior point methods in optimization as an iterative technique . this approach is novel and deals with classification problems without the use of a traditional classifier . our method determines the optimal hyperplane or classification boundary for a data set . in a binary classification problem , we constrain each class as a cluster , which is enclosed by an ellipsoid . the estimation of the optimal hyperplane between the two clusters is posed as a quadratically constrained quadratic problem . the optimization problem is solved in distributed format using modified particle swarms . our method has the advantage of using the direction towards optimal solution rather than searching the entire feasible region . our results on the iris , pima , wine , and thyroid datasets show that the proposed method works better than a neural network and the performance is close to that ofsvm . * keywords * quadratic programming; particle swarms ; hyperplane ; quadratic constraints ; binary classification .</td><td>support vector machines are used for classification of data in machine learning . support vector machines use quadratic programming formulation for minimizing the objective function . the quadratic programming problem is solved by particle swarm optimization . the proposed method is compared with khachiya s and karman s support vector machine algorithms for linear and neural networks and quadratic programming . the results show that the proposed method is better than the other two methods .</td></tr></table>",
                                            "image_path": "69e81b7d9e0fc9110065162a3fa79f38e83c78e800cc79d09d189478b9117579.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 0,
                            "angle": 0,
                            "type": "table_body"
                        },
                        {
                            "bbox": [
                                67,
                                618,
                                453,
                                630
                            ],
                            "lines": [
                                {
                                    "bbox": [
                                        69,
                                        618,
                                        453,
                                        631
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                69,
                                                618,
                                                453,
                                                631
                                            ],
                                            "type": "text",
                                            "content": "Table 20 Comparison of ground true abstract and abstract generated by REFRAG for ArXiv.",
                                            "score": 1.0
                                        }
                                    ]
                                }
                            ],
                            "index": 1,
                            "angle": 0,
                            "type": "table_caption"
                        }
                    ],
                    "index": 0
                }
            ],
            "discarded_blocks": [
                {
                    "bbox": [
                        299,
                        742,
                        311,
                        752
                    ],
                    "type": "page_number",
                    "angle": 0,
                    "index": 2,
                    "lines": [
                        {
                            "bbox": [
                                298,
                                742,
                                313,
                                754
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        298,
                                        742,
                                        313,
                                        754
                                    ],
                                    "type": "text",
                                    "content": "29",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                }
            ],
            "page_size": [
                612,
                792
            ],
            "page_idx": 28
        },
        {
            "para_blocks": [
                {
                    "type": "table",
                    "bbox": [
                        107,
                        267,
                        504,
                        539
                    ],
                    "blocks": [
                        {
                            "bbox": [
                                68,
                                247,
                                354,
                                258
                            ],
                            "lines": [
                                {
                                    "bbox": [
                                        67,
                                        245,
                                        355,
                                        261
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                67,
                                                245,
                                                355,
                                                261
                                            ],
                                            "type": "text",
                                            "content": "Table 21 Performance on summarization tasks under the same latency.",
                                            "score": 1.0
                                        }
                                    ]
                                }
                            ],
                            "index": 0,
                            "angle": 0,
                            "type": "table_caption"
                        },
                        {
                            "bbox": [
                                107,
                                267,
                                504,
                                539
                            ],
                            "lines": [
                                {
                                    "bbox": [
                                        107,
                                        267,
                                        504,
                                        539
                                    ],
                                    "spans": [
                                        {
                                            "bbox": [
                                                107,
                                                267,
                                                504,
                                                539
                                            ],
                                            "type": "table",
                                            "html": "<table><tr><td></td><td colspan=\"3\">Arxiv</td><td colspan=\"3\">Pubmed</td></tr><tr><td></td><td>Rouge-1</td><td>Rouge-2</td><td>Rouge-L</td><td>Rouge-1</td><td>Rouge-2</td><td>Rouge-L </td></tr><tr><td colspan=\"7\"># Decoder tokens = 128</td></tr><tr><td>\\(LLAMA_{FT}\\)</td><td>29.69</td><td>6.89</td><td>18.28</td><td>29.79</td><td>8.37</td><td>18.41</td></tr><tr><td>CEPED</td><td>12.67</td><td>1.66</td><td>8.39</td><td>12.01</td><td>1.41</td><td>7.74</td></tr><tr><td>\\(REPLUG_{FT}\\)</td><td>5.30</td><td>0.78</td><td>3.77</td><td>5.11</td><td>0.81</td><td>3.55</td></tr><tr><td>\\(REPLUG_{Chat}\\)</td><td>15.11</td><td>1.58</td><td>9.80</td><td>14.94</td><td>1.51</td><td>9.40</td></tr><tr><td>LLAMA-32K</td><td>2.83</td><td>0.48</td><td>2.11</td><td>7.94</td><td>1.63</td><td>5.31</td></tr><tr><td>\\(REFRAG_8\\)</td><td>36.50</td><td>12.48</td><td>22.21</td><td>38.27</td><td>13.91</td><td>23.20</td></tr><tr><td>\\(REFRAG_{16}\\)</td><td>38.48</td><td>12.50</td><td>22.66</td><td>38.93</td><td>12.83</td><td>23.07</td></tr><tr><td colspan=\"7\"># Decoder tokens =512</td></tr><tr><td>\\(LLAMA_{FT}\\)</td><td>36.03</td><td>11.16</td><td>21.49</td><td>38.15</td><td>14.36</td><td>23.27</td></tr><tr><td>CEPED</td><td>19.28</td><td>3.16</td><td>12.22</td><td>17.60</td><td>2.43</td><td>10.89</td></tr><tr><td>\\(REPLUG_{FT}\\)</td><td>28.33</td><td>6.42</td><td>17.04</td><td>28.29</td><td>7.59</td><td>16.97</td></tr><tr><td>\\(REPLUG_{Chat}\\)</td><td>31.41</td><td>7.00</td><td>18.32</td><td>30.67</td><td>7.13</td><td>17.56</td></tr><tr><td>LLAMA-32K</td><td>3.03</td><td>0.65</td><td>2.28</td><td>8.49</td><td>2.54</td><td>5.47</td></tr><tr><td>\\(REFRAG_8\\)</td><td>41.95</td><td>15.56</td><td>24.84</td><td>43.55</td><td>17.53</td><td>26.38</td></tr><tr><td colspan=\"7\"># Decoder tokens =1024</td></tr><tr><td>\\(LLAMA_{FT}\\)</td><td>41.24</td><td>15.07</td><td>24.45</td><td>42.45</td><td>17.58</td><td>26.11</td></tr><tr><td>CEPED</td><td>25.20</td><td>5.07</td><td>15.45</td><td>23.00</td><td>3.94</td><td>13.71</td></tr><tr><td>\\(REPLUG_{FT}\\)</td><td>19.32</td><td>3.18</td><td>12.73</td><td>17.07</td><td>2.93</td><td>11.20</td></tr><tr><td>\\(REPLUG_{Chat}\\)</td><td>27.38</td><td>5.46</td><td>16.84</td><td>27.89</td><td>5.16</td><td>15.93</td></tr><tr><td>LLAMA-32K</td><td>4.34</td><td>0.95</td><td>3.35</td><td>10.19</td><td>3.11</td><td>6.47</td></tr><tr><td>\\(REFRAG_8\\)</td><td>43.88</td><td>17.03</td><td>26.01</td><td>44.43</td><td>18.06</td><td>26.85</td></tr></table>",
                                            "image_path": "2c5b7f131d66e9509a6cf331a6e6d6f47f310367808eb6304b5b22487792aea9.jpg"
                                        }
                                    ]
                                }
                            ],
                            "index": 1,
                            "angle": 0,
                            "type": "table_body"
                        }
                    ],
                    "index": 1
                }
            ],
            "discarded_blocks": [
                {
                    "bbox": [
                        299,
                        742,
                        311,
                        752
                    ],
                    "type": "page_number",
                    "angle": 0,
                    "index": 2,
                    "lines": [
                        {
                            "bbox": [
                                298,
                                741,
                                313,
                                754
                            ],
                            "spans": [
                                {
                                    "bbox": [
                                        298,
                                        741,
                                        313,
                                        754
                                    ],
                                    "type": "text",
                                    "content": "30",
                                    "score": 1.0
                                }
                            ]
                        }
                    ]
                }
            ],
            "page_size": [
                612,
                792
            ],
            "page_idx": 29
        }
    ],
    "_backend": "hybrid",
    "_ocr_enable": false,
    "_vlm_ocr_enable": false,
    "_version_name": "2.7.5"
}